import{_ as ui}from"./Menu.vue.69109358.js";import{_ as Ht,u as hi,g as jt,M as _i}from"./splitpanes.246f76d6.js";import{J as pi,K as ft,L as fi,M as mi,N as gi,a as $t,b as qt,k as De,A as Kt,p as vi,o as Re,e as Te,f as g,u as H,c as Wt,i as ut,t as Me,y as yt,C as Yt,x as yi,D as Xt,E as Jt,G as Zt,m as bi,z as Si,B as Ei,q as dt,h as et,v as rt,l as kt,s as pt,w as Ai,F as gt,r as vt,j as Ri,O as wi}from"./entry.230716bf.js";import{u as bt,s as Dt,p as Qt,a as Ti}from"./config.5c5d946d.js";import{u as Ct}from"./auth.be8628dd.js";import"./nuxt-link.3b6951aa.js";var Lt={},ki={get exports(){return Lt},set exports(Ue){Lt=Ue}};(function(Ue,$e){(function(he,q){Ue.exports=q()})(window,function(){return function(he){var q={};function I(z){if(q[z])return q[z].exports;var M=q[z]={i:z,l:!1,exports:{}};return he[z].call(M.exports,M,M.exports,I),M.l=!0,M.exports}return I.m=he,I.c=q,I.d=function(z,M,y){I.o(z,M)||Object.defineProperty(z,M,{enumerable:!0,get:y})},I.r=function(z){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(z,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(z,"__esModule",{value:!0})},I.t=function(z,M){if(1&M&&(z=I(z)),8&M||4&M&&typeof z=="object"&&z&&z.__esModule)return z;var y=Object.create(null);if(I.r(y),Object.defineProperty(y,"default",{enumerable:!0,value:z}),2&M&&typeof z!="string")for(var v in z)I.d(y,v,function(m){return z[m]}.bind(null,v));return y},I.n=function(z){var M=z&&z.__esModule?function(){return z.default}:function(){return z};return I.d(M,"a",M),M},I.o=function(z,M){return Object.prototype.hasOwnProperty.call(z,M)},I.p="",I(I.s=14)}([function(he,q,I){var z=I(6),M=I.n(z),y=function(){function v(){}return v.e=function(m,_){m&&!v.FORCE_GLOBAL_TAG||(m=v.GLOBAL_TAG);var R="["+m+"] > "+_;v.ENABLE_CALLBACK&&v.emitter.emit("log","error",R),v.ENABLE_ERROR&&(console.error?console.error(R):console.warn?console.warn(R):console.log(R))},v.i=function(m,_){m&&!v.FORCE_GLOBAL_TAG||(m=v.GLOBAL_TAG);var R="["+m+"] > "+_;v.ENABLE_CALLBACK&&v.emitter.emit("log","info",R),v.ENABLE_INFO&&(console.info?console.info(R):console.log(R))},v.w=function(m,_){m&&!v.FORCE_GLOBAL_TAG||(m=v.GLOBAL_TAG);var R="["+m+"] > "+_;v.ENABLE_CALLBACK&&v.emitter.emit("log","warn",R),v.ENABLE_WARN&&(console.warn?console.warn(R):console.log(R))},v.d=function(m,_){m&&!v.FORCE_GLOBAL_TAG||(m=v.GLOBAL_TAG);var R="["+m+"] > "+_;v.ENABLE_CALLBACK&&v.emitter.emit("log","debug",R),v.ENABLE_DEBUG&&(console.debug?console.debug(R):console.log(R))},v.v=function(m,_){m&&!v.FORCE_GLOBAL_TAG||(m=v.GLOBAL_TAG);var R="["+m+"] > "+_;v.ENABLE_CALLBACK&&v.emitter.emit("log","verbose",R),v.ENABLE_VERBOSE&&console.log(R)},v}();y.GLOBAL_TAG="mpegts.js",y.FORCE_GLOBAL_TAG=!1,y.ENABLE_ERROR=!0,y.ENABLE_INFO=!0,y.ENABLE_WARN=!0,y.ENABLE_DEBUG=!0,y.ENABLE_VERBOSE=!0,y.ENABLE_CALLBACK=!1,y.emitter=new M.a,q.a=y},function(he,q,I){q.a={IO_ERROR:"io_error",DEMUX_ERROR:"demux_error",INIT_SEGMENT:"init_segment",MEDIA_SEGMENT:"media_segment",LOADING_COMPLETE:"loading_complete",RECOVERED_EARLY_EOF:"recovered_early_eof",MEDIA_INFO:"media_info",METADATA_ARRIVED:"metadata_arrived",SCRIPTDATA_ARRIVED:"scriptdata_arrived",TIMED_ID3_METADATA_ARRIVED:"timed_id3_metadata_arrived",SMPTE2038_METADATA_ARRIVED:"smpte2038_metadata_arrived",SCTE35_METADATA_ARRIVED:"scte35_metadata_arrived",PES_PRIVATE_DATA_DESCRIPTOR:"pes_private_data_descriptor",PES_PRIVATE_DATA_ARRIVED:"pes_private_data_arrived",STATISTICS_INFO:"statistics_info",RECOMMEND_SEEKPOINT:"recommend_seekpoint"}},function(he,q,I){I.d(q,"c",function(){return M}),I.d(q,"b",function(){return y}),I.d(q,"a",function(){return v});var z=I(3),M={kIdle:0,kConnecting:1,kBuffering:2,kError:3,kComplete:4},y={OK:"OK",EXCEPTION:"Exception",HTTP_STATUS_CODE_INVALID:"HttpStatusCodeInvalid",CONNECTING_TIMEOUT:"ConnectingTimeout",EARLY_EOF:"EarlyEof",UNRECOVERABLE_EARLY_EOF:"UnrecoverableEarlyEof"},v=function(){function m(_){this._type=_||"undefined",this._status=M.kIdle,this._needStash=!1,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null}return m.prototype.destroy=function(){this._status=M.kIdle,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null},m.prototype.isWorking=function(){return this._status===M.kConnecting||this._status===M.kBuffering},Object.defineProperty(m.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"status",{get:function(){return this._status},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"needStashBuffer",{get:function(){return this._needStash},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"onContentLengthKnown",{get:function(){return this._onContentLengthKnown},set:function(_){this._onContentLengthKnown=_},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"onURLRedirect",{get:function(){return this._onURLRedirect},set:function(_){this._onURLRedirect=_},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"onDataArrival",{get:function(){return this._onDataArrival},set:function(_){this._onDataArrival=_},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"onError",{get:function(){return this._onError},set:function(_){this._onError=_},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"onComplete",{get:function(){return this._onComplete},set:function(_){this._onComplete=_},enumerable:!1,configurable:!0}),m.prototype.open=function(_,R){throw new z.c("Unimplemented abstract function!")},m.prototype.abort=function(){throw new z.c("Unimplemented abstract function!")},m}()},function(he,q,I){I.d(q,"d",function(){return y}),I.d(q,"a",function(){return v}),I.d(q,"b",function(){return m}),I.d(q,"c",function(){return _});var z,M=(z=function(R,P){return(z=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(w,O){w.__proto__=O}||function(w,O){for(var x in O)O.hasOwnProperty(x)&&(w[x]=O[x])})(R,P)},function(R,P){function w(){this.constructor=R}z(R,P),R.prototype=P===null?Object.create(P):(w.prototype=P.prototype,new w)}),y=function(){function R(P){this._message=P}return Object.defineProperty(R.prototype,"name",{get:function(){return"RuntimeException"},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"message",{get:function(){return this._message},enumerable:!1,configurable:!0}),R.prototype.toString=function(){return this.name+": "+this.message},R}(),v=function(R){function P(w){return R.call(this,w)||this}return M(P,R),Object.defineProperty(P.prototype,"name",{get:function(){return"IllegalStateException"},enumerable:!1,configurable:!0}),P}(y),m=function(R){function P(w){return R.call(this,w)||this}return M(P,R),Object.defineProperty(P.prototype,"name",{get:function(){return"InvalidArgumentException"},enumerable:!1,configurable:!0}),P}(y),_=function(R){function P(w){return R.call(this,w)||this}return M(P,R),Object.defineProperty(P.prototype,"name",{get:function(){return"NotImplementedException"},enumerable:!1,configurable:!0}),P}(y)},function(he,q,I){var z={};(function(){var M=self.navigator.userAgent.toLowerCase(),y=/(edge)\/([\w.]+)/.exec(M)||/(opr)[\/]([\w.]+)/.exec(M)||/(chrome)[ \/]([\w.]+)/.exec(M)||/(iemobile)[\/]([\w.]+)/.exec(M)||/(version)(applewebkit)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(M)||/(webkit)[ \/]([\w.]+).*(version)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(M)||/(webkit)[ \/]([\w.]+)/.exec(M)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(M)||/(msie) ([\w.]+)/.exec(M)||M.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(M)||M.indexOf("compatible")<0&&/(firefox)[ \/]([\w.]+)/.exec(M)||[],v=/(ipad)/.exec(M)||/(ipod)/.exec(M)||/(windows phone)/.exec(M)||/(iphone)/.exec(M)||/(kindle)/.exec(M)||/(android)/.exec(M)||/(windows)/.exec(M)||/(mac)/.exec(M)||/(linux)/.exec(M)||/(cros)/.exec(M)||[],m={browser:y[5]||y[3]||y[1]||"",version:y[2]||y[4]||"0",majorVersion:y[4]||y[2]||"0",platform:v[0]||""},_={};if(m.browser){_[m.browser]=!0;var R=m.majorVersion.split(".");_.version={major:parseInt(m.majorVersion,10),string:m.version},R.length>1&&(_.version.minor=parseInt(R[1],10)),R.length>2&&(_.version.build=parseInt(R[2],10))}m.platform&&(_[m.platform]=!0),(_.chrome||_.opr||_.safari)&&(_.webkit=!0),(_.rv||_.iemobile)&&(_.rv&&delete _.rv,m.browser="msie",_.msie=!0),_.edge&&(delete _.edge,m.browser="msedge",_.msedge=!0),_.opr&&(m.browser="opera",_.opera=!0),_.safari&&_.android&&(m.browser="android",_.android=!0);for(var P in _.name=m.browser,_.platform=m.platform,z)z.hasOwnProperty(P)&&delete z[P];Object.assign(z,_)})(),q.a=z},function(he,q,I){q.a={OK:"OK",FORMAT_ERROR:"FormatError",FORMAT_UNSUPPORTED:"FormatUnsupported",CODEC_UNSUPPORTED:"CodecUnsupported"}},function(he,q,I){var z,M=typeof Reflect=="object"?Reflect:null,y=M&&typeof M.apply=="function"?M.apply:function(f,V,b){return Function.prototype.apply.call(f,V,b)};z=M&&typeof M.ownKeys=="function"?M.ownKeys:Object.getOwnPropertySymbols?function(f){return Object.getOwnPropertyNames(f).concat(Object.getOwnPropertySymbols(f))}:function(f){return Object.getOwnPropertyNames(f)};var v=Number.isNaN||function(f){return f!=f};function m(){m.init.call(this)}he.exports=m,he.exports.once=function(f,V){return new Promise(function(b,l){function c(p){f.removeListener(V,u),l(p)}function u(){typeof f.removeListener=="function"&&f.removeListener("error",c),b([].slice.call(arguments))}re(f,V,u,{once:!0}),V!=="error"&&function(p,U,D){typeof p.on=="function"&&re(p,"error",U,D)}(f,c,{once:!0})})},m.EventEmitter=m,m.prototype._events=void 0,m.prototype._eventsCount=0,m.prototype._maxListeners=void 0;var _=10;function R(f){if(typeof f!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof f)}function P(f){return f._maxListeners===void 0?m.defaultMaxListeners:f._maxListeners}function w(f,V,b,l){var c,u,p,U;if(R(b),(u=f._events)===void 0?(u=f._events=Object.create(null),f._eventsCount=0):(u.newListener!==void 0&&(f.emit("newListener",V,b.listener?b.listener:b),u=f._events),p=u[V]),p===void 0)p=u[V]=b,++f._eventsCount;else if(typeof p=="function"?p=u[V]=l?[b,p]:[p,b]:l?p.unshift(b):p.push(b),(c=P(f))>0&&p.length>c&&!p.warned){p.warned=!0;var D=new Error("Possible EventEmitter memory leak detected. "+p.length+" "+String(V)+" listeners added. Use emitter.setMaxListeners() to increase limit");D.name="MaxListenersExceededWarning",D.emitter=f,D.type=V,D.count=p.length,U=D,console&&console.warn&&console.warn(U)}return f}function O(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function x(f,V,b){var l={fired:!1,wrapFn:void 0,target:f,type:V,listener:b},c=O.bind(l);return c.listener=b,l.wrapFn=c,c}function pe(f,V,b){var l=f._events;if(l===void 0)return[];var c=l[V];return c===void 0?[]:typeof c=="function"?b?[c.listener||c]:[c]:b?function(u){for(var p=new Array(u.length),U=0;U<p.length;++U)p[U]=u[U].listener||u[U];return p}(c):ee(c,c.length)}function ce(f){var V=this._events;if(V!==void 0){var b=V[f];if(typeof b=="function")return 1;if(b!==void 0)return b.length}return 0}function ee(f,V){for(var b=new Array(V),l=0;l<V;++l)b[l]=f[l];return b}function re(f,V,b,l){if(typeof f.on=="function")l.once?f.once(V,b):f.on(V,b);else{if(typeof f.addEventListener!="function")throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof f);f.addEventListener(V,function c(u){l.once&&f.removeEventListener(V,c),b(u)})}}Object.defineProperty(m,"defaultMaxListeners",{enumerable:!0,get:function(){return _},set:function(f){if(typeof f!="number"||f<0||v(f))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+f+".");_=f}}),m.init=function(){this._events!==void 0&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},m.prototype.setMaxListeners=function(f){if(typeof f!="number"||f<0||v(f))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+f+".");return this._maxListeners=f,this},m.prototype.getMaxListeners=function(){return P(this)},m.prototype.emit=function(f){for(var V=[],b=1;b<arguments.length;b++)V.push(arguments[b]);var l=f==="error",c=this._events;if(c!==void 0)l=l&&c.error===void 0;else if(!l)return!1;if(l){var u;if(V.length>0&&(u=V[0]),u instanceof Error)throw u;var p=new Error("Unhandled error."+(u?" ("+u.message+")":""));throw p.context=u,p}var U=c[f];if(U===void 0)return!1;if(typeof U=="function")y(U,this,V);else{var D=U.length,j=ee(U,D);for(b=0;b<D;++b)y(j[b],this,V)}return!0},m.prototype.addListener=function(f,V){return w(this,f,V,!1)},m.prototype.on=m.prototype.addListener,m.prototype.prependListener=function(f,V){return w(this,f,V,!0)},m.prototype.once=function(f,V){return R(V),this.on(f,x(this,f,V)),this},m.prototype.prependOnceListener=function(f,V){return R(V),this.prependListener(f,x(this,f,V)),this},m.prototype.removeListener=function(f,V){var b,l,c,u,p;if(R(V),(l=this._events)===void 0)return this;if((b=l[f])===void 0)return this;if(b===V||b.listener===V)--this._eventsCount==0?this._events=Object.create(null):(delete l[f],l.removeListener&&this.emit("removeListener",f,b.listener||V));else if(typeof b!="function"){for(c=-1,u=b.length-1;u>=0;u--)if(b[u]===V||b[u].listener===V){p=b[u].listener,c=u;break}if(c<0)return this;c===0?b.shift():function(U,D){for(;D+1<U.length;D++)U[D]=U[D+1];U.pop()}(b,c),b.length===1&&(l[f]=b[0]),l.removeListener!==void 0&&this.emit("removeListener",f,p||V)}return this},m.prototype.off=m.prototype.removeListener,m.prototype.removeAllListeners=function(f){var V,b,l;if((b=this._events)===void 0)return this;if(b.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):b[f]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete b[f]),this;if(arguments.length===0){var c,u=Object.keys(b);for(l=0;l<u.length;++l)(c=u[l])!=="removeListener"&&this.removeAllListeners(c);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(typeof(V=b[f])=="function")this.removeListener(f,V);else if(V!==void 0)for(l=V.length-1;l>=0;l--)this.removeListener(f,V[l]);return this},m.prototype.listeners=function(f){return pe(this,f,!0)},m.prototype.rawListeners=function(f){return pe(this,f,!1)},m.listenerCount=function(f,V){return typeof f.listenerCount=="function"?f.listenerCount(V):ce.call(f,V)},m.prototype.listenerCount=ce,m.prototype.eventNames=function(){return this._eventsCount>0?z(this._events):[]}},function(he,q,I){I.d(q,"d",function(){return z}),I.d(q,"b",function(){return M}),I.d(q,"a",function(){return y}),I.d(q,"c",function(){return v});var z=function(m,_,R,P,w){this.dts=m,this.pts=_,this.duration=R,this.originalDts=P,this.isSyncPoint=w,this.fileposition=null},M=function(){function m(){this.beginDts=0,this.endDts=0,this.beginPts=0,this.endPts=0,this.originalBeginDts=0,this.originalEndDts=0,this.syncPoints=[],this.firstSample=null,this.lastSample=null}return m.prototype.appendSyncPoint=function(_){_.isSyncPoint=!0,this.syncPoints.push(_)},m}(),y=function(){function m(){this._list=[]}return m.prototype.clear=function(){this._list=[]},m.prototype.appendArray=function(_){var R=this._list;_.length!==0&&(R.length>0&&_[0].originalDts<R[R.length-1].originalDts&&this.clear(),Array.prototype.push.apply(R,_))},m.prototype.getLastSyncPointBeforeDts=function(_){if(this._list.length==0)return null;var R=this._list,P=0,w=R.length-1,O=0,x=0,pe=w;for(_<R[0].dts&&(P=0,x=pe+1);x<=pe;){if((O=x+Math.floor((pe-x)/2))===w||_>=R[O].dts&&_<R[O+1].dts){P=O;break}R[O].dts<_?x=O+1:pe=O-1}return this._list[P]},m}(),v=function(){function m(_){this._type=_,this._list=[],this._lastAppendLocation=-1}return Object.defineProperty(m.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"length",{get:function(){return this._list.length},enumerable:!1,configurable:!0}),m.prototype.isEmpty=function(){return this._list.length===0},m.prototype.clear=function(){this._list=[],this._lastAppendLocation=-1},m.prototype._searchNearestSegmentBefore=function(_){var R=this._list;if(R.length===0)return-2;var P=R.length-1,w=0,O=0,x=P,pe=0;if(_<R[0].originalBeginDts)return pe=-1;for(;O<=x;){if((w=O+Math.floor((x-O)/2))===P||_>R[w].lastSample.originalDts&&_<R[w+1].originalBeginDts){pe=w;break}R[w].originalBeginDts<_?O=w+1:x=w-1}return pe},m.prototype._searchNearestSegmentAfter=function(_){return this._searchNearestSegmentBefore(_)+1},m.prototype.append=function(_){var R=this._list,P=_,w=this._lastAppendLocation,O=0;w!==-1&&w<R.length&&P.originalBeginDts>=R[w].lastSample.originalDts&&(w===R.length-1||w<R.length-1&&P.originalBeginDts<R[w+1].originalBeginDts)?O=w+1:R.length>0&&(O=this._searchNearestSegmentBefore(P.originalBeginDts)+1),this._lastAppendLocation=O,this._list.splice(O,0,P)},m.prototype.getLastSegmentBefore=function(_){var R=this._searchNearestSegmentBefore(_);return R>=0?this._list[R]:null},m.prototype.getLastSampleBefore=function(_){var R=this.getLastSegmentBefore(_);return R!=null?R.lastSample:null},m.prototype.getLastSyncPointBefore=function(_){for(var R=this._searchNearestSegmentBefore(_),P=this._list[R].syncPoints;P.length===0&&R>0;)R--,P=this._list[R].syncPoints;return P.length>0?P[P.length-1]:null},m}()},function(he,q,I){var z=function(){function M(){this.mimeType=null,this.duration=null,this.hasAudio=null,this.hasVideo=null,this.audioCodec=null,this.videoCodec=null,this.audioDataRate=null,this.videoDataRate=null,this.audioSampleRate=null,this.audioChannelCount=null,this.width=null,this.height=null,this.fps=null,this.profile=null,this.level=null,this.refFrames=null,this.chromaFormat=null,this.sarNum=null,this.sarDen=null,this.metadata=null,this.segments=null,this.segmentCount=null,this.hasKeyframesIndex=null,this.keyframesIndex=null}return M.prototype.isComplete=function(){var y=this.hasAudio===!1||this.hasAudio===!0&&this.audioCodec!=null&&this.audioSampleRate!=null&&this.audioChannelCount!=null,v=this.hasVideo===!1||this.hasVideo===!0&&this.videoCodec!=null&&this.width!=null&&this.height!=null&&this.fps!=null&&this.profile!=null&&this.level!=null&&this.refFrames!=null&&this.chromaFormat!=null&&this.sarNum!=null&&this.sarDen!=null;return this.mimeType!=null&&y&&v},M.prototype.isSeekable=function(){return this.hasKeyframesIndex===!0},M.prototype.getNearestKeyframe=function(y){if(this.keyframesIndex==null)return null;var v=this.keyframesIndex,m=this._search(v.times,y);return{index:m,milliseconds:v.times[m],fileposition:v.filepositions[m]}},M.prototype._search=function(y,v){var m=0,_=y.length-1,R=0,P=0,w=_;for(v<y[0]&&(m=0,P=w+1);P<=w;){if((R=P+Math.floor((w-P)/2))===_||v>=y[R]&&v<y[R+1]){m=R;break}y[R]<v?P=R+1:w=R-1}return m},M}();q.a=z},function(he,q,I){var z=I(6),M=I.n(z),y=I(0),v=function(){function m(){}return Object.defineProperty(m,"forceGlobalTag",{get:function(){return y.a.FORCE_GLOBAL_TAG},set:function(_){y.a.FORCE_GLOBAL_TAG=_,m._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(m,"globalTag",{get:function(){return y.a.GLOBAL_TAG},set:function(_){y.a.GLOBAL_TAG=_,m._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(m,"enableAll",{get:function(){return y.a.ENABLE_VERBOSE&&y.a.ENABLE_DEBUG&&y.a.ENABLE_INFO&&y.a.ENABLE_WARN&&y.a.ENABLE_ERROR},set:function(_){y.a.ENABLE_VERBOSE=_,y.a.ENABLE_DEBUG=_,y.a.ENABLE_INFO=_,y.a.ENABLE_WARN=_,y.a.ENABLE_ERROR=_,m._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(m,"enableDebug",{get:function(){return y.a.ENABLE_DEBUG},set:function(_){y.a.ENABLE_DEBUG=_,m._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(m,"enableVerbose",{get:function(){return y.a.ENABLE_VERBOSE},set:function(_){y.a.ENABLE_VERBOSE=_,m._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(m,"enableInfo",{get:function(){return y.a.ENABLE_INFO},set:function(_){y.a.ENABLE_INFO=_,m._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(m,"enableWarn",{get:function(){return y.a.ENABLE_WARN},set:function(_){y.a.ENABLE_WARN=_,m._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(m,"enableError",{get:function(){return y.a.ENABLE_ERROR},set:function(_){y.a.ENABLE_ERROR=_,m._notifyChange()},enumerable:!1,configurable:!0}),m.getConfig=function(){return{globalTag:y.a.GLOBAL_TAG,forceGlobalTag:y.a.FORCE_GLOBAL_TAG,enableVerbose:y.a.ENABLE_VERBOSE,enableDebug:y.a.ENABLE_DEBUG,enableInfo:y.a.ENABLE_INFO,enableWarn:y.a.ENABLE_WARN,enableError:y.a.ENABLE_ERROR,enableCallback:y.a.ENABLE_CALLBACK}},m.applyConfig=function(_){y.a.GLOBAL_TAG=_.globalTag,y.a.FORCE_GLOBAL_TAG=_.forceGlobalTag,y.a.ENABLE_VERBOSE=_.enableVerbose,y.a.ENABLE_DEBUG=_.enableDebug,y.a.ENABLE_INFO=_.enableInfo,y.a.ENABLE_WARN=_.enableWarn,y.a.ENABLE_ERROR=_.enableError,y.a.ENABLE_CALLBACK=_.enableCallback},m._notifyChange=function(){var _=m.emitter;if(_.listenerCount("change")>0){var R=m.getConfig();_.emit("change",R)}},m.registerListener=function(_){m.emitter.addListener("change",_)},m.removeListener=function(_){m.emitter.removeListener("change",_)},m.addLogListener=function(_){y.a.emitter.addListener("log",_),y.a.emitter.listenerCount("log")>0&&(y.a.ENABLE_CALLBACK=!0,m._notifyChange())},m.removeLogListener=function(_){y.a.emitter.removeListener("log",_),y.a.emitter.listenerCount("log")===0&&(y.a.ENABLE_CALLBACK=!1,m._notifyChange())},m}();v.emitter=new M.a,q.a=v},function(he,q,I){var z=I(6),M=I.n(z),y=I(0),v=I(4),m=I(8);function _(n,t,i){var e=n;if(t+i<e.length){for(;i--;)if((192&e[++t])!=128)return!1;return!0}return!1}var R,P=function(n){for(var t=[],i=n,e=0,a=n.length;e<a;)if(i[e]<128)t.push(String.fromCharCode(i[e])),++e;else{if(!(i[e]<192)){if(i[e]<224){if(_(i,e,1)&&(s=(31&i[e])<<6|63&i[e+1])>=128){t.push(String.fromCharCode(65535&s)),e+=2;continue}}else if(i[e]<240){if(_(i,e,2)&&(s=(15&i[e])<<12|(63&i[e+1])<<6|63&i[e+2])>=2048&&(63488&s)!=55296){t.push(String.fromCharCode(65535&s)),e+=3;continue}}else if(i[e]<248){var s;if(_(i,e,3)&&(s=(7&i[e])<<18|(63&i[e+1])<<12|(63&i[e+2])<<6|63&i[e+3])>65536&&s<1114112){s-=65536,t.push(String.fromCharCode(s>>>10|55296)),t.push(String.fromCharCode(1023&s|56320)),e+=4;continue}}}t.push(String.fromCharCode(65533)),++e}return t.join("")},w=I(3),O=(R=new ArrayBuffer(2),new DataView(R).setInt16(0,256,!0),new Int16Array(R)[0]===256),x=function(){function n(){}return n.parseScriptData=function(t,i,e){var a={};try{var s=n.parseValue(t,i,e),r=n.parseValue(t,i+s.size,e-s.size);a[s.data]=r.data}catch(d){y.a.e("AMF",d.toString())}return a},n.parseObject=function(t,i,e){if(e<3)throw new w.a("Data not enough when parse ScriptDataObject");var a=n.parseString(t,i,e),s=n.parseValue(t,i+a.size,e-a.size),r=s.objectEnd;return{data:{name:a.data,value:s.data},size:a.size+s.size,objectEnd:r}},n.parseVariable=function(t,i,e){return n.parseObject(t,i,e)},n.parseString=function(t,i,e){if(e<2)throw new w.a("Data not enough when parse String");var a=new DataView(t,i,e).getUint16(0,!O);return{data:a>0?P(new Uint8Array(t,i+2,a)):"",size:2+a}},n.parseLongString=function(t,i,e){if(e<4)throw new w.a("Data not enough when parse LongString");var a=new DataView(t,i,e).getUint32(0,!O);return{data:a>0?P(new Uint8Array(t,i+4,a)):"",size:4+a}},n.parseDate=function(t,i,e){if(e<10)throw new w.a("Data size invalid when parse Date");var a=new DataView(t,i,e),s=a.getFloat64(0,!O),r=a.getInt16(8,!O);return{data:new Date(s+=60*r*1e3),size:10}},n.parseValue=function(t,i,e){if(e<1)throw new w.a("Data not enough when parse Value");var a,s=new DataView(t,i,e),r=1,d=s.getUint8(0),A=!1;try{switch(d){case 0:a=s.getFloat64(1,!O),r+=8;break;case 1:a=!!s.getUint8(1),r+=1;break;case 2:var S=n.parseString(t,i+1,e-1);a=S.data,r+=S.size;break;case 3:a={};var L=0;for((16777215&s.getUint32(e-4,!O))==9&&(L=3);r<e-4;){var B=n.parseObject(t,i+r,e-r-L);if(B.objectEnd)break;a[B.data.name]=B.data.value,r+=B.size}r<=e-3&&(16777215&s.getUint32(r-1,!O))===9&&(r+=3);break;case 8:for(a={},r+=4,L=0,(16777215&s.getUint32(e-4,!O))==9&&(L=3);r<e-8;){var T=n.parseVariable(t,i+r,e-r-L);if(T.objectEnd)break;a[T.data.name]=T.data.value,r+=T.size}r<=e-3&&(16777215&s.getUint32(r-1,!O))===9&&(r+=3);break;case 9:a=void 0,r=1,A=!0;break;case 10:a=[];var C=s.getUint32(1,!O);r+=4;for(var G=0;G<C;G++){var Y=n.parseValue(t,i+r,e-r);a.push(Y.data),r+=Y.size}break;case 11:var F=n.parseDate(t,i+1,e-1);a=F.data,r+=F.size;break;case 12:var ne=n.parseString(t,i+1,e-1);a=ne.data,r+=ne.size;break;default:r=e,y.a.w("AMF","Unsupported AMF value type "+d)}}catch(ae){y.a.e("AMF",ae.toString())}return{data:a,size:r,objectEnd:A}},n}(),pe=function(){function n(t){this.TAG="ExpGolomb",this._buffer=t,this._buffer_index=0,this._total_bytes=t.byteLength,this._total_bits=8*t.byteLength,this._current_word=0,this._current_word_bits_left=0}return n.prototype.destroy=function(){this._buffer=null},n.prototype._fillCurrentWord=function(){var t=this._total_bytes-this._buffer_index;if(t<=0)throw new w.a("ExpGolomb: _fillCurrentWord() but no bytes available");var i=Math.min(4,t),e=new Uint8Array(4);e.set(this._buffer.subarray(this._buffer_index,this._buffer_index+i)),this._current_word=new DataView(e.buffer).getUint32(0,!1),this._buffer_index+=i,this._current_word_bits_left=8*i},n.prototype.readBits=function(t){if(t>32)throw new w.b("ExpGolomb: readBits() bits exceeded max 32bits!");if(t<=this._current_word_bits_left){var i=this._current_word>>>32-t;return this._current_word<<=t,this._current_word_bits_left-=t,i}var e=this._current_word_bits_left?this._current_word:0;e>>>=32-this._current_word_bits_left;var a=t-this._current_word_bits_left;this._fillCurrentWord();var s=Math.min(a,this._current_word_bits_left),r=this._current_word>>>32-s;return this._current_word<<=s,this._current_word_bits_left-=s,e=e<<s|r},n.prototype.readBool=function(){return this.readBits(1)===1},n.prototype.readByte=function(){return this.readBits(8)},n.prototype._skipLeadingZero=function(){var t;for(t=0;t<this._current_word_bits_left;t++)if(this._current_word&2147483648>>>t)return this._current_word<<=t,this._current_word_bits_left-=t,t;return this._fillCurrentWord(),t+this._skipLeadingZero()},n.prototype.readUEG=function(){var t=this._skipLeadingZero();return this.readBits(t+1)-1},n.prototype.readSEG=function(){var t=this.readUEG();return 1&t?t+1>>>1:-1*(t>>>1)},n}(),ce=function(){function n(){}return n._ebsp2rbsp=function(t){for(var i=t,e=i.byteLength,a=new Uint8Array(e),s=0,r=0;r<e;r++)r>=2&&i[r]===3&&i[r-1]===0&&i[r-2]===0||(a[s]=i[r],s++);return new Uint8Array(a.buffer,0,s)},n.parseSPS=function(t){for(var i=t.subarray(1,4),e="avc1.",a=0;a<3;a++){var s=i[a].toString(16);s.length<2&&(s="0"+s),e+=s}var r=n._ebsp2rbsp(t),d=new pe(r);d.readByte();var A=d.readByte();d.readByte();var S=d.readByte();d.readUEG();var L=n.getProfileString(A),B=n.getLevelString(S),T=1,C=420,G=8,Y=8;if((A===100||A===110||A===122||A===244||A===44||A===83||A===86||A===118||A===128||A===138||A===144)&&((T=d.readUEG())===3&&d.readBits(1),T<=3&&(C=[0,420,422,444][T]),G=d.readUEG()+8,Y=d.readUEG()+8,d.readBits(1),d.readBool()))for(var F=T!==3?8:12,ne=0;ne<F;ne++)d.readBool()&&(ne<6?n._skipScalingList(d,16):n._skipScalingList(d,64));d.readUEG();var ae=d.readUEG();if(ae===0)d.readUEG();else if(ae===1){d.readBits(1),d.readSEG(),d.readSEG();var Z=d.readUEG();for(ne=0;ne<Z;ne++)d.readSEG()}var ge=d.readUEG();d.readBits(1);var ie=d.readUEG(),W=d.readUEG(),ue=d.readBits(1);ue===0&&d.readBits(1),d.readBits(1);var Se=0,Pe=0,ve=0,we=0;d.readBool()&&(Se=d.readUEG(),Pe=d.readUEG(),ve=d.readUEG(),we=d.readUEG());var Le=1,fe=1,Ae=0,Be=!0,je=0,it=0;if(d.readBool()){if(d.readBool()){var We=d.readByte();We>0&&We<16?(Le=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2][We-1],fe=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1][We-1]):We===255&&(Le=d.readByte()<<8|d.readByte(),fe=d.readByte()<<8|d.readByte())}if(d.readBool()&&d.readBool(),d.readBool()&&(d.readBits(4),d.readBool()&&d.readBits(24)),d.readBool()&&(d.readUEG(),d.readUEG()),d.readBool()){var Ie=d.readBits(32),ct=d.readBits(32);Be=d.readBool(),Ae=(je=ct)/(it=2*Ie)}}var nt=1;Le===1&&fe===1||(nt=Le/fe);var He=0,Fe=0;T===0?(He=1,Fe=2-ue):(He=T===3?1:2,Fe=(T===1?2:1)*(2-ue));var at=16*(ie+1),Qe=16*(W+1)*(2-ue);at-=(Se+Pe)*He,Qe-=(ve+we)*Fe;var ot=Math.ceil(at*nt);return d.destroy(),d=null,{codec_mimetype:e,profile_idc:A,level_idc:S,profile_string:L,level_string:B,chroma_format_idc:T,bit_depth:G,bit_depth_luma:G,bit_depth_chroma:Y,ref_frames:ge,chroma_format:C,chroma_format_string:n.getChromaFormatString(C),frame_rate:{fixed:Be,fps:Ae,fps_den:it,fps_num:je},sar_ratio:{width:Le,height:fe},codec_size:{width:at,height:Qe},present_size:{width:ot,height:Qe}}},n._skipScalingList=function(t,i){for(var e=8,a=8,s=0;s<i;s++)a!==0&&(a=(e+t.readSEG()+256)%256),e=a===0?e:a},n.getProfileString=function(t){switch(t){case 66:return"Baseline";case 77:return"Main";case 88:return"Extended";case 100:return"High";case 110:return"High10";case 122:return"High422";case 244:return"High444";default:return"Unknown"}},n.getLevelString=function(t){return(t/10).toFixed(1)},n.getChromaFormatString=function(t){switch(t){case 420:return"4:2:0";case 422:return"4:2:2";case 444:return"4:4:4";default:return"Unknown"}},n}(),ee=I(5),re=function(){function n(){}return n._ebsp2rbsp=function(t){for(var i=t,e=i.byteLength,a=new Uint8Array(e),s=0,r=0;r<e;r++)r>=2&&i[r]===3&&i[r-1]===0&&i[r-2]===0||(a[s]=i[r],s++);return new Uint8Array(a.buffer,0,s)},n.parseVPS=function(t){var i=n._ebsp2rbsp(t),e=new pe(i);return e.readByte(),e.readByte(),e.readBits(4),e.readBits(2),e.readBits(6),{num_temporal_layers:e.readBits(3)+1,temporal_id_nested:e.readBool()}},n.parseSPS=function(t){var i=n._ebsp2rbsp(t),e=new pe(i);e.readByte(),e.readByte(),e.readBits(4);for(var a=e.readBits(3),s=(e.readBool(),e.readBits(2)),r=e.readBool(),d=e.readBits(5),A=e.readByte(),S=e.readByte(),L=e.readByte(),B=e.readByte(),T=e.readByte(),C=e.readByte(),G=e.readByte(),Y=e.readByte(),F=e.readByte(),ne=e.readByte(),ae=e.readByte(),Z=[],ge=[],ie=0;ie<a;ie++)Z.push(e.readBool()),ge.push(e.readBool());if(a>0)for(ie=a;ie<8;ie++)e.readBits(2);for(ie=0;ie<a;ie++)Z[ie]&&(e.readByte(),e.readByte(),e.readByte(),e.readByte(),e.readByte(),e.readByte(),e.readByte(),e.readByte(),e.readByte(),e.readByte(),e.readByte()),ge[ie]&&e.readByte();e.readUEG();var W=e.readUEG();W==3&&e.readBits(1);var ue=e.readUEG(),Se=e.readUEG();e.readBool()&&(e.readUEG(),e.readUEG(),e.readUEG(),e.readUEG());var Pe=e.readUEG(),ve=e.readUEG(),we=e.readUEG();for(ie=e.readBool()?0:a;ie<=a;ie++)e.readUEG(),e.readUEG(),e.readUEG();if(e.readUEG(),e.readUEG(),e.readUEG(),e.readUEG(),e.readUEG(),e.readUEG(),e.readBool()&&e.readBool())for(var Le=0;Le<4;Le++)for(var fe=0;fe<(Le===3?2:6);fe++)if(e.readBool()){var Ae=Math.min(64,1<<4+(Le<<1));for(Le>1&&e.readSEG(),ie=0;ie<Ae;ie++)e.readSEG()}else e.readUEG();e.readBool(),e.readBool(),e.readBool()&&(e.readByte(),e.readUEG(),e.readUEG(),e.readBool());var Be=e.readUEG(),je=0;for(ie=0;ie<Be;ie++){var it=!1;if(ie!==0&&(it=e.readBool()),it){ie===Be&&e.readUEG(),e.readBool(),e.readUEG();for(var We=0,Ie=0;Ie<=je;Ie++){var ct=e.readBool(),nt=!1;ct||(nt=e.readBool()),(ct||nt)&&We++}je=We}else{var He=e.readUEG(),Fe=e.readUEG();for(je=He+Fe,Ie=0;Ie<He;Ie++)e.readUEG(),e.readBool();for(Ie=0;Ie<Fe;Ie++)e.readUEG(),e.readBool()}}if(e.readBool()){var at=e.readUEG();for(ie=0;ie<at;ie++){for(Ie=0;Ie<we+4;Ie++)e.readBits(1);e.readBits(1)}}var Qe=0,ot=1,ht=1,Ot=!1,Et=1,At=1;if(e.readBool(),e.readBool(),e.readBool()){if(e.readBool()){var _t=e.readByte();_t>0&&_t<16?(ot=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2][_t-1],ht=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1][_t-1]):_t===255&&(ot=e.readBits(16),ht=e.readBits(16))}if(e.readBool()&&e.readBool(),e.readBool()&&(e.readBits(3),e.readBool(),e.readBool()&&(e.readByte(),e.readByte(),e.readByte())),e.readBool()&&(e.readUEG(),e.readUEG()),e.readBool(),e.readBool(),e.readBool(),e.readBool()&&(e.readUEG(),e.readUEG(),e.readUEG(),e.readUEG()),e.readBool()&&(Et=e.readBits(32),At=e.readBits(32),e.readBool()&&(e.readUEG(),e.readBool()))){var Rt=!1,wt=!1,mt=!1;for(Rt=e.readBool(),wt=e.readBool(),(Rt||wt)&&((mt=e.readBool())&&(e.readByte(),e.readBits(5),e.readBool(),e.readBits(5)),e.readBits(4),e.readBits(4),mt&&e.readBits(4),e.readBits(5),e.readBits(5),e.readBits(5)),ie=0;ie<=a;ie++){var xt=e.readBool();Ot=xt;var Ut=!1,Tt=1;xt||(Ut=e.readBool());var Nt=!1;if(Ut?e.readSEG():Nt=e.readBool(),Nt||(Tt=e.readUEG()+1),Rt)for(Ie=0;Ie<Tt;Ie++)e.readUEG(),e.readUEG(),mt&&(e.readUEG(),e.readUEG());if(wt)for(Ie=0;Ie<Tt;Ie++)e.readUEG(),e.readUEG(),mt&&(e.readUEG(),e.readUEG())}}e.readBool()&&(e.readBool(),e.readBool(),e.readBool(),Qe=e.readUEG(),e.readUEG(),e.readUEG(),e.readUEG(),e.readUEG())}e.readBool();var ci="hvc1."+d+".1.L"+ae+".B0",Gt=ue,Vt=Se,Ft=1;return ot!==1&&ht!==1&&(Ft=ot/ht),e.destroy(),e=null,{codec_mimetype:ci,level_string:n.getLevelString(ae),profile_idc:d,bit_depth:Pe+8,ref_frames:1,chroma_format:W,chroma_format_string:n.getChromaFormatString(W),general_level_idc:ae,general_profile_space:s,general_tier_flag:r,general_profile_idc:d,general_profile_compatibility_flags_1:A,general_profile_compatibility_flags_2:S,general_profile_compatibility_flags_3:L,general_profile_compatibility_flags_4:B,general_constraint_indicator_flags_1:T,general_constraint_indicator_flags_2:C,general_constraint_indicator_flags_3:G,general_constraint_indicator_flags_4:Y,general_constraint_indicator_flags_5:F,general_constraint_indicator_flags_6:ne,min_spatial_segmentation_idc:Qe,constant_frame_rate:0,chroma_format_idc:W,bit_depth_luma_minus8:Pe,bit_depth_chroma_minus8:ve,frame_rate:{fixed:Ot,fps:At/Et,fps_den:Et,fps_num:At},sar_ratio:{width:ot,height:ht},codec_size:{width:Gt,height:Vt},present_size:{width:Gt*Ft,height:Vt}}},n.parsePPS=function(t){var i=n._ebsp2rbsp(t),e=new pe(i);e.readByte(),e.readByte(),e.readUEG(),e.readUEG(),e.readBool(),e.readBool(),e.readBits(3),e.readBool(),e.readBool(),e.readUEG(),e.readUEG(),e.readSEG(),e.readBool(),e.readBool(),e.readBool()&&e.readUEG(),e.readSEG(),e.readSEG(),e.readBool(),e.readBool(),e.readBool(),e.readBool();var a=e.readBool(),s=e.readBool(),r=1;return s&&a?r=0:s?r=3:a&&(r=2),{parallelismType:r}},n.getChromaFormatString=function(t){switch(t){case 0:return"4:0:0";case 1:return"4:2:0";case 2:return"4:2:2";case 3:return"4:4:4";default:return"Unknown"}},n.getProfileString=function(t){switch(t){case 1:return"Main";case 2:return"Main10";case 3:return"MainSP";case 4:return"Rext";case 9:return"SCC";default:return"Unknown"}},n.getLevelString=function(t){return(t/30).toFixed(1)},n}();function f(n){return n.byteOffset%2==0&&n.byteLength%2==0}function V(n){return n.byteOffset%4==0&&n.byteLength%4==0}function b(n,t){for(var i=0;i<n.length;i++)if(n[i]!==t[i])return!1;return!0}var l=function(n,t){return n.byteLength===t.byteLength&&(V(n)&&V(t)?function(i,e){return b(new Uint32Array(i.buffer,i.byteOffset,i.byteLength/4),new Uint32Array(e.buffer,e.byteOffset,e.byteLength/4))}(n,t):f(n)&&f(t)?function(i,e){return b(new Uint16Array(i.buffer,i.byteOffset,i.byteLength/2),new Uint16Array(e.buffer,e.byteOffset,e.byteLength/2))}(n,t):function(i,e){return b(i,e)}(n,t))},c,u=function(){function n(t,i){this.TAG="FLVDemuxer",this._config=i,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null,this._dataOffset=t.dataOffset,this._firstParse=!0,this._dispatch=!1,this._hasAudio=t.hasAudioTrack,this._hasVideo=t.hasVideoTrack,this._hasAudioFlagOverrided=!1,this._hasVideoFlagOverrided=!1,this._audioInitialMetadataDispatched=!1,this._videoInitialMetadataDispatched=!1,this._mediaInfo=new m.a,this._mediaInfo.hasAudio=this._hasAudio,this._mediaInfo.hasVideo=this._hasVideo,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._naluLengthSize=4,this._timestampBase=0,this._timescale=1e3,this._duration=0,this._durationOverrided=!1,this._referenceFrameRate={fixed:!0,fps:23.976,fps_num:23976,fps_den:1e3},this._flvSoundRateTable=[5500,11025,22050,44100,48e3],this._mpegSamplingRates=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],this._mpegAudioV10SampleRateTable=[44100,48e3,32e3,0],this._mpegAudioV20SampleRateTable=[22050,24e3,16e3,0],this._mpegAudioV25SampleRateTable=[11025,12e3,8e3,0],this._mpegAudioL1BitRateTable=[0,32,64,96,128,160,192,224,256,288,320,352,384,416,448,-1],this._mpegAudioL2BitRateTable=[0,32,48,56,64,80,96,112,128,160,192,224,256,320,384,-1],this._mpegAudioL3BitRateTable=[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],this._videoTrack={type:"video",id:1,sequenceNumber:0,samples:[],length:0},this._audioTrack={type:"audio",id:2,sequenceNumber:0,samples:[],length:0},this._littleEndian=function(){var e=new ArrayBuffer(2);return new DataView(e).setInt16(0,256,!0),new Int16Array(e)[0]===256}()}return n.prototype.destroy=function(){this._mediaInfo=null,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._videoTrack=null,this._audioTrack=null,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null},n.probe=function(t){var i=new Uint8Array(t);if(i.byteLength<9)return{needMoreData:!0};var e={match:!1};if(i[0]!==70||i[1]!==76||i[2]!==86||i[3]!==1)return e;var a,s,r=(4&i[4])>>>2!=0,d=(1&i[4])!=0,A=(a=i)[s=5]<<24|a[s+1]<<16|a[s+2]<<8|a[s+3];return A<9?e:{match:!0,consumed:A,dataOffset:A,hasAudioTrack:r,hasVideoTrack:d}},n.prototype.bindDataSource=function(t){return t.onDataArrival=this.parseChunks.bind(this),this},Object.defineProperty(n.prototype,"onTrackMetadata",{get:function(){return this._onTrackMetadata},set:function(t){this._onTrackMetadata=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"onMediaInfo",{get:function(){return this._onMediaInfo},set:function(t){this._onMediaInfo=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"onMetaDataArrived",{get:function(){return this._onMetaDataArrived},set:function(t){this._onMetaDataArrived=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"onScriptDataArrived",{get:function(){return this._onScriptDataArrived},set:function(t){this._onScriptDataArrived=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"onError",{get:function(){return this._onError},set:function(t){this._onError=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"onDataAvailable",{get:function(){return this._onDataAvailable},set:function(t){this._onDataAvailable=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"timestampBase",{get:function(){return this._timestampBase},set:function(t){this._timestampBase=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"overridedDuration",{get:function(){return this._duration},set:function(t){this._durationOverrided=!0,this._duration=t,this._mediaInfo.duration=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"overridedHasAudio",{set:function(t){this._hasAudioFlagOverrided=!0,this._hasAudio=t,this._mediaInfo.hasAudio=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"overridedHasVideo",{set:function(t){this._hasVideoFlagOverrided=!0,this._hasVideo=t,this._mediaInfo.hasVideo=t},enumerable:!1,configurable:!0}),n.prototype.resetMediaInfo=function(){this._mediaInfo=new m.a},n.prototype._isInitialMetadataDispatched=function(){return this._hasAudio&&this._hasVideo?this._audioInitialMetadataDispatched&&this._videoInitialMetadataDispatched:this._hasAudio&&!this._hasVideo?this._audioInitialMetadataDispatched:!(this._hasAudio||!this._hasVideo)&&this._videoInitialMetadataDispatched},n.prototype.parseChunks=function(t,i){if(!(this._onError&&this._onMediaInfo&&this._onTrackMetadata&&this._onDataAvailable))throw new w.a("Flv: onError & onMediaInfo & onTrackMetadata & onDataAvailable callback must be specified");var e=0,a=this._littleEndian;if(i===0){if(!(t.byteLength>13))return 0;e=n.probe(t).dataOffset}for(this._firstParse&&(this._firstParse=!1,i+e!==this._dataOffset&&y.a.w(this.TAG,"First time parsing but chunk byteStart invalid!"),(s=new DataView(t,e)).getUint32(0,!a)!==0&&y.a.w(this.TAG,"PrevTagSize0 !== 0 !!!"),e+=4);e<t.byteLength;){this._dispatch=!0;var s=new DataView(t,e);if(e+11+4>t.byteLength)break;var r=s.getUint8(0),d=16777215&s.getUint32(0,!a);if(e+11+d+4>t.byteLength)break;if(r===8||r===9||r===18){var A=s.getUint8(4),S=s.getUint8(5),L=s.getUint8(6)|S<<8|A<<16|s.getUint8(7)<<24;16777215&s.getUint32(7,!a)&&y.a.w(this.TAG,"Meet tag which has StreamID != 0!");var B=e+11;switch(r){case 8:this._parseAudioData(t,B,d,L);break;case 9:this._parseVideoData(t,B,d,L,i+e);break;case 18:this._parseScriptData(t,B,d)}var T=s.getUint32(11+d,!a);T!==11+d&&y.a.w(this.TAG,"Invalid PrevTagSize "+T),e+=11+d+4}else y.a.w(this.TAG,"Unsupported tag type "+r+", skipped"),e+=11+d+4}return this._isInitialMetadataDispatched()&&this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack),e},n.prototype._parseScriptData=function(t,i,e){var a=x.parseScriptData(t,i,e);if(a.hasOwnProperty("onMetaData")){if(a.onMetaData==null||typeof a.onMetaData!="object")return void y.a.w(this.TAG,"Invalid onMetaData structure!");this._metadata&&y.a.w(this.TAG,"Found another onMetaData tag!"),this._metadata=a;var s=this._metadata.onMetaData;if(this._onMetaDataArrived&&this._onMetaDataArrived(Object.assign({},s)),typeof s.hasAudio=="boolean"&&this._hasAudioFlagOverrided===!1&&(this._hasAudio=s.hasAudio,this._mediaInfo.hasAudio=this._hasAudio),typeof s.hasVideo=="boolean"&&this._hasVideoFlagOverrided===!1&&(this._hasVideo=s.hasVideo,this._mediaInfo.hasVideo=this._hasVideo),typeof s.audiodatarate=="number"&&(this._mediaInfo.audioDataRate=s.audiodatarate),typeof s.videodatarate=="number"&&(this._mediaInfo.videoDataRate=s.videodatarate),typeof s.width=="number"&&(this._mediaInfo.width=s.width),typeof s.height=="number"&&(this._mediaInfo.height=s.height),typeof s.duration=="number"){if(!this._durationOverrided){var r=Math.floor(s.duration*this._timescale);this._duration=r,this._mediaInfo.duration=r}}else this._mediaInfo.duration=0;if(typeof s.framerate=="number"){var d=Math.floor(1e3*s.framerate);if(d>0){var A=d/1e3;this._referenceFrameRate.fixed=!0,this._referenceFrameRate.fps=A,this._referenceFrameRate.fps_num=d,this._referenceFrameRate.fps_den=1e3,this._mediaInfo.fps=A}}if(typeof s.keyframes=="object"){this._mediaInfo.hasKeyframesIndex=!0;var S=s.keyframes;this._mediaInfo.keyframesIndex=this._parseKeyframesIndex(S),s.keyframes=null}else this._mediaInfo.hasKeyframesIndex=!1;this._dispatch=!1,this._mediaInfo.metadata=s,y.a.v(this.TAG,"Parsed onMetaData"),this._mediaInfo.isComplete()&&this._onMediaInfo(this._mediaInfo)}Object.keys(a).length>0&&this._onScriptDataArrived&&this._onScriptDataArrived(Object.assign({},a))},n.prototype._parseKeyframesIndex=function(t){for(var i=[],e=[],a=1;a<t.times.length;a++){var s=this._timestampBase+Math.floor(1e3*t.times[a]);i.push(s),e.push(t.filepositions[a])}return{times:i,filepositions:e}},n.prototype._parseAudioData=function(t,i,e,a){if(e<=1)y.a.w(this.TAG,"Flv: Invalid audio packet, missing SoundData payload!");else if(this._hasAudioFlagOverrided!==!0||this._hasAudio!==!1){this._littleEndian;var s=new DataView(t,i,e).getUint8(0),r=s>>>4;if(r===2||r===10){var d=0,A=(12&s)>>>2;if(A>=0&&A<=4){d=this._flvSoundRateTable[A];var S=1&s,L=this._audioMetadata,B=this._audioTrack;if(L||(this._hasAudio===!1&&this._hasAudioFlagOverrided===!1&&(this._hasAudio=!0,this._mediaInfo.hasAudio=!0),(L=this._audioMetadata={}).type="audio",L.id=B.id,L.timescale=this._timescale,L.duration=this._duration,L.audioSampleRate=d,L.channelCount=S===0?1:2),r===10){var T=this._parseAACAudioData(t,i+1,e-1);if(T==null)return;if(T.packetType===0){if(L.config){if(l(T.data.config,L.config))return;y.a.w(this.TAG,"AudioSpecificConfig has been changed, re-generate initialization segment")}var C=T.data;L.audioSampleRate=C.samplingRate,L.channelCount=C.channelCount,L.codec=C.codec,L.originalCodec=C.originalCodec,L.config=C.config,L.refSampleDuration=1024/L.audioSampleRate*L.timescale,y.a.v(this.TAG,"Parsed AudioSpecificConfig"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._audioInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("audio",L),(F=this._mediaInfo).audioCodec=L.originalCodec,F.audioSampleRate=L.audioSampleRate,F.audioChannelCount=L.channelCount,F.hasVideo?F.videoCodec!=null&&(F.mimeType='video/x-flv; codecs="'+F.videoCodec+","+F.audioCodec+'"'):F.mimeType='video/x-flv; codecs="'+F.audioCodec+'"',F.isComplete()&&this._onMediaInfo(F)}else if(T.packetType===1){var G=this._timestampBase+a,Y={unit:T.data,length:T.data.byteLength,dts:G,pts:G};B.samples.push(Y),B.length+=T.data.length}else y.a.e(this.TAG,"Flv: Unsupported AAC data type "+T.packetType)}else if(r===2){if(!L.codec){var F;if((C=this._parseMP3AudioData(t,i+1,e-1,!0))==null)return;L.audioSampleRate=C.samplingRate,L.channelCount=C.channelCount,L.codec=C.codec,L.originalCodec=C.originalCodec,L.refSampleDuration=1152/L.audioSampleRate*L.timescale,y.a.v(this.TAG,"Parsed MPEG Audio Frame Header"),this._audioInitialMetadataDispatched=!0,this._onTrackMetadata("audio",L),(F=this._mediaInfo).audioCodec=L.codec,F.audioSampleRate=L.audioSampleRate,F.audioChannelCount=L.channelCount,F.audioDataRate=C.bitRate,F.hasVideo?F.videoCodec!=null&&(F.mimeType='video/x-flv; codecs="'+F.videoCodec+","+F.audioCodec+'"'):F.mimeType='video/x-flv; codecs="'+F.audioCodec+'"',F.isComplete()&&this._onMediaInfo(F)}var ne=this._parseMP3AudioData(t,i+1,e-1,!1);if(ne==null)return;G=this._timestampBase+a;var ae={unit:ne,length:ne.byteLength,dts:G,pts:G};B.samples.push(ae),B.length+=ne.length}}else this._onError(ee.a.FORMAT_ERROR,"Flv: Invalid audio sample rate idx: "+A)}else this._onError(ee.a.CODEC_UNSUPPORTED,"Flv: Unsupported audio codec idx: "+r)}},n.prototype._parseAACAudioData=function(t,i,e){if(!(e<=1)){var a={},s=new Uint8Array(t,i,e);return a.packetType=s[0],s[0]===0?a.data=this._parseAACAudioSpecificConfig(t,i+1,e-1):a.data=s.subarray(1),a}y.a.w(this.TAG,"Flv: Invalid AAC packet, missing AACPacketType or/and Data!")},n.prototype._parseAACAudioSpecificConfig=function(t,i,e){var a,s,r=new Uint8Array(t,i,e),d=null,A=0,S=null;if(A=a=r[0]>>>3,(s=(7&r[0])<<1|r[1]>>>7)<0||s>=this._mpegSamplingRates.length)this._onError(ee.a.FORMAT_ERROR,"Flv: AAC invalid sampling frequency index!");else{var L=this._mpegSamplingRates[s],B=(120&r[1])>>>3;if(!(B<0||B>=8)){A===5&&(S=(7&r[1])<<1|r[2]>>>7,(124&r[2])>>>2);var T=self.navigator.userAgent.toLowerCase();return T.indexOf("firefox")!==-1?s>=6?(A=5,d=new Array(4),S=s-3):(A=2,d=new Array(2),S=s):T.indexOf("android")!==-1?(A=2,d=new Array(2),S=s):(A=5,S=s,d=new Array(4),s>=6?S=s-3:B===1&&(A=2,d=new Array(2),S=s)),d[0]=A<<3,d[0]|=(15&s)>>>1,d[1]=(15&s)<<7,d[1]|=(15&B)<<3,A===5&&(d[1]|=(15&S)>>>1,d[2]=(1&S)<<7,d[2]|=8,d[3]=0),{config:d,samplingRate:L,channelCount:B,codec:"mp4a.40."+A,originalCodec:"mp4a.40."+a}}this._onError(ee.a.FORMAT_ERROR,"Flv: AAC invalid channel configuration")}},n.prototype._parseMP3AudioData=function(t,i,e,a){if(!(e<4)){this._littleEndian;var s=new Uint8Array(t,i,e),r=null;if(a){if(s[0]!==255)return;var d=s[1]>>>3&3,A=(6&s[1])>>1,S=(240&s[2])>>>4,L=(12&s[2])>>>2,B=(s[3]>>>6&3)!==3?2:1,T=0,C=0;switch(d){case 0:T=this._mpegAudioV25SampleRateTable[L];break;case 2:T=this._mpegAudioV20SampleRateTable[L];break;case 3:T=this._mpegAudioV10SampleRateTable[L]}switch(A){case 1:S<this._mpegAudioL3BitRateTable.length&&(C=this._mpegAudioL3BitRateTable[S]);break;case 2:S<this._mpegAudioL2BitRateTable.length&&(C=this._mpegAudioL2BitRateTable[S]);break;case 3:S<this._mpegAudioL1BitRateTable.length&&(C=this._mpegAudioL1BitRateTable[S])}r={bitRate:C,samplingRate:T,channelCount:B,codec:"mp3",originalCodec:"mp3"}}else r=s;return r}y.a.w(this.TAG,"Flv: Invalid MP3 packet, header missing!")},n.prototype._parseVideoData=function(t,i,e,a,s){if(e<=1)y.a.w(this.TAG,"Flv: Invalid video packet, missing VideoData payload!");else if(this._hasVideoFlagOverrided!==!0||this._hasVideo!==!1){var r=new Uint8Array(t,i,e)[0],d=(240&r)>>>4,A=15&r;if(A===7)this._parseAVCVideoPacket(t,i+1,e-1,a,s,d);else{if(A!==12)return void this._onError(ee.a.CODEC_UNSUPPORTED,"Flv: Unsupported codec in video frame: "+A);this._parseHEVCVideoPacket(t,i+1,e-1,a,s,d)}}},n.prototype._parseAVCVideoPacket=function(t,i,e,a,s,r){if(e<4)y.a.w(this.TAG,"Flv: Invalid AVC packet, missing AVCPacketType or/and CompositionTime");else{var d=this._littleEndian,A=new DataView(t,i,e),S=A.getUint8(0),L=(16777215&A.getUint32(0,!d))<<8>>8;if(S===0)this._parseAVCDecoderConfigurationRecord(t,i+4,e-4);else if(S===1)this._parseAVCVideoData(t,i+4,e-4,a,s,r,L);else if(S!==2)return void this._onError(ee.a.FORMAT_ERROR,"Flv: Invalid video packet type "+S)}},n.prototype._parseHEVCVideoPacket=function(t,i,e,a,s,r){if(e<4)y.a.w(this.TAG,"Flv: Invalid HEVC packet, missing HEVCPacketType or/and CompositionTime");else{var d=this._littleEndian,A=new DataView(t,i,e),S=A.getUint8(0),L=(16777215&A.getUint32(0,!d))<<8>>8;if(S===0)this._parseHEVCDecoderConfigurationRecord(t,i+4,e-4);else if(S===1)this._parseHEVCVideoData(t,i+4,e-4,a,s,r,L);else if(S!==2)return void this._onError(ee.a.FORMAT_ERROR,"Flv: Invalid video packet type "+S)}},n.prototype._parseAVCDecoderConfigurationRecord=function(t,i,e){if(e<7)y.a.w(this.TAG,"Flv: Invalid AVCDecoderConfigurationRecord, lack of data!");else{var a=this._videoMetadata,s=this._videoTrack,r=this._littleEndian,d=new DataView(t,i,e);if(a){if(a.avcc!==void 0){var A=new Uint8Array(t,i,e);if(l(A,a.avcc))return;y.a.w(this.TAG,"AVCDecoderConfigurationRecord has been changed, re-generate initialization segment")}}else this._hasVideo===!1&&this._hasVideoFlagOverrided===!1&&(this._hasVideo=!0,this._mediaInfo.hasVideo=!0),(a=this._videoMetadata={}).type="video",a.id=s.id,a.timescale=this._timescale,a.duration=this._duration;var S=d.getUint8(0),L=d.getUint8(1);if(d.getUint8(2),d.getUint8(3),S===1&&L!==0)if(this._naluLengthSize=1+(3&d.getUint8(4)),this._naluLengthSize===3||this._naluLengthSize===4){var B=31&d.getUint8(5);if(B!==0){B>1&&y.a.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: SPS Count = "+B);for(var T=6,C=0;C<B;C++){var G=d.getUint16(T,!r);if(T+=2,G!==0){var Y=new Uint8Array(t,i+T,G);T+=G;var F=ce.parseSPS(Y);if(C===0){a.codecWidth=F.codec_size.width,a.codecHeight=F.codec_size.height,a.presentWidth=F.present_size.width,a.presentHeight=F.present_size.height,a.profile=F.profile_string,a.level=F.level_string,a.bitDepth=F.bit_depth,a.chromaFormat=F.chroma_format,a.sarRatio=F.sar_ratio,a.frameRate=F.frame_rate,F.frame_rate.fixed!==!1&&F.frame_rate.fps_num!==0&&F.frame_rate.fps_den!==0||(a.frameRate=this._referenceFrameRate);var ne=a.frameRate.fps_den,ae=a.frameRate.fps_num;a.refSampleDuration=a.timescale*(ne/ae);for(var Z=Y.subarray(1,4),ge="avc1.",ie=0;ie<3;ie++){var W=Z[ie].toString(16);W.length<2&&(W="0"+W),ge+=W}a.codec=ge;var ue=this._mediaInfo;ue.width=a.codecWidth,ue.height=a.codecHeight,ue.fps=a.frameRate.fps,ue.profile=a.profile,ue.level=a.level,ue.refFrames=F.ref_frames,ue.chromaFormat=F.chroma_format_string,ue.sarNum=a.sarRatio.width,ue.sarDen=a.sarRatio.height,ue.videoCodec=ge,ue.hasAudio?ue.audioCodec!=null&&(ue.mimeType='video/x-flv; codecs="'+ue.videoCodec+","+ue.audioCodec+'"'):ue.mimeType='video/x-flv; codecs="'+ue.videoCodec+'"',ue.isComplete()&&this._onMediaInfo(ue)}}}var Se=d.getUint8(T);if(Se!==0){for(Se>1&&y.a.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: PPS Count = "+Se),T++,C=0;C<Se;C++)G=d.getUint16(T,!r),T+=2,G!==0&&(T+=G);a.avcc=new Uint8Array(e),a.avcc.set(new Uint8Array(t,i,e),0),y.a.v(this.TAG,"Parsed AVCDecoderConfigurationRecord"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._videoInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("video",a)}else this._onError(ee.a.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No PPS")}else this._onError(ee.a.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No SPS")}else this._onError(ee.a.FORMAT_ERROR,"Flv: Strange NaluLengthSizeMinusOne: "+(this._naluLengthSize-1));else this._onError(ee.a.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord")}},n.prototype._parseHEVCDecoderConfigurationRecord=function(t,i,e){if(e<22)y.a.w(this.TAG,"Flv: Invalid HEVCDecoderConfigurationRecord, lack of data!");else{var a=this._videoMetadata,s=this._videoTrack,r=this._littleEndian,d=new DataView(t,i,e);if(a){if(a.hvcc!==void 0){var A=new Uint8Array(t,i,e);if(l(A,a.hvcc))return;y.a.w(this.TAG,"HEVCDecoderConfigurationRecord has been changed, re-generate initialization segment")}}else this._hasVideo===!1&&this._hasVideoFlagOverrided===!1&&(this._hasVideo=!0,this._mediaInfo.hasVideo=!0),(a=this._videoMetadata={}).type="video",a.id=s.id,a.timescale=this._timescale,a.duration=this._duration;var S=d.getUint8(0),L=31&d.getUint8(1);if(S===1&&L!==0)if(this._naluLengthSize=1+(3&d.getUint8(21)),this._naluLengthSize===3||this._naluLengthSize===4){for(var B=d.getUint8(22),T=0,C=23;T<B;T++){var G=63&d.getUint8(C+0),Y=d.getUint16(C+1,!r);C+=3;for(var F=0;F<Y;F++){var ne=d.getUint16(C+0,!r);if(F===0)if(G===33){C+=2;var ae=new Uint8Array(t,i+C,ne),Z=re.parseSPS(ae);a.codecWidth=Z.codec_size.width,a.codecHeight=Z.codec_size.height,a.presentWidth=Z.present_size.width,a.presentHeight=Z.present_size.height,a.profile=Z.profile_string,a.level=Z.level_string,a.bitDepth=Z.bit_depth,a.chromaFormat=Z.chroma_format,a.sarRatio=Z.sar_ratio,a.frameRate=Z.frame_rate,Z.frame_rate.fixed!==!1&&Z.frame_rate.fps_num!==0&&Z.frame_rate.fps_den!==0||(a.frameRate=this._referenceFrameRate);var ge=a.frameRate.fps_den,ie=a.frameRate.fps_num;a.refSampleDuration=a.timescale*(ge/ie),a.codec=Z.codec_mimetype;var W=this._mediaInfo;W.width=a.codecWidth,W.height=a.codecHeight,W.fps=a.frameRate.fps,W.profile=a.profile,W.level=a.level,W.refFrames=Z.ref_frames,W.chromaFormat=Z.chroma_format_string,W.sarNum=a.sarRatio.width,W.sarDen=a.sarRatio.height,W.videoCodec=Z.codec_mimetype,W.hasAudio?W.audioCodec!=null&&(W.mimeType='video/x-flv; codecs="'+W.videoCodec+","+W.audioCodec+'"'):W.mimeType='video/x-flv; codecs="'+W.videoCodec+'"',W.isComplete()&&this._onMediaInfo(W),C+=ne}else C+=2+ne;else C+=2+ne}}a.hvcc=new Uint8Array(e),a.hvcc.set(new Uint8Array(t,i,e),0),y.a.v(this.TAG,"Parsed HEVCDecoderConfigurationRecord"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._videoInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("video",a)}else this._onError(ee.a.FORMAT_ERROR,"Flv: Strange NaluLengthSizeMinusOne: "+(this._naluLengthSize-1));else this._onError(ee.a.FORMAT_ERROR,"Flv: Invalid HEVCDecoderConfigurationRecord")}},n.prototype._parseAVCVideoData=function(t,i,e,a,s,r,d){for(var A=this._littleEndian,S=new DataView(t,i,e),L=[],B=0,T=0,C=this._naluLengthSize,G=this._timestampBase+a,Y=r===1;T<e;){if(T+4>=e){y.a.w(this.TAG,"Malformed Nalu near timestamp "+G+", offset = "+T+", dataSize = "+e);break}var F=S.getUint32(T,!A);if(C===3&&(F>>>=8),F>e-C)return void y.a.w(this.TAG,"Malformed Nalus near timestamp "+G+", NaluSize > DataSize!");var ne=31&S.getUint8(T+C);ne===5&&(Y=!0);var ae=new Uint8Array(t,i+T,C+F),Z={type:ne,data:ae};L.push(Z),B+=ae.byteLength,T+=C+F}if(L.length){var ge=this._videoTrack,ie={units:L,length:B,isKeyframe:Y,dts:G,cts:d,pts:G+d};Y&&(ie.fileposition=s),ge.samples.push(ie),ge.length+=B}},n.prototype._parseHEVCVideoData=function(t,i,e,a,s,r,d){for(var A=this._littleEndian,S=new DataView(t,i,e),L=[],B=0,T=0,C=this._naluLengthSize,G=this._timestampBase+a,Y=r===1;T<e;){if(T+4>=e){y.a.w(this.TAG,"Malformed Nalu near timestamp "+G+", offset = "+T+", dataSize = "+e);break}var F=S.getUint32(T,!A);if(C===3&&(F>>>=8),F>e-C)return void y.a.w(this.TAG,"Malformed Nalus near timestamp "+G+", NaluSize > DataSize!");var ne=31&S.getUint8(T+C);ne!==19&&ne!==20||(Y=!0);var ae=new Uint8Array(t,i+T,C+F),Z={type:ne,data:ae};L.push(Z),B+=ae.byteLength,T+=C+F}if(L.length){var ge=this._videoTrack,ie={units:L,length:B,isKeyframe:Y,dts:G,cts:d,pts:G+d};Y&&(ie.fileposition=s),ge.samples.push(ie),ge.length+=B}},n}(),p=function(){function n(){}return n.prototype.destroy=function(){this.onError=null,this.onMediaInfo=null,this.onMetaDataArrived=null,this.onTrackMetadata=null,this.onDataAvailable=null,this.onTimedID3Metadata=null,this.onSMPTE2038Metadata=null,this.onSCTE35Metadata=null,this.onPESPrivateData=null,this.onPESPrivateDataDescriptor=null},n}(),U=function(){this.program_pmt_pid={}};(function(n){n[n.kMPEG1Audio=3]="kMPEG1Audio",n[n.kMPEG2Audio=4]="kMPEG2Audio",n[n.kPESPrivateData=6]="kPESPrivateData",n[n.kADTSAAC=15]="kADTSAAC",n[n.kID3=21]="kID3",n[n.kSCTE35=134]="kSCTE35",n[n.kH264=27]="kH264",n[n.kH265=36]="kH265"})(c||(c={}));var D,j=function(){this.pid_stream_type={},this.common_pids={h264:void 0,h265:void 0,adts_aac:void 0,mp3:void 0},this.pes_private_data_pids={},this.timed_id3_pids={},this.scte_35_pids={},this.smpte2038_pids={}},oe=function(){},be=function(){},le=function(){this.slices=[],this.total_length=0,this.expected_length=0,this.file_position=0};(function(n){n[n.kUnspecified=0]="kUnspecified",n[n.kSliceNonIDR=1]="kSliceNonIDR",n[n.kSliceDPA=2]="kSliceDPA",n[n.kSliceDPB=3]="kSliceDPB",n[n.kSliceDPC=4]="kSliceDPC",n[n.kSliceIDR=5]="kSliceIDR",n[n.kSliceSEI=6]="kSliceSEI",n[n.kSliceSPS=7]="kSliceSPS",n[n.kSlicePPS=8]="kSlicePPS",n[n.kSliceAUD=9]="kSliceAUD",n[n.kEndOfSequence=10]="kEndOfSequence",n[n.kEndOfStream=11]="kEndOfStream",n[n.kFiller=12]="kFiller",n[n.kSPSExt=13]="kSPSExt",n[n.kReserved0=14]="kReserved0"})(D||(D={}));var k,o,h=function(){},E=function(n){var t=n.data.byteLength;this.type=n.type,this.data=new Uint8Array(4+t),new DataView(this.data.buffer).setUint32(0,t),this.data.set(n.data,4)},X=function(){function n(t){this.TAG="H264AnnexBParser",this.current_startcode_offset_=0,this.eof_flag_=!1,this.data_=t,this.current_startcode_offset_=this.findNextStartCodeOffset(0),this.eof_flag_&&y.a.e(this.TAG,"Could not find H264 startcode until payload end!")}return n.prototype.findNextStartCodeOffset=function(t){for(var i=t,e=this.data_;;){if(i+3>=e.byteLength)return this.eof_flag_=!0,e.byteLength;var a=e[i+0]<<24|e[i+1]<<16|e[i+2]<<8|e[i+3],s=e[i+0]<<16|e[i+1]<<8|e[i+2];if(a===1||s===1)return i;i++}},n.prototype.readNextNaluPayload=function(){for(var t=this.data_,i=null;i==null&&!this.eof_flag_;){var e=this.current_startcode_offset_,a=31&t[e+=(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])===1?4:3],s=(128&t[e])>>>7,r=this.findNextStartCodeOffset(e);if(this.current_startcode_offset_=r,!(a>=D.kReserved0)&&s===0){var d=t.subarray(e,r);(i=new h).type=a,i.data=d}}return i},n}(),_e=function(){function n(t,i,e){var a=8+t.byteLength+1+2+i.byteLength,s=!1;t[3]!==66&&t[3]!==77&&t[3]!==88&&(s=!0,a+=4);var r=this.data=new Uint8Array(a);r[0]=1,r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=255,r[5]=225;var d=t.byteLength;r[6]=d>>>8,r[7]=255&d;var A=8;r.set(t,8),r[A+=d]=1;var S=i.byteLength;r[A+1]=S>>>8,r[A+2]=255&S,r.set(i,A+3),A+=3+S,s&&(r[A]=252|e.chroma_format_idc,r[A+1]=248|e.bit_depth_luma-8,r[A+2]=248|e.bit_depth_chroma-8,r[A+3]=0,A+=4)}return n.prototype.getData=function(){return this.data},n}();(function(n){n[n.kNull=0]="kNull",n[n.kAACMain=1]="kAACMain",n[n.kAAC_LC=2]="kAAC_LC",n[n.kAAC_SSR=3]="kAAC_SSR",n[n.kAAC_LTP=4]="kAAC_LTP",n[n.kAAC_SBR=5]="kAAC_SBR",n[n.kAAC_Scalable=6]="kAAC_Scalable",n[n.kLayer1=32]="kLayer1",n[n.kLayer2=33]="kLayer2",n[n.kLayer3=34]="kLayer3"})(k||(k={})),function(n){n[n.k96000Hz=0]="k96000Hz",n[n.k88200Hz=1]="k88200Hz",n[n.k64000Hz=2]="k64000Hz",n[n.k48000Hz=3]="k48000Hz",n[n.k44100Hz=4]="k44100Hz",n[n.k32000Hz=5]="k32000Hz",n[n.k24000Hz=6]="k24000Hz",n[n.k22050Hz=7]="k22050Hz",n[n.k16000Hz=8]="k16000Hz",n[n.k12000Hz=9]="k12000Hz",n[n.k11025Hz=10]="k11025Hz",n[n.k8000Hz=11]="k8000Hz",n[n.k7350Hz=12]="k7350Hz"}(o||(o={}));var me,Oe=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],ze=function(){},Ce=function(){function n(t){this.TAG="AACADTSParser",this.data_=t,this.current_syncword_offset_=this.findNextSyncwordOffset(0),this.eof_flag_&&y.a.e(this.TAG,"Could not found ADTS syncword until payload end")}return n.prototype.findNextSyncwordOffset=function(t){for(var i=t,e=this.data_;;){if(i+7>=e.byteLength)return this.eof_flag_=!0,e.byteLength;if((e[i+0]<<8|e[i+1])>>>4===4095)return i;i++}},n.prototype.readNextAACFrame=function(){for(var t=this.data_,i=null;i==null&&!this.eof_flag_;){var e=this.current_syncword_offset_,a=(8&t[e+1])>>>3,s=(6&t[e+1])>>>1,r=1&t[e+1],d=(192&t[e+2])>>>6,A=(60&t[e+2])>>>2,S=(1&t[e+2])<<2|(192&t[e+3])>>>6,L=(3&t[e+3])<<11|t[e+4]<<3|(224&t[e+5])>>>5;if(t[e+6],e+L>this.data_.byteLength){this.eof_flag_=!0,this.has_last_incomplete_data=!0;break}var B=r===1?7:9,T=L-B;e+=B;var C=this.findNextSyncwordOffset(e+T);if(this.current_syncword_offset_=C,(a===0||a===1)&&s===0){var G=t.subarray(e,e+T);(i=new ze).audio_object_type=d+1,i.sampling_freq_index=A,i.sampling_frequency=Oe[A],i.channel_config=S,i.data=G}}return i},n.prototype.hasIncompleteData=function(){return this.has_last_incomplete_data},n.prototype.getIncompleteData=function(){return this.has_last_incomplete_data?this.data_.subarray(this.current_syncword_offset_):null},n}(),N=function(n){var t=null,i=n.audio_object_type,e=n.audio_object_type,a=n.sampling_freq_index,s=n.channel_config,r=0,d=navigator.userAgent.toLowerCase();d.indexOf("firefox")!==-1?a>=6?(e=5,t=new Array(4),r=a-3):(e=2,t=new Array(2),r=a):d.indexOf("android")!==-1?(e=2,t=new Array(2),r=a):(e=5,r=a,t=new Array(4),a>=6?r=a-3:s===1&&(e=2,t=new Array(2),r=a)),t[0]=e<<3,t[0]|=(15&a)>>>1,t[1]=(15&a)<<7,t[1]|=(15&s)<<3,e===5&&(t[1]|=(15&r)>>>1,t[2]=(1&r)<<7,t[2]|=8,t[3]=0),this.config=t,this.sampling_rate=Oe[a],this.channel_count=s,this.codec_mimetype="mp4a.40."+e,this.original_codec_mimetype="mp4a.40."+i},$=function(){},se=function(){};(function(n){n[n.kSpliceNull=0]="kSpliceNull",n[n.kSpliceSchedule=4]="kSpliceSchedule",n[n.kSpliceInsert=5]="kSpliceInsert",n[n.kTimeSignal=6]="kTimeSignal",n[n.kBandwidthReservation=7]="kBandwidthReservation",n[n.kPrivateCommand=255]="kPrivateCommand"})(me||(me={}));var te,de=function(n){var t=n.readBool();return t?(n.readBits(6),{time_specified_flag:t,pts_time:4*n.readBits(31)+n.readBits(2)}):(n.readBits(7),{time_specified_flag:t})},ye=function(n){var t=n.readBool();return n.readBits(6),{auto_return:t,duration:4*n.readBits(31)+n.readBits(2)}},xe=function(n,t){var i=t.readBits(8);return n?{component_tag:i}:{component_tag:i,splice_time:de(t)}},Ge=function(n){return{component_tag:n.readBits(8),utc_splice_time:n.readBits(32)}},qe=function(n){var t=n.readBits(32),i=n.readBool();n.readBits(7);var e={splice_event_id:t,splice_event_cancel_indicator:i};if(i)return e;if(e.out_of_network_indicator=n.readBool(),e.program_splice_flag=n.readBool(),e.duration_flag=n.readBool(),n.readBits(5),e.program_splice_flag)e.utc_splice_time=n.readBits(32);else{e.component_count=n.readBits(8),e.components=[];for(var a=0;a<e.component_count;a++)e.components.push(Ge(n))}return e.duration_flag&&(e.break_duration=ye(n)),e.unique_program_id=n.readBits(16),e.avail_num=n.readBits(8),e.avails_expected=n.readBits(8),e},Q=function(n,t,i,e){return{descriptor_tag:n,descriptor_length:t,identifier:i,provider_avail_id:e.readBits(32)}},K=function(n,t,i,e){var a=e.readBits(8),s=e.readBits(3);e.readBits(5);for(var r="",d=0;d<s;d++)r+=String.fromCharCode(e.readBits(8));return{descriptor_tag:n,descriptor_length:t,identifier:i,preroll:a,dtmf_count:s,DTMF_char:r}},ke=function(n){var t=n.readBits(8);return n.readBits(7),{component_tag:t,pts_offset:4*n.readBits(31)+n.readBits(2)}},Je=function(n,t,i,e){var a=e.readBits(32),s=e.readBool();e.readBits(7);var r={descriptor_tag:n,descriptor_length:t,identifier:i,segmentation_event_id:a,segmentation_event_cancel_indicator:s};if(s)return r;if(r.program_segmentation_flag=e.readBool(),r.segmentation_duration_flag=e.readBool(),r.delivery_not_restricted_flag=e.readBool(),r.delivery_not_restricted_flag?e.readBits(5):(r.web_delivery_allowed_flag=e.readBool(),r.no_regional_blackout_flag=e.readBool(),r.archive_allowed_flag=e.readBool(),r.device_restrictions=e.readBits(2)),!r.program_segmentation_flag){r.component_count=e.readBits(8),r.components=[];for(var d=0;d<r.component_count;d++)r.components.push(ke(e))}r.segmentation_duration_flag&&(r.segmentation_duration=e.readBits(40)),r.segmentation_upid_type=e.readBits(8),r.segmentation_upid_length=e.readBits(8);var A=new Uint8Array(r.segmentation_upid_length);for(d=0;d<r.segmentation_upid_length;d++)A[d]=e.readBits(8);return r.segmentation_upid=A.buffer,r.segmentation_type_id=e.readBits(8),r.segment_num=e.readBits(8),r.segments_expected=e.readBits(8),r.segmentation_type_id!==52&&r.segmentation_type_id!==54&&r.segmentation_type_id!==56&&r.segmentation_type_id!==58||(r.sub_segment_num=e.readBits(8),r.sub_segments_expected=e.readBits(8)),r},tt=function(n,t,i,e){return{descriptor_tag:n,descriptor_length:t,identifier:i,TAI_seconds:e.readBits(48),TAI_ns:e.readBits(32),UTC_offset:e.readBits(16)}},St=function(n){return{component_tag:n.readBits(8),ISO_code:String.fromCharCode(n.readBits(8),n.readBits(8),n.readBits(8)),Bit_Stream_Mode:n.readBits(3),Num_Channels:n.readBits(4),Full_Srvc_Audio:n.readBool()}},J=function(n,t,i,e){for(var a=e.readBits(4),s=[],r=0;r<a;r++)s.push(St(e));return{descriptor_tag:n,descriptor_length:t,identifier:i,audio_count:a,components:s}},Ne=function(n){var t=new pe(n),i=t.readBits(8),e=t.readBool(),a=t.readBool();t.readBits(2);var s=t.readBits(12),r=t.readBits(8),d=t.readBool(),A=t.readBits(6),S=4*t.readBits(31)+t.readBits(2),L=t.readBits(8),B=t.readBits(12),T=t.readBits(12),C=t.readBits(8),G=null;C===me.kSpliceNull?G={}:C===me.kSpliceSchedule?G=function(ve){for(var we=ve.readBits(8),Le=[],fe=0;fe<we;fe++)Le.push(qe(ve));return{splice_count:we,events:Le}}(t):C===me.kSpliceInsert?G=function(ve){var we=ve.readBits(32),Le=ve.readBool();ve.readBits(7);var fe={splice_event_id:we,splice_event_cancel_indicator:Le};if(Le)return fe;if(fe.out_of_network_indicator=ve.readBool(),fe.program_splice_flag=ve.readBool(),fe.duration_flag=ve.readBool(),fe.splice_immediate_flag=ve.readBool(),ve.readBits(4),fe.program_splice_flag&&!fe.splice_immediate_flag&&(fe.splice_time=de(ve)),!fe.program_splice_flag){fe.component_count=ve.readBits(8),fe.components=[];for(var Ae=0;Ae<fe.component_count;Ae++)fe.components.push(xe(fe.splice_immediate_flag,ve))}return fe.duration_flag&&(fe.break_duration=ye(ve)),fe.unique_program_id=ve.readBits(16),fe.avail_num=ve.readBits(8),fe.avails_expected=ve.readBits(8),fe}(t):C===me.kTimeSignal?G=function(ve){return{splice_time:de(ve)}}(t):C===me.kBandwidthReservation?G={}:C===me.kPrivateCommand?G=function(ve,we){for(var Le=String.fromCharCode(we.readBits(8),we.readBits(8),we.readBits(8),we.readBits(8)),fe=new Uint8Array(ve-4),Ae=0;Ae<ve-4;Ae++)fe[Ae]=we.readBits(8);return{identifier:Le,private_data:fe.buffer}}(T,t):t.readBits(8*T);for(var Y=[],F=t.readBits(16),ne=0;ne<F;){var ae=t.readBits(8),Z=t.readBits(8),ge=String.fromCharCode(t.readBits(8),t.readBits(8),t.readBits(8),t.readBits(8));ae===0?Y.push(Q(ae,Z,ge,t)):ae===1?Y.push(K(ae,Z,ge,t)):ae===2?Y.push(Je(ae,Z,ge,t)):ae===3?Y.push(tt(ae,Z,ge,t)):ae===4?Y.push(J(ae,Z,ge,t)):t.readBits(8*(Z-4)),ne+=2+Z}var ie={table_id:i,section_syntax_indicator:e,private_indicator:a,section_length:s,protocol_version:r,encrypted_packet:d,encryption_algorithm:A,pts_adjustment:S,cw_index:L,tier:B,splice_command_length:T,splice_command_type:C,splice_command:G,descriptor_loop_length:F,splice_descriptors:Y,E_CRC32:d?t.readBits(32):void 0,CRC32:t.readBits(32)};if(C===me.kSpliceInsert){var W=G;if(W.splice_event_cancel_indicator)return{splice_command_type:C,detail:ie,data:n};if(W.program_splice_flag&&!W.splice_immediate_flag){var ue=W.duration_flag?W.break_duration.auto_return:void 0,Se=W.duration_flag?W.break_duration.duration/90:void 0;return W.splice_time.time_specified_flag?{splice_command_type:C,pts:(S+W.splice_time.pts_time)%Math.pow(2,33),auto_return:ue,duraiton:Se,detail:ie,data:n}:{splice_command_type:C,auto_return:ue,duraiton:Se,detail:ie,data:n}}return{splice_command_type:C,auto_return:ue=W.duration_flag?W.break_duration.auto_return:void 0,duraiton:Se=W.duration_flag?W.break_duration.duration/90:void 0,detail:ie,data:n}}if(C===me.kTimeSignal){var Pe=G;return Pe.splice_time.time_specified_flag?{splice_command_type:C,pts:(S+Pe.splice_time.pts_time)%Math.pow(2,33),detail:ie,data:n}:{splice_command_type:C,detail:ie,data:n}}return{splice_command_type:C,detail:ie,data:n}};(function(n){n[n.kSliceIDR_W_RADL=19]="kSliceIDR_W_RADL",n[n.kSliceIDR_N_LP=20]="kSliceIDR_N_LP",n[n.kSliceCRA_NUT=21]="kSliceCRA_NUT",n[n.kSliceVPS=32]="kSliceVPS",n[n.kSliceSPS=33]="kSliceSPS",n[n.kSlicePPS=34]="kSlicePPS",n[n.kSliceAUD=35]="kSliceAUD"})(te||(te={}));var Ke,ti=function(){},ii=function(n){var t=n.data.byteLength;this.type=n.type,this.data=new Uint8Array(4+t),new DataView(this.data.buffer).setUint32(0,t),this.data.set(n.data,4)},ni=function(){function n(t){this.TAG="H265AnnexBParser",this.current_startcode_offset_=0,this.eof_flag_=!1,this.data_=t,this.current_startcode_offset_=this.findNextStartCodeOffset(0),this.eof_flag_&&y.a.e(this.TAG,"Could not find H265 startcode until payload end!")}return n.prototype.findNextStartCodeOffset=function(t){for(var i=t,e=this.data_;;){if(i+3>=e.byteLength)return this.eof_flag_=!0,e.byteLength;var a=e[i+0]<<24|e[i+1]<<16|e[i+2]<<8|e[i+3],s=e[i+0]<<16|e[i+1]<<8|e[i+2];if(a===1||s===1)return i;i++}},n.prototype.readNextNaluPayload=function(){for(var t=this.data_,i=null;i==null&&!this.eof_flag_;){var e=this.current_startcode_offset_,a=t[e+=(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])===1?4:3]>>1&63,s=(128&t[e])>>>7,r=this.findNextStartCodeOffset(e);if(this.current_startcode_offset_=r,s===0){var d=t.subarray(e,r);(i=new ti).type=a,i.data=d}}return i},n}(),ai=function(){function n(t,i,e,a){var s=23+(5+t.byteLength)+(5+i.byteLength)+(5+e.byteLength),r=this.data=new Uint8Array(s);r[0]=1,r[1]=(3&a.general_profile_space)<<6|(a.general_tier_flag?1:0)<<5|31&a.general_profile_idc,r[2]=a.general_profile_compatibility_flags_1,r[3]=a.general_profile_compatibility_flags_2,r[4]=a.general_profile_compatibility_flags_3,r[5]=a.general_profile_compatibility_flags_4,r[6]=a.general_constraint_indicator_flags_1,r[7]=a.general_constraint_indicator_flags_2,r[8]=a.general_constraint_indicator_flags_3,r[9]=a.general_constraint_indicator_flags_4,r[10]=a.general_constraint_indicator_flags_5,r[11]=a.general_constraint_indicator_flags_6,r[12]=60,r[13]=240|(3840&a.min_spatial_segmentation_idc)>>8,r[14]=255&a.min_spatial_segmentation_idc,r[15]=252|3&a.parallelismType,r[16]=252|3&a.chroma_format_idc,r[17]=248|7&a.bit_depth_luma_minus8,r[18]=248|7&a.bit_depth_chroma_minus8,r[19]=0,r[20]=0,r[21]=(3&a.constant_frame_rate)<<6|(7&a.num_temporal_layers)<<3|(a.temporal_id_nested?1:0)<<2|3,r[22]=3,r[23]=128|te.kSliceVPS,r[24]=0,r[25]=1,r[26]=(65280&t.byteLength)>>8,r[27]=(255&t.byteLength)>>0,r.set(t,28),r[23+(5+t.byteLength)+0]=128|te.kSliceSPS,r[23+(5+t.byteLength)+1]=0,r[23+(5+t.byteLength)+2]=1,r[23+(5+t.byteLength)+3]=(65280&i.byteLength)>>8,r[23+(5+t.byteLength)+4]=(255&i.byteLength)>>0,r.set(i,23+(5+t.byteLength)+5),r[23+(5+t.byteLength+5+i.byteLength)+0]=128|te.kSlicePPS,r[23+(5+t.byteLength+5+i.byteLength)+1]=0,r[23+(5+t.byteLength+5+i.byteLength)+2]=1,r[23+(5+t.byteLength+5+i.byteLength)+3]=(65280&e.byteLength)>>8,r[23+(5+t.byteLength+5+i.byteLength)+4]=(255&e.byteLength)>>0,r.set(e,23+(5+t.byteLength+5+i.byteLength)+5)}return n.prototype.getData=function(){return this.data},n}(),ri=function(){},si=function(){},oi=(Ke=function(n,t){return(Ke=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,e){i.__proto__=e}||function(i,e){for(var a in e)e.hasOwnProperty(a)&&(i[a]=e[a])})(n,t)},function(n,t){function i(){this.constructor=n}Ke(n,t),n.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}),st=function(){return(st=Object.assign||function(n){for(var t,i=1,e=arguments.length;i<e;i++)for(var a in t=arguments[i])Object.prototype.hasOwnProperty.call(t,a)&&(n[a]=t[a]);return n}).apply(this,arguments)},It=function(n){function t(i,e){var a=n.call(this)||this;return a.TAG="TSDemuxer",a.first_parse_=!0,a.media_info_=new m.a,a.timescale_=90,a.duration_=0,a.current_pmt_pid_=-1,a.program_pmt_map_={},a.pes_slice_queues_={},a.section_slice_queues_={},a.video_metadata_={vps:void 0,sps:void 0,pps:void 0,details:void 0},a.audio_metadata_={codec:void 0,audio_object_type:void 0,sampling_freq_index:void 0,sampling_frequency:void 0,channel_config:void 0},a.aac_last_sample_pts_=void 0,a.aac_last_incomplete_data_=null,a.has_video_=!1,a.has_audio_=!1,a.video_init_segment_dispatched_=!1,a.audio_init_segment_dispatched_=!1,a.video_metadata_changed_=!1,a.audio_metadata_changed_=!1,a.video_track_={type:"video",id:1,sequenceNumber:0,samples:[],length:0},a.audio_track_={type:"audio",id:2,sequenceNumber:0,samples:[],length:0},a.ts_packet_size_=i.ts_packet_size,a.sync_offset_=i.sync_offset,a.config_=e,a}return oi(t,n),t.prototype.destroy=function(){this.media_info_=null,this.pes_slice_queues_=null,this.section_slice_queues_=null,this.video_metadata_=null,this.audio_metadata_=null,this.aac_last_incomplete_data_=null,this.video_track_=null,this.audio_track_=null,n.prototype.destroy.call(this)},t.probe=function(i){var e=new Uint8Array(i),a=-1,s=188;if(e.byteLength<=3*s)return{needMoreData:!0};for(;a===-1;){for(var r=Math.min(1e3,e.byteLength-3*s),d=0;d<r;){if(e[d]===71&&e[d+s]===71&&e[d+2*s]===71){a=d;break}d++}if(a===-1)if(s===188)s=192;else{if(s!==192)break;s=204}}return a===-1?{match:!1}:(s===192&&a>=4?(y.a.v("TSDemuxer","ts_packet_size = 192, m2ts mode"),a-=4):s===204&&y.a.v("TSDemuxer","ts_packet_size = 204, RS encoded MPEG2-TS stream"),{match:!0,consumed:0,ts_packet_size:s,sync_offset:a})},t.prototype.bindDataSource=function(i){return i.onDataArrival=this.parseChunks.bind(this),this},t.prototype.resetMediaInfo=function(){this.media_info_=new m.a},t.prototype.parseChunks=function(i,e){if(!(this.onError&&this.onMediaInfo&&this.onTrackMetadata&&this.onDataAvailable))throw new w.a("onError & onMediaInfo & onTrackMetadata & onDataAvailable callback must be specified");var a=0;for(this.first_parse_&&(this.first_parse_=!1,a=this.sync_offset_);a+this.ts_packet_size_<=i.byteLength;){var s=e+a;this.ts_packet_size_===192&&(a+=4);var r=new Uint8Array(i,a,188),d=r[0];if(d!==71){y.a.e(this.TAG,"sync_byte = "+d+", not 0x47");break}var A=(64&r[1])>>>6,S=(r[1],(31&r[1])<<8|r[2]),L=(48&r[3])>>>4,B=15&r[3],T={},C=4;if(L==2||L==3){var G=r[4];if(5+G===188){a+=188,this.ts_packet_size_===204&&(a+=16);continue}G>0&&(T=this.parseAdaptationField(i,a+4,1+G)),C=5+G}if(L==1||L==3){if(S===0||S===this.current_pmt_pid_||this.pmt_!=null&&this.pmt_.pid_stream_type[S]===c.kSCTE35){var Y=188-C;this.handleSectionSlice(i,a+C,Y,{pid:S,file_position:s,payload_unit_start_indicator:A,continuity_conunter:B,random_access_indicator:T.random_access_indicator})}else if(this.pmt_!=null&&this.pmt_.pid_stream_type[S]!=null){Y=188-C;var F=this.pmt_.pid_stream_type[S];S!==this.pmt_.common_pids.h264&&S!==this.pmt_.common_pids.h265&&S!==this.pmt_.common_pids.adts_aac&&S!==this.pmt_.common_pids.mp3&&this.pmt_.pes_private_data_pids[S]!==!0&&this.pmt_.timed_id3_pids[S]!==!0||this.handlePESSlice(i,a+C,Y,{pid:S,stream_type:F,file_position:s,payload_unit_start_indicator:A,continuity_conunter:B,random_access_indicator:T.random_access_indicator})}}a+=188,this.ts_packet_size_===204&&(a+=16)}return this.dispatchAudioVideoMediaSegment(),a},t.prototype.parseAdaptationField=function(i,e,a){var s=new Uint8Array(i,e,a),r=s[0];return r>0?r>183?(y.a.w(this.TAG,"Illegal adaptation_field_length: "+r),{}):{discontinuity_indicator:(128&s[1])>>>7,random_access_indicator:(64&s[1])>>>6,elementary_stream_priority_indicator:(32&s[1])>>>5}:{}},t.prototype.handleSectionSlice=function(i,e,a,s){var r=new Uint8Array(i,e,a),d=this.section_slice_queues_[s.pid];if(s.payload_unit_start_indicator){var A=r[0];if(d!=null&&d.total_length!==0){var S=new Uint8Array(i,e+1,Math.min(a,A));d.slices.push(S),d.total_length+=S.byteLength,d.total_length===d.expected_length?this.emitSectionSlices(d,s):this.clearSlices(d,s)}for(var L=1+A;L<r.byteLength&&r[L+0]!==255;){var B=(15&r[L+1])<<8|r[L+2];this.section_slice_queues_[s.pid]=new le,(d=this.section_slice_queues_[s.pid]).expected_length=B+3,d.file_position=s.file_position,d.random_access_indicator=s.random_access_indicator,S=new Uint8Array(i,e+L,Math.min(a-L,d.expected_length-d.total_length)),d.slices.push(S),d.total_length+=S.byteLength,d.total_length===d.expected_length?this.emitSectionSlices(d,s):d.total_length>=d.expected_length&&this.clearSlices(d,s),L+=S.byteLength}}else d!=null&&d.total_length!==0&&(S=new Uint8Array(i,e,Math.min(a,d.expected_length-d.total_length)),d.slices.push(S),d.total_length+=S.byteLength,d.total_length===d.expected_length?this.emitSectionSlices(d,s):d.total_length>=d.expected_length&&this.clearSlices(d,s))},t.prototype.handlePESSlice=function(i,e,a,s){var r=new Uint8Array(i,e,a),d=r[0]<<16|r[1]<<8|r[2],A=(r[3],r[4]<<8|r[5]);if(s.payload_unit_start_indicator){if(d!==1)return void y.a.e(this.TAG,"handlePESSlice: packet_start_code_prefix should be 1 but with value "+d);var S=this.pes_slice_queues_[s.pid];S&&(S.expected_length===0||S.expected_length===S.total_length?this.emitPESSlices(S,s):this.clearSlices(S,s)),this.pes_slice_queues_[s.pid]=new le,this.pes_slice_queues_[s.pid].file_position=s.file_position,this.pes_slice_queues_[s.pid].random_access_indicator=s.random_access_indicator}if(this.pes_slice_queues_[s.pid]!=null){var L=this.pes_slice_queues_[s.pid];L.slices.push(r),s.payload_unit_start_indicator&&(L.expected_length=A===0?0:A+6),L.total_length+=r.byteLength,L.expected_length>0&&L.expected_length===L.total_length?this.emitPESSlices(L,s):L.expected_length>0&&L.expected_length<L.total_length&&this.clearSlices(L,s)}},t.prototype.emitSectionSlices=function(i,e){for(var a=new Uint8Array(i.total_length),s=0,r=0;s<i.slices.length;s++){var d=i.slices[s];a.set(d,r),r+=d.byteLength}i.slices=[],i.expected_length=-1,i.total_length=0;var A=new be;A.pid=e.pid,A.data=a,A.file_position=i.file_position,A.random_access_indicator=i.random_access_indicator,this.parseSection(A)},t.prototype.emitPESSlices=function(i,e){for(var a=new Uint8Array(i.total_length),s=0,r=0;s<i.slices.length;s++){var d=i.slices[s];a.set(d,r),r+=d.byteLength}i.slices=[],i.expected_length=-1,i.total_length=0;var A=new oe;A.pid=e.pid,A.data=a,A.stream_type=e.stream_type,A.file_position=i.file_position,A.random_access_indicator=i.random_access_indicator,this.parsePES(A)},t.prototype.clearSlices=function(i,e){i.slices=[],i.expected_length=-1,i.total_length=0},t.prototype.parseSection=function(i){var e=i.data,a=i.pid;a===0?this.parsePAT(e):a===this.current_pmt_pid_?this.parsePMT(e):this.pmt_!=null&&this.pmt_.scte_35_pids[a]&&this.parseSCTE35(e)},t.prototype.parsePES=function(i){var e=i.data,a=e[0]<<16|e[1]<<8|e[2],s=e[3],r=e[4]<<8|e[5];if(a===1)if(s!==188&&s!==190&&s!==191&&s!==240&&s!==241&&s!==255&&s!==242&&s!==248){e[6];var d=(192&e[7])>>>6,A=e[8],S=void 0,L=void 0;d!==2&&d!==3||(S=536870912*(14&e[9])+4194304*(255&e[10])+16384*(254&e[11])+128*(255&e[12])+(254&e[13])/2,L=d===3?536870912*(14&e[14])+4194304*(255&e[15])+16384*(254&e[16])+128*(255&e[17])+(254&e[18])/2:S);var B=9+A,T=void 0;if(r!==0){if(r<3+A)return void y.a.v(this.TAG,"Malformed PES: PES_packet_length < 3 + PES_header_data_length");T=r-3-A}else T=e.byteLength-B;var C=e.subarray(B,B+T);switch(i.stream_type){case c.kMPEG1Audio:case c.kMPEG2Audio:this.parseMP3Payload(C,S);break;case c.kPESPrivateData:this.pmt_.smpte2038_pids[i.pid]?this.parseSMPTE2038MetadataPayload(C,S,L,i.pid,s):this.parsePESPrivateDataPayload(C,S,L,i.pid,s);break;case c.kADTSAAC:this.parseAACPayload(C,S);break;case c.kID3:this.parseTimedID3MetadataPayload(C,S,L,i.pid,s);break;case c.kH264:this.parseH264Payload(C,S,L,i.file_position,i.random_access_indicator);break;case c.kH265:this.parseH265Payload(C,S,L,i.file_position,i.random_access_indicator)}}else(s===188||s===191||s===240||s===241||s===255||s===242||s===248)&&i.stream_type===c.kPESPrivateData&&(B=6,T=void 0,T=r!==0?r:e.byteLength-B,C=e.subarray(B,B+T),this.parsePESPrivateDataPayload(C,void 0,void 0,i.pid,s));else y.a.e(this.TAG,"parsePES: packet_start_code_prefix should be 1 but with value "+a)},t.prototype.parsePAT=function(i){var e=i[0];if(e===0){var a=(15&i[1])<<8|i[2],s=(i[3],i[4],(62&i[5])>>>1),r=1&i[5],d=i[6],A=(i[7],null);if(r===1&&d===0)(A=new U).version_number=s;else if((A=this.pat_)==null)return;for(var S=a-5-4,L=-1,B=-1,T=8;T<8+S;T+=4){var C=i[T]<<8|i[T+1],G=(31&i[T+2])<<8|i[T+3];C===0?A.network_pid=G:(A.program_pmt_pid[C]=G,L===-1&&(L=C),B===-1&&(B=G))}r===1&&d===0&&(this.pat_==null&&y.a.v(this.TAG,"Parsed first PAT: "+JSON.stringify(A)),this.pat_=A,this.current_program_=L,this.current_pmt_pid_=B)}else y.a.e(this.TAG,"parsePAT: table_id "+e+" is not corresponded to PAT!")},t.prototype.parsePMT=function(i){var e=i[0];if(e===2){var a=(15&i[1])<<8|i[2],s=i[3]<<8|i[4],r=(62&i[5])>>>1,d=1&i[5],A=i[6],S=(i[7],null);if(d===1&&A===0)(S=new j).program_number=s,S.version_number=r,this.program_pmt_map_[s]=S;else if((S=this.program_pmt_map_[s])==null)return;i[8],i[9];for(var L=(15&i[10])<<8|i[11],B=12+L,T=a-9-L-4,C=B;C<B+T;){var G=i[C],Y=(31&i[C+1])<<8|i[C+2],F=(15&i[C+3])<<8|i[C+4];if(S.pid_stream_type[Y]=G,G!==c.kH264||S.common_pids.h264||S.common_pids.h265)if(G!==c.kH265||S.common_pids.h264||S.common_pids.h265)if(G!==c.kADTSAAC||S.common_pids.adts_aac)if(G!==c.kMPEG1Audio&&G!==c.kMPEG2Audio||S.common_pids.mp3)if(G===c.kPESPrivateData){if(S.pes_private_data_pids[Y]=!0,F>0){for(var ne=C+5;ne<C+5+F;){var ae=i[ne+0],Z=i[ne+1];ae===5&&String.fromCharCode.apply(String,Array.from(i.subarray(ne+2,ne+2+Z)))==="VANC"&&(S.smpte2038_pids[Y]=!0),ne+=2+Z}var ge=i.subarray(C+5,C+5+F);this.dispatchPESPrivateDataDescriptor(Y,G,ge)}}else G===c.kID3?S.timed_id3_pids[Y]=!0:G===c.kSCTE35&&(S.scte_35_pids[Y]=!0);else S.common_pids.mp3=Y;else S.common_pids.adts_aac=Y;else S.common_pids.h265=Y;else S.common_pids.h264=Y;C+=5+F}s===this.current_program_&&(this.pmt_==null&&y.a.v(this.TAG,"Parsed first PMT: "+JSON.stringify(S)),this.pmt_=S,(S.common_pids.h264||S.common_pids.h265)&&(this.has_video_=!0),(S.common_pids.adts_aac||S.common_pids.mp3)&&(this.has_audio_=!0))}else y.a.e(this.TAG,"parsePMT: table_id "+e+" is not corresponded to PMT!")},t.prototype.parseSCTE35=function(i){var e=Ne(i);if(e.pts!=null){var a=Math.floor(e.pts/this.timescale_);e.pts=a}else e.nearest_pts=this.aac_last_sample_pts_;this.onSCTE35Metadata&&this.onSCTE35Metadata(e)},t.prototype.parseH264Payload=function(i,e,a,s,r){for(var d=new X(i),A=null,S=[],L=0,B=!1;(A=d.readNextNaluPayload())!=null;){var T=new E(A);if(T.type===D.kSliceSPS){var C=ce.parseSPS(A.data);this.video_init_segment_dispatched_?this.detectVideoMetadataChange(T,C)===!0&&(y.a.v(this.TAG,"H264: Critical h264 metadata has been changed, attempt to re-generate InitSegment"),this.video_metadata_changed_=!0,this.video_metadata_={vps:void 0,sps:T,pps:void 0,details:C}):(this.video_metadata_.sps=T,this.video_metadata_.details=C)}else T.type===D.kSlicePPS?this.video_init_segment_dispatched_&&!this.video_metadata_changed_||(this.video_metadata_.pps=T,this.video_metadata_.sps&&this.video_metadata_.pps&&(this.video_metadata_changed_&&this.dispatchVideoMediaSegment(),this.dispatchVideoInitSegment())):(T.type===D.kSliceIDR||T.type===D.kSliceNonIDR&&r===1)&&(B=!0);this.video_init_segment_dispatched_&&(S.push(T),L+=T.data.byteLength)}var G=Math.floor(e/this.timescale_),Y=Math.floor(a/this.timescale_);if(S.length){var F=this.video_track_,ne={units:S,length:L,isKeyframe:B,dts:Y,pts:G,cts:G-Y,file_position:s};F.samples.push(ne),F.length+=L}},t.prototype.parseH265Payload=function(i,e,a,s,r){for(var d=new ni(i),A=null,S=[],L=0,B=!1;(A=d.readNextNaluPayload())!=null;){var T=new ii(A);if(T.type===te.kSliceVPS){if(!this.video_init_segment_dispatched_){var C=re.parseVPS(A.data);this.video_metadata_.vps=T,this.video_metadata_.details=st(st({},this.video_metadata_.details),C)}}else T.type===te.kSliceSPS?(C=re.parseSPS(A.data),this.video_init_segment_dispatched_?this.detectVideoMetadataChange(T,C)===!0&&(y.a.v(this.TAG,"H265: Critical h265 metadata has been changed, attempt to re-generate InitSegment"),this.video_metadata_changed_=!0,this.video_metadata_={vps:void 0,sps:T,pps:void 0,details:C}):(this.video_metadata_.sps=T,this.video_metadata_.details=st(st({},this.video_metadata_.details),C))):T.type===te.kSlicePPS?(!this.video_init_segment_dispatched_||this.video_metadata_changed_)&&(C=re.parsePPS(A.data),this.video_metadata_.pps=T,this.video_metadata_.details=st(st({},this.video_metadata_.details),C),this.video_metadata_.vps&&this.video_metadata_.sps&&this.video_metadata_.pps&&(this.video_metadata_changed_&&this.dispatchVideoMediaSegment(),this.dispatchVideoInitSegment())):T.type!==te.kSliceIDR_W_RADL&&T.type!==te.kSliceIDR_N_LP&&T.type!==te.kSliceCRA_NUT||(B=!0);this.video_init_segment_dispatched_&&(S.push(T),L+=T.data.byteLength)}var G=Math.floor(e/this.timescale_),Y=Math.floor(a/this.timescale_);if(S.length){var F=this.video_track_,ne={units:S,length:L,isKeyframe:B,dts:Y,pts:G,cts:G-Y,file_position:s};F.samples.push(ne),F.length+=L}},t.prototype.detectVideoMetadataChange=function(i,e){if(e.codec_mimetype!==this.video_metadata_.details.codec_mimetype)return y.a.v(this.TAG,"Video: Codec mimeType changed from "+this.video_metadata_.details.codec_mimetype+" to "+e.codec_mimetype),!0;if(e.codec_size.width!==this.video_metadata_.details.codec_size.width||e.codec_size.height!==this.video_metadata_.details.codec_size.height){var a=this.video_metadata_.details.codec_size,s=e.codec_size;return y.a.v(this.TAG,"Video: Coded Resolution changed from "+a.width+"x"+a.height+" to "+s.width+"x"+s.height),!0}return e.present_size.width!==this.video_metadata_.details.present_size.width&&(y.a.v(this.TAG,"Video: Present resolution width changed from "+this.video_metadata_.details.present_size.width+" to "+e.present_size.width),!0)},t.prototype.isInitSegmentDispatched=function(){return this.has_video_&&this.has_audio_?this.video_init_segment_dispatched_&&this.audio_init_segment_dispatched_:this.has_video_&&!this.has_audio_?this.video_init_segment_dispatched_:!(this.has_video_||!this.has_audio_)&&this.audio_init_segment_dispatched_},t.prototype.dispatchVideoInitSegment=function(){var i=this.video_metadata_.details,e={type:"video"};e.id=this.video_track_.id,e.timescale=1e3,e.duration=this.duration_,e.codecWidth=i.codec_size.width,e.codecHeight=i.codec_size.height,e.presentWidth=i.present_size.width,e.presentHeight=i.present_size.height,e.profile=i.profile_string,e.level=i.level_string,e.bitDepth=i.bit_depth,e.chromaFormat=i.chroma_format,e.sarRatio=i.sar_ratio,e.frameRate=i.frame_rate;var a=e.frameRate.fps_den,s=e.frameRate.fps_num;if(e.refSampleDuration=a/s*1e3,e.codec=i.codec_mimetype,this.video_metadata_.vps){var r=this.video_metadata_.vps.data.subarray(4),d=this.video_metadata_.sps.data.subarray(4),A=this.video_metadata_.pps.data.subarray(4),S=new ai(r,d,A,i);e.hvcc=S.getData(),this.video_init_segment_dispatched_==0&&y.a.v(this.TAG,"Generated first HEVCDecoderConfigurationRecord for mimeType: "+e.codec)}else{d=this.video_metadata_.sps.data.subarray(4),A=this.video_metadata_.pps.data.subarray(4);var L=new _e(d,A,i);e.avcc=L.getData(),this.video_init_segment_dispatched_==0&&y.a.v(this.TAG,"Generated first AVCDecoderConfigurationRecord for mimeType: "+e.codec)}this.onTrackMetadata("video",e),this.video_init_segment_dispatched_=!0,this.video_metadata_changed_=!1;var B=this.media_info_;B.hasVideo=!0,B.width=e.codecWidth,B.height=e.codecHeight,B.fps=e.frameRate.fps,B.profile=e.profile,B.level=e.level,B.refFrames=i.ref_frames,B.chromaFormat=i.chroma_format_string,B.sarNum=e.sarRatio.width,B.sarDen=e.sarRatio.height,B.videoCodec=e.codec,B.hasAudio&&B.audioCodec?B.mimeType='video/mp2t; codecs="'+B.videoCodec+","+B.audioCodec+'"':B.mimeType='video/mp2t; codecs="'+B.videoCodec+'"',B.isComplete()&&this.onMediaInfo(B)},t.prototype.dispatchVideoMediaSegment=function(){this.isInitSegmentDispatched()&&this.video_track_.length&&this.onDataAvailable(null,this.video_track_)},t.prototype.dispatchAudioMediaSegment=function(){this.isInitSegmentDispatched()&&this.audio_track_.length&&this.onDataAvailable(this.audio_track_,null)},t.prototype.dispatchAudioVideoMediaSegment=function(){this.isInitSegmentDispatched()&&(this.audio_track_.length||this.video_track_.length)&&this.onDataAvailable(this.audio_track_,this.video_track_)},t.prototype.parseAACPayload=function(i,e){if(!this.has_video_||this.video_init_segment_dispatched_){if(this.aac_last_incomplete_data_){var a=new Uint8Array(i.byteLength+this.aac_last_incomplete_data_.byteLength);a.set(this.aac_last_incomplete_data_,0),a.set(i,this.aac_last_incomplete_data_.byteLength),i=a}var s,r;if(e!=null&&(r=e/this.timescale_),this.audio_metadata_.codec==="aac"){if(e==null&&this.aac_last_sample_pts_!=null)s=1024/this.audio_metadata_.sampling_frequency*1e3,r=this.aac_last_sample_pts_+s;else if(e==null)return void y.a.w(this.TAG,"AAC: Unknown pts");if(this.aac_last_incomplete_data_&&this.aac_last_sample_pts_){s=1024/this.audio_metadata_.sampling_frequency*1e3;var d=this.aac_last_sample_pts_+s;Math.abs(d-r)>1&&(y.a.w(this.TAG,"AAC: Detected pts overlapped, expected: "+d+"ms, PES pts: "+r+"ms"),r=d)}}for(var A,S=new Ce(i),L=null,B=r;(L=S.readNextAACFrame())!=null;){s=1024/L.sampling_frequency*1e3;var T={codec:"aac",data:L};this.audio_init_segment_dispatched_==0?(this.audio_metadata_={codec:"aac",audio_object_type:L.audio_object_type,sampling_freq_index:L.sampling_freq_index,sampling_frequency:L.sampling_frequency,channel_config:L.channel_config},this.dispatchAudioInitSegment(T)):this.detectAudioMetadataChange(T)&&(this.dispatchAudioMediaSegment(),this.dispatchAudioInitSegment(T)),A=B;var C=Math.floor(B),G={unit:L.data,length:L.data.byteLength,pts:C,dts:C};this.audio_track_.samples.push(G),this.audio_track_.length+=L.data.byteLength,B+=s}S.hasIncompleteData()&&(this.aac_last_incomplete_data_=S.getIncompleteData()),A&&(this.aac_last_sample_pts_=A)}},t.prototype.parseMP3Payload=function(i,e){if(!this.has_video_||this.video_init_segment_dispatched_){var a=[0,32,64,96,128,160,192,224,256,288,320,352,384,416,448,-1],s=[0,32,48,56,64,80,96,112,128,160,192,224,256,320,384,-1],r=[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],d=i[1]>>>3&3,A=(6&i[1])>>1,S=(240&i[2])>>>4,L=(12&i[2])>>>2,B=(i[3]>>>6&3)!==3?2:1,T=0,C=34;switch(d){case 0:T=[11025,12e3,8e3,0][L];break;case 2:T=[22050,24e3,16e3,0][L];break;case 3:T=[44100,48e3,32e3,0][L]}switch(A){case 1:C=34,S<r.length&&r[S];break;case 2:C=33,S<s.length&&s[S];break;case 3:C=32,S<a.length&&a[S]}var G=new si;G.object_type=C,G.sample_rate=T,G.channel_count=B,G.data=i;var Y={codec:"mp3",data:G};this.audio_init_segment_dispatched_==0?(this.audio_metadata_={codec:"mp3",object_type:C,sample_rate:T,channel_count:B},this.dispatchAudioInitSegment(Y)):this.detectAudioMetadataChange(Y)&&(this.dispatchAudioMediaSegment(),this.dispatchAudioInitSegment(Y));var F={unit:i,length:i.byteLength,pts:e/this.timescale_,dts:e/this.timescale_};this.audio_track_.samples.push(F),this.audio_track_.length+=i.byteLength}},t.prototype.detectAudioMetadataChange=function(i){if(i.codec!==this.audio_metadata_.codec)return y.a.v(this.TAG,"Audio: Audio Codecs changed from "+this.audio_metadata_.codec+" to "+i.codec),!0;if(i.codec==="aac"&&this.audio_metadata_.codec==="aac"){var e=i.data;if(e.audio_object_type!==this.audio_metadata_.audio_object_type)return y.a.v(this.TAG,"AAC: AudioObjectType changed from "+this.audio_metadata_.audio_object_type+" to "+e.audio_object_type),!0;if(e.sampling_freq_index!==this.audio_metadata_.sampling_freq_index)return y.a.v(this.TAG,"AAC: SamplingFrequencyIndex changed from "+this.audio_metadata_.sampling_freq_index+" to "+e.sampling_freq_index),!0;if(e.channel_config!==this.audio_metadata_.channel_config)return y.a.v(this.TAG,"AAC: Channel configuration changed from "+this.audio_metadata_.channel_config+" to "+e.channel_config),!0}else if(i.codec==="mp3"&&this.audio_metadata_.codec==="mp3"){var a=i.data;if(a.object_type!==this.audio_metadata_.object_type)return y.a.v(this.TAG,"MP3: AudioObjectType changed from "+this.audio_metadata_.object_type+" to "+a.object_type),!0;if(a.sample_rate!==this.audio_metadata_.sample_rate)return y.a.v(this.TAG,"MP3: SamplingFrequencyIndex changed from "+this.audio_metadata_.sample_rate+" to "+a.sample_rate),!0;if(a.channel_count!==this.audio_metadata_.channel_count)return y.a.v(this.TAG,"MP3: Channel count changed from "+this.audio_metadata_.channel_count+" to "+a.channel_count),!0}return!1},t.prototype.dispatchAudioInitSegment=function(i){var e={type:"audio"};if(e.id=this.audio_track_.id,e.timescale=1e3,e.duration=this.duration_,this.audio_metadata_.codec==="aac"){var a=i.data,s=new N(a);e.audioSampleRate=s.sampling_rate,e.channelCount=s.channel_count,e.codec=s.codec_mimetype,e.originalCodec=s.original_codec_mimetype,e.config=s.config}else this.audio_metadata_.codec==="mp3"&&(e.audioSampleRate=this.audio_metadata_.sample_rate,e.channelCount=this.audio_metadata_.channel_count,e.codec="mp3",e.originalCodec="mp3",e.config=void 0);e.refSampleDuration=1024/e.audioSampleRate*e.timescale,this.audio_init_segment_dispatched_==0&&y.a.v(this.TAG,"Generated first AudioSpecificConfig for mimeType: "+e.codec),this.onTrackMetadata("audio",e),this.audio_init_segment_dispatched_=!0,this.video_metadata_changed_=!1;var r=this.media_info_;r.hasAudio=!0,r.audioCodec=e.originalCodec,r.audioSampleRate=e.audioSampleRate,r.audioChannelCount=e.channelCount,r.hasVideo&&r.videoCodec?r.mimeType='video/mp2t; codecs="'+r.videoCodec+","+r.audioCodec+'"':r.mimeType='video/mp2t; codecs="'+r.audioCodec+'"',r.isComplete()&&this.onMediaInfo(r)},t.prototype.dispatchPESPrivateDataDescriptor=function(i,e,a){var s=new se;s.pid=i,s.stream_type=e,s.descriptor=a,this.onPESPrivateDataDescriptor&&this.onPESPrivateDataDescriptor(s)},t.prototype.parsePESPrivateDataPayload=function(i,e,a,s,r){var d=new $;if(d.pid=s,d.stream_id=r,d.len=i.byteLength,d.data=i,e!=null){var A=Math.floor(e/this.timescale_);d.pts=A}else d.nearest_pts=this.aac_last_sample_pts_;if(a!=null){var S=Math.floor(a/this.timescale_);d.dts=S}this.onPESPrivateData&&this.onPESPrivateData(d)},t.prototype.parseTimedID3MetadataPayload=function(i,e,a,s,r){var d=new $;if(d.pid=s,d.stream_id=r,d.len=i.byteLength,d.data=i,e!=null){var A=Math.floor(e/this.timescale_);d.pts=A}if(a!=null){var S=Math.floor(a/this.timescale_);d.dts=S}this.onTimedID3Metadata&&this.onTimedID3Metadata(d)},t.prototype.parseSMPTE2038MetadataPayload=function(i,e,a,s,r){var d=new ri;if(d.pid=s,d.stream_id=r,d.len=i.byteLength,d.data=i,e!=null){var A=Math.floor(e/this.timescale_);d.pts=A}if(d.nearest_pts=this.aac_last_sample_pts_,a!=null){var S=Math.floor(a/this.timescale_);d.dts=S}d.ancillaries=function(L){for(var B=new pe(L),T=0,C=[];T+=6,B.readBits(6)===0;){var G=B.readBool();T+=1;var Y=B.readBits(11);T+=11;var F=B.readBits(12);T+=12;var ne=255&B.readBits(10);T+=10;var ae=255&B.readBits(10);T+=10;var Z=255&B.readBits(10);T+=10;for(var ge=new Uint8Array(Z),ie=0;ie<Z;ie++){var W=255&B.readBits(10);T+=10,ge[ie]=W}B.readBits(10),T+=10;var ue="User Defined";ne===65?ae===7&&(ue="SCTE-104"):ne===95?ae===220?ue="ARIB STD-B37 (1SEG)":ae===221?ue="ARIB STD-B37 (ANALOG)":ae===222?ue="ARIB STD-B37 (SD)":ae===223&&(ue="ARIB STD-B37 (HD)"):ne===97&&(ae===1?ue="EIA-708":ae===2&&(ue="EIA-608")),C.push({yc_indicator:G,line_number:Y,horizontal_offset:F,did:ne,sdid:ae,user_data:ge,description:ue,information:{}}),B.readBits(8-(T-Math.floor(T/8))%8),T+=(8-(T-Math.floor(T/8)))%8}return B.destroy(),B=null,C}(i),this.onSMPTE2038Metadata&&this.onSMPTE2038Metadata(d)},t}(p),Pt=function(){function n(){}return n.init=function(){for(var t in n.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],hvc1:[],hvcC:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[],".mp3":[]},n.types)n.types.hasOwnProperty(t)&&(n.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);var i=n.constants={};i.FTYP=new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,97,118,99,49]),i.STSD_PREFIX=new Uint8Array([0,0,0,0,0,0,0,1]),i.STTS=new Uint8Array([0,0,0,0,0,0,0,0]),i.STSC=i.STCO=i.STTS,i.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),i.HDLR_VIDEO=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),i.HDLR_AUDIO=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),i.DREF=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),i.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),i.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])},n.box=function(t){for(var i=8,e=null,a=Array.prototype.slice.call(arguments,1),s=a.length,r=0;r<s;r++)i+=a[r].byteLength;(e=new Uint8Array(i))[0]=i>>>24&255,e[1]=i>>>16&255,e[2]=i>>>8&255,e[3]=255&i,e.set(t,4);var d=8;for(r=0;r<s;r++)e.set(a[r],d),d+=a[r].byteLength;return e},n.generateInitSegment=function(t){var i=n.box(n.types.ftyp,n.constants.FTYP),e=n.moov(t),a=new Uint8Array(i.byteLength+e.byteLength);return a.set(i,0),a.set(e,i.byteLength),a},n.moov=function(t){var i=n.mvhd(t.timescale,t.duration),e=n.trak(t),a=n.mvex(t);return n.box(n.types.moov,i,e,a)},n.mvhd=function(t,i){return n.box(n.types.mvhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,t>>>24&255,t>>>16&255,t>>>8&255,255&t,i>>>24&255,i>>>16&255,i>>>8&255,255&i,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]))},n.trak=function(t){return n.box(n.types.trak,n.tkhd(t),n.mdia(t))},n.tkhd=function(t){var i=t.id,e=t.duration,a=t.presentWidth,s=t.presentHeight;return n.box(n.types.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,i>>>24&255,i>>>16&255,i>>>8&255,255&i,0,0,0,0,e>>>24&255,e>>>16&255,e>>>8&255,255&e,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,a>>>8&255,255&a,0,0,s>>>8&255,255&s,0,0]))},n.mdia=function(t){return n.box(n.types.mdia,n.mdhd(t),n.hdlr(t),n.minf(t))},n.mdhd=function(t){var i=t.timescale,e=t.duration;return n.box(n.types.mdhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,i>>>24&255,i>>>16&255,i>>>8&255,255&i,e>>>24&255,e>>>16&255,e>>>8&255,255&e,85,196,0,0]))},n.hdlr=function(t){var i=null;return i=t.type==="audio"?n.constants.HDLR_AUDIO:n.constants.HDLR_VIDEO,n.box(n.types.hdlr,i)},n.minf=function(t){var i=null;return i=t.type==="audio"?n.box(n.types.smhd,n.constants.SMHD):n.box(n.types.vmhd,n.constants.VMHD),n.box(n.types.minf,i,n.dinf(),n.stbl(t))},n.dinf=function(){return n.box(n.types.dinf,n.box(n.types.dref,n.constants.DREF))},n.stbl=function(t){return n.box(n.types.stbl,n.stsd(t),n.box(n.types.stts,n.constants.STTS),n.box(n.types.stsc,n.constants.STSC),n.box(n.types.stsz,n.constants.STSZ),n.box(n.types.stco,n.constants.STCO))},n.stsd=function(t){return t.type==="audio"?t.codec==="mp3"?n.box(n.types.stsd,n.constants.STSD_PREFIX,n.mp3(t)):n.box(n.types.stsd,n.constants.STSD_PREFIX,n.mp4a(t)):t.type==="video"&&t.codec.startsWith("hvc1")?n.box(n.types.stsd,n.constants.STSD_PREFIX,n.hvc1(t)):n.box(n.types.stsd,n.constants.STSD_PREFIX,n.avc1(t))},n.mp3=function(t){var i=t.channelCount,e=t.audioSampleRate,a=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,i,0,16,0,0,0,0,e>>>8&255,255&e,0,0]);return n.box(n.types[".mp3"],a)},n.mp4a=function(t){var i=t.channelCount,e=t.audioSampleRate,a=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,i,0,16,0,0,0,0,e>>>8&255,255&e,0,0]);return n.box(n.types.mp4a,a,n.esds(t))},n.esds=function(t){var i=t.config||[],e=i.length,a=new Uint8Array([0,0,0,0,3,23+e,0,1,0,4,15+e,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([e]).concat(i).concat([6,1,2]));return n.box(n.types.esds,a)},n.avc1=function(t){var i=t.avcc,e=t.codecWidth,a=t.codecHeight,s=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,e>>>8&255,255&e,a>>>8&255,255&a,0,72,0,0,0,72,0,0,0,0,0,0,0,1,10,120,113,113,47,102,108,118,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return n.box(n.types.avc1,s,n.box(n.types.avcC,i))},n.hvc1=function(t){var i=t.hvcc,e=t.codecWidth,a=t.codecHeight,s=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,e>>>8&255,255&e,a>>>8&255,255&a,0,72,0,0,0,72,0,0,0,0,0,0,0,1,10,120,113,113,47,102,108,118,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return n.box(n.types.hvc1,s,n.box(n.types.hvcC,i))},n.mvex=function(t){return n.box(n.types.mvex,n.trex(t))},n.trex=function(t){var i=t.id,e=new Uint8Array([0,0,0,0,i>>>24&255,i>>>16&255,i>>>8&255,255&i,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return n.box(n.types.trex,e)},n.moof=function(t,i){return n.box(n.types.moof,n.mfhd(t.sequenceNumber),n.traf(t,i))},n.mfhd=function(t){var i=new Uint8Array([0,0,0,0,t>>>24&255,t>>>16&255,t>>>8&255,255&t]);return n.box(n.types.mfhd,i)},n.traf=function(t,i){var e=t.id,a=n.box(n.types.tfhd,new Uint8Array([0,0,0,0,e>>>24&255,e>>>16&255,e>>>8&255,255&e])),s=n.box(n.types.tfdt,new Uint8Array([0,0,0,0,i>>>24&255,i>>>16&255,i>>>8&255,255&i])),r=n.sdtp(t),d=n.trun(t,r.byteLength+16+16+8+16+8+8);return n.box(n.types.traf,a,s,d,r)},n.sdtp=function(t){for(var i=t.samples||[],e=i.length,a=new Uint8Array(4+e),s=0;s<e;s++){var r=i[s].flags;a[s+4]=r.isLeading<<6|r.dependsOn<<4|r.isDependedOn<<2|r.hasRedundancy}return n.box(n.types.sdtp,a)},n.trun=function(t,i){var e=t.samples||[],a=e.length,s=12+16*a,r=new Uint8Array(s);i+=8+s,r.set([0,0,15,1,a>>>24&255,a>>>16&255,a>>>8&255,255&a,i>>>24&255,i>>>16&255,i>>>8&255,255&i],0);for(var d=0;d<a;d++){var A=e[d].duration,S=e[d].size,L=e[d].flags,B=e[d].cts;r.set([A>>>24&255,A>>>16&255,A>>>8&255,255&A,S>>>24&255,S>>>16&255,S>>>8&255,255&S,L.isLeading<<2|L.dependsOn,L.isDependedOn<<6|L.hasRedundancy<<4|L.isNonSync,0,0,B>>>24&255,B>>>16&255,B>>>8&255,255&B],12+16*d)}return n.box(n.types.trun,r)},n.mdat=function(t){return n.box(n.types.mdat,t)},n}();Pt.init();var lt=Pt,Bt=function(){function n(){}return n.getSilentFrame=function(t,i){if(t==="mp4a.40.2"){if(i===1)return new Uint8Array([0,200,0,128,35,128]);if(i===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(i===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(i===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(i===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(i===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(i===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(i===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(i===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null},n}(),Ze=I(7),Mt=function(){function n(t){this.TAG="MP4Remuxer",this._config=t,this._isLive=t.isLive===!0,this._dtsBase=-1,this._dtsBaseInited=!1,this._audioDtsBase=1/0,this._videoDtsBase=1/0,this._audioNextDts=void 0,this._videoNextDts=void 0,this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList=new Ze.c("audio"),this._videoSegmentInfoList=new Ze.c("video"),this._onInitSegment=null,this._onMediaSegment=null,this._forceFirstIDR=!(!v.a.chrome||!(v.a.version.major<50||v.a.version.major===50&&v.a.version.build<2661)),this._fillSilentAfterSeek=v.a.msedge||v.a.msie,this._mp3UseMpegAudio=!v.a.firefox,this._fillAudioTimestampGap=this._config.fixAudioTimestampGap}return n.prototype.destroy=function(){this._dtsBase=-1,this._dtsBaseInited=!1,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList.clear(),this._audioSegmentInfoList=null,this._videoSegmentInfoList.clear(),this._videoSegmentInfoList=null,this._onInitSegment=null,this._onMediaSegment=null},n.prototype.bindDataSource=function(t){return t.onDataAvailable=this.remux.bind(this),t.onTrackMetadata=this._onTrackMetadataReceived.bind(this),this},Object.defineProperty(n.prototype,"onInitSegment",{get:function(){return this._onInitSegment},set:function(t){this._onInitSegment=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"onMediaSegment",{get:function(){return this._onMediaSegment},set:function(t){this._onMediaSegment=t},enumerable:!1,configurable:!0}),n.prototype.insertDiscontinuity=function(){this._audioNextDts=this._videoNextDts=void 0},n.prototype.seek=function(t){this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._videoSegmentInfoList.clear(),this._audioSegmentInfoList.clear()},n.prototype.remux=function(t,i){if(!this._onMediaSegment)throw new w.a("MP4Remuxer: onMediaSegment callback must be specificed!");this._dtsBaseInited||this._calculateDtsBase(t,i),i&&this._remuxVideo(i),t&&this._remuxAudio(t)},n.prototype._onTrackMetadataReceived=function(t,i){var e=null,a="mp4",s=i.codec;if(t==="audio")this._audioMeta=i,i.codec==="mp3"&&this._mp3UseMpegAudio?(a="mpeg",s="",e=new Uint8Array):e=lt.generateInitSegment(i);else{if(t!=="video")return;this._videoMeta=i,e=lt.generateInitSegment(i)}if(!this._onInitSegment)throw new w.a("MP4Remuxer: onInitSegment callback must be specified!");this._onInitSegment(t,{type:t,data:e.buffer,codec:s,container:t+"/"+a,mediaDuration:i.duration})},n.prototype._calculateDtsBase=function(t,i){this._dtsBaseInited||(t&&t.samples&&t.samples.length&&(this._audioDtsBase=t.samples[0].dts),i&&i.samples&&i.samples.length&&(this._videoDtsBase=i.samples[0].dts),this._dtsBase=Math.min(this._audioDtsBase,this._videoDtsBase),this._dtsBaseInited=!0)},n.prototype.getTimestampBase=function(){if(this._dtsBaseInited)return this._dtsBase},n.prototype.flushStashedSamples=function(){var t=this._videoStashedLastSample,i=this._audioStashedLastSample,e={type:"video",id:1,sequenceNumber:0,samples:[],length:0};t!=null&&(e.samples.push(t),e.length=t.length);var a={type:"audio",id:2,sequenceNumber:0,samples:[],length:0};i!=null&&(a.samples.push(i),a.length=i.length),this._videoStashedLastSample=null,this._audioStashedLastSample=null,this._remuxVideo(e,!0),this._remuxAudio(a,!0)},n.prototype._remuxAudio=function(t,i){if(this._audioMeta!=null){var e,a=t,s=a.samples,r=void 0,d=-1,A=this._audioMeta.refSampleDuration,S=this._audioMeta.codec==="mp3"&&this._mp3UseMpegAudio,L=this._dtsBaseInited&&this._audioNextDts===void 0,B=!1;if(s&&s.length!==0&&(s.length!==1||i)){var T=0,C=null,G=0;S?(T=0,G=a.length):(T=8,G=8+a.length);var Y=null;if(s.length>1&&(G-=(Y=s.pop()).length),this._audioStashedLastSample!=null){var F=this._audioStashedLastSample;this._audioStashedLastSample=null,s.unshift(F),G+=F.length}Y!=null&&(this._audioStashedLastSample=Y);var ne=s[0].dts-this._dtsBase;if(this._audioNextDts)r=ne-this._audioNextDts;else if(this._audioSegmentInfoList.isEmpty())r=0,this._fillSilentAfterSeek&&!this._videoSegmentInfoList.isEmpty()&&this._audioMeta.originalCodec!=="mp3"&&(B=!0);else{var ae=this._audioSegmentInfoList.getLastSampleBefore(ne);if(ae!=null){var Z=ne-(ae.originalDts+ae.duration);Z<=3&&(Z=0),r=ne-(ae.dts+ae.duration+Z)}else r=0}if(B){var ge=ne-r,ie=this._videoSegmentInfoList.getLastSegmentBefore(ne);if(ie!=null&&ie.beginDts<ge){if(je=Bt.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount)){var W=ie.beginDts,ue=ge-ie.beginDts;y.a.v(this.TAG,"InsertPrefixSilentAudio: dts: "+W+", duration: "+ue),s.unshift({unit:je,dts:W,pts:W}),G+=je.byteLength}}else B=!1}for(var Se=[],Pe=0;Pe<s.length;Pe++){var ve=(F=s[Pe]).unit,we=F.dts-this._dtsBase,Le=(W=we,!1),fe=null,Ae=0;if(!(we<-.001)){if(this._audioMeta.codec!=="mp3"){var Be=we;if(this._audioNextDts&&(Be=this._audioNextDts),(r=we-Be)<=-3*A){y.a.w(this.TAG,"Dropping 1 audio frame (originalDts: "+we+" ms ,curRefDts: "+Be+" ms)  due to dtsCorrection: "+r+" ms overlap.");continue}if(r>=3*A&&this._fillAudioTimestampGap&&!v.a.safari){Le=!0;var je,it=Math.floor(r/A);y.a.w(this.TAG,`Large audio timestamp gap detected, may cause AV sync to drift. Silent frames will be generated to avoid unsync.
originalDts: `+we+" ms, curRefDts: "+Be+" ms, dtsCorrection: "+Math.round(r)+" ms, generate: "+it+" frames"),W=Math.floor(Be),Ae=Math.floor(Be+A)-W,(je=Bt.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount))==null&&(y.a.w(this.TAG,"Unable to generate silent frame for "+this._audioMeta.originalCodec+" with "+this._audioMeta.channelCount+" channels, repeat last frame"),je=ve),fe=[];for(var We=0;We<it;We++){Be+=A;var Ie=Math.floor(Be),ct=Math.floor(Be+A)-Ie,nt={dts:Ie,pts:Ie,cts:0,unit:je,size:je.byteLength,duration:ct,originalDts:we,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}};fe.push(nt),G+=nt.size}this._audioNextDts=Be+A}else W=Math.floor(Be),Ae=Math.floor(Be+A)-W,this._audioNextDts=Be+A}else W=we-r,Pe!==s.length-1?Ae=s[Pe+1].dts-this._dtsBase-r-W:Y!=null?Ae=Y.dts-this._dtsBase-r-W:Ae=Se.length>=1?Se[Se.length-1].duration:Math.floor(A),this._audioNextDts=W+Ae;d===-1&&(d=W),Se.push({dts:W,pts:W,cts:0,unit:F.unit,size:F.unit.byteLength,duration:Ae,originalDts:we,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}}),Le&&Se.push.apply(Se,fe)}}if(Se.length===0)return a.samples=[],void(a.length=0);for(S?C=new Uint8Array(G):((C=new Uint8Array(G))[0]=G>>>24&255,C[1]=G>>>16&255,C[2]=G>>>8&255,C[3]=255&G,C.set(lt.types.mdat,4)),Pe=0;Pe<Se.length;Pe++)ve=Se[Pe].unit,C.set(ve,T),T+=ve.byteLength;var He=Se[Se.length-1];e=He.dts+He.duration;var Fe=new Ze.b;Fe.beginDts=d,Fe.endDts=e,Fe.beginPts=d,Fe.endPts=e,Fe.originalBeginDts=Se[0].originalDts,Fe.originalEndDts=He.originalDts+He.duration,Fe.firstSample=new Ze.d(Se[0].dts,Se[0].pts,Se[0].duration,Se[0].originalDts,!1),Fe.lastSample=new Ze.d(He.dts,He.pts,He.duration,He.originalDts,!1),this._isLive||this._audioSegmentInfoList.append(Fe),a.samples=Se,a.sequenceNumber++;var at=null;at=S?new Uint8Array:lt.moof(a,d),a.samples=[],a.length=0;var Qe={type:"audio",data:this._mergeBoxes(at,C).buffer,sampleCount:Se.length,info:Fe};S&&L&&(Qe.timestampOffset=d),this._onMediaSegment("audio",Qe)}}},n.prototype._remuxVideo=function(t,i){if(this._videoMeta!=null){var e,a,s=t,r=s.samples,d=void 0,A=-1,S=-1;if(r&&r.length!==0&&(r.length!==1||i)){var L=8,B=null,T=8+t.length,C=null;if(r.length>1&&(T-=(C=r.pop()).length),this._videoStashedLastSample!=null){var G=this._videoStashedLastSample;this._videoStashedLastSample=null,r.unshift(G),T+=G.length}C!=null&&(this._videoStashedLastSample=C);var Y=r[0].dts-this._dtsBase;if(this._videoNextDts)d=Y-this._videoNextDts;else if(this._videoSegmentInfoList.isEmpty())d=0;else{var F=this._videoSegmentInfoList.getLastSampleBefore(Y);if(F!=null){var ne=Y-(F.originalDts+F.duration);ne<=3&&(ne=0),d=Y-(F.dts+F.duration+ne)}else d=0}for(var ae=new Ze.b,Z=[],ge=0;ge<r.length;ge++){var ie=(G=r[ge]).dts-this._dtsBase,W=G.isKeyframe,ue=ie-d,Se=G.cts,Pe=ue+Se;A===-1&&(A=ue,S=Pe);var ve=0;if(ge!==r.length-1?ve=r[ge+1].dts-this._dtsBase-d-ue:C!=null?ve=C.dts-this._dtsBase-d-ue:ve=Z.length>=1?Z[Z.length-1].duration:Math.floor(this._videoMeta.refSampleDuration),W){var we=new Ze.d(ue,Pe,ve,G.dts,!0);we.fileposition=G.fileposition,ae.appendSyncPoint(we)}Z.push({dts:ue,pts:Pe,cts:Se,units:G.units,size:G.length,isKeyframe:W,duration:ve,originalDts:ie,flags:{isLeading:0,dependsOn:W?2:1,isDependedOn:W?1:0,hasRedundancy:0,isNonSync:W?0:1}})}for((B=new Uint8Array(T))[0]=T>>>24&255,B[1]=T>>>16&255,B[2]=T>>>8&255,B[3]=255&T,B.set(lt.types.mdat,4),ge=0;ge<Z.length;ge++)for(var Le=Z[ge].units;Le.length;){var fe=Le.shift().data;B.set(fe,L),L+=fe.byteLength}var Ae=Z[Z.length-1];if(e=Ae.dts+Ae.duration,a=Ae.pts+Ae.duration,this._videoNextDts=e,ae.beginDts=A,ae.endDts=e,ae.beginPts=S,ae.endPts=a,ae.originalBeginDts=Z[0].originalDts,ae.originalEndDts=Ae.originalDts+Ae.duration,ae.firstSample=new Ze.d(Z[0].dts,Z[0].pts,Z[0].duration,Z[0].originalDts,Z[0].isKeyframe),ae.lastSample=new Ze.d(Ae.dts,Ae.pts,Ae.duration,Ae.originalDts,Ae.isKeyframe),this._isLive||this._videoSegmentInfoList.append(ae),s.samples=Z,s.sequenceNumber++,this._forceFirstIDR){var Be=Z[0].flags;Be.dependsOn=2,Be.isNonSync=0}var je=lt.moof(s,A);s.samples=[],s.length=0,this._onMediaSegment("video",{type:"video",data:this._mergeBoxes(je,B).buffer,sampleCount:Z.length,info:ae})}}},n.prototype._mergeBoxes=function(t,i){var e=new Uint8Array(t.byteLength+i.byteLength);return e.set(t,0),e.set(i,t.byteLength),e},n}(),di=I(11),Ve=I(1),li=function(){function n(t,i){this.TAG="TransmuxingController",this._emitter=new M.a,this._config=i,t.segments||(t.segments=[{duration:t.duration,filesize:t.filesize,url:t.url}]),typeof t.cors!="boolean"&&(t.cors=!0),typeof t.withCredentials!="boolean"&&(t.withCredentials=!1),this._mediaDataSource=t,this._currentSegmentIndex=0;var e=0;this._mediaDataSource.segments.forEach(function(a){a.timestampBase=e,e+=a.duration,a.cors=t.cors,a.withCredentials=t.withCredentials,i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy)}),isNaN(e)||this._mediaDataSource.duration===e||(this._mediaDataSource.duration=e),this._mediaInfo=null,this._demuxer=null,this._remuxer=null,this._ioctl=null,this._pendingSeekTime=null,this._pendingResolveSeekPoint=null,this._statisticsReporter=null}return n.prototype.destroy=function(){this._mediaInfo=null,this._mediaDataSource=null,this._statisticsReporter&&this._disableStatisticsReporter(),this._ioctl&&(this._ioctl.destroy(),this._ioctl=null),this._demuxer&&(this._demuxer.destroy(),this._demuxer=null),this._remuxer&&(this._remuxer.destroy(),this._remuxer=null),this._emitter.removeAllListeners(),this._emitter=null},n.prototype.on=function(t,i){this._emitter.addListener(t,i)},n.prototype.off=function(t,i){this._emitter.removeListener(t,i)},n.prototype.start=function(){this._loadSegment(0),this._enableStatisticsReporter()},n.prototype._loadSegment=function(t,i){this._currentSegmentIndex=t;var e=this._mediaDataSource.segments[t],a=this._ioctl=new di.a(e,this._config,t);a.onError=this._onIOException.bind(this),a.onSeeked=this._onIOSeeked.bind(this),a.onComplete=this._onIOComplete.bind(this),a.onRedirect=this._onIORedirect.bind(this),a.onRecoveredEarlyEof=this._onIORecoveredEarlyEof.bind(this),i?this._demuxer.bindDataSource(this._ioctl):a.onDataArrival=this._onInitChunkArrival.bind(this),a.open(i)},n.prototype.stop=function(){this._internalAbort(),this._disableStatisticsReporter()},n.prototype._internalAbort=function(){this._ioctl&&(this._ioctl.destroy(),this._ioctl=null)},n.prototype.pause=function(){this._ioctl&&this._ioctl.isWorking()&&(this._ioctl.pause(),this._disableStatisticsReporter())},n.prototype.resume=function(){this._ioctl&&this._ioctl.isPaused()&&(this._ioctl.resume(),this._enableStatisticsReporter())},n.prototype.seek=function(t){if(this._mediaInfo!=null&&this._mediaInfo.isSeekable()){var i=this._searchSegmentIndexContains(t);if(i===this._currentSegmentIndex){var e=this._mediaInfo.segments[i];if(e==null)this._pendingSeekTime=t;else{var a=e.getNearestKeyframe(t);this._remuxer.seek(a.milliseconds),this._ioctl.seek(a.fileposition),this._pendingResolveSeekPoint=a.milliseconds}}else{var s=this._mediaInfo.segments[i];s==null?(this._pendingSeekTime=t,this._internalAbort(),this._remuxer.seek(),this._remuxer.insertDiscontinuity(),this._loadSegment(i)):(a=s.getNearestKeyframe(t),this._internalAbort(),this._remuxer.seek(t),this._remuxer.insertDiscontinuity(),this._demuxer.resetMediaInfo(),this._demuxer.timestampBase=this._mediaDataSource.segments[i].timestampBase,this._loadSegment(i,a.fileposition),this._pendingResolveSeekPoint=a.milliseconds,this._reportSegmentMediaInfo(i))}this._enableStatisticsReporter()}},n.prototype._searchSegmentIndexContains=function(t){for(var i=this._mediaDataSource.segments,e=i.length-1,a=0;a<i.length;a++)if(t<i[a].timestampBase){e=a-1;break}return e},n.prototype._onInitChunkArrival=function(t,i){var e=this,a=0;if(i>0)this._demuxer.bindDataSource(this._ioctl),this._demuxer.timestampBase=this._mediaDataSource.segments[this._currentSegmentIndex].timestampBase,a=this._demuxer.parseChunks(t,i);else{var s=null;(s=u.probe(t)).match&&(this._setupFLVDemuxerRemuxer(s),a=this._demuxer.parseChunks(t,i)),s.match||s.needMoreData||(s=It.probe(t)).match&&(this._setupTSDemuxerRemuxer(s),a=this._demuxer.parseChunks(t,i)),s.match||s.needMoreData||(s=null,y.a.e(this.TAG,"Non MPEG-TS/FLV, Unsupported media type!"),Promise.resolve().then(function(){e._internalAbort()}),this._emitter.emit(Ve.a.DEMUX_ERROR,ee.a.FORMAT_UNSUPPORTED,"Non MPEG-TS/FLV, Unsupported media type!"))}return a},n.prototype._setupFLVDemuxerRemuxer=function(t){this._demuxer=new u(t,this._config),this._remuxer||(this._remuxer=new Mt(this._config));var i=this._mediaDataSource;i.duration==null||isNaN(i.duration)||(this._demuxer.overridedDuration=i.duration),typeof i.hasAudio=="boolean"&&(this._demuxer.overridedHasAudio=i.hasAudio),typeof i.hasVideo=="boolean"&&(this._demuxer.overridedHasVideo=i.hasVideo),this._demuxer.timestampBase=i.segments[this._currentSegmentIndex].timestampBase,this._demuxer.onError=this._onDemuxException.bind(this),this._demuxer.onMediaInfo=this._onMediaInfo.bind(this),this._demuxer.onMetaDataArrived=this._onMetaDataArrived.bind(this),this._demuxer.onScriptDataArrived=this._onScriptDataArrived.bind(this),this._remuxer.bindDataSource(this._demuxer.bindDataSource(this._ioctl)),this._remuxer.onInitSegment=this._onRemuxerInitSegmentArrival.bind(this),this._remuxer.onMediaSegment=this._onRemuxerMediaSegmentArrival.bind(this)},n.prototype._setupTSDemuxerRemuxer=function(t){var i=this._demuxer=new It(t,this._config);this._remuxer||(this._remuxer=new Mt(this._config)),i.onError=this._onDemuxException.bind(this),i.onMediaInfo=this._onMediaInfo.bind(this),i.onMetaDataArrived=this._onMetaDataArrived.bind(this),i.onTimedID3Metadata=this._onTimedID3Metadata.bind(this),i.onSMPTE2038Metadata=this._onSMPTE2038Metadata.bind(this),i.onSCTE35Metadata=this._onSCTE35Metadata.bind(this),i.onPESPrivateDataDescriptor=this._onPESPrivateDataDescriptor.bind(this),i.onPESPrivateData=this._onPESPrivateData.bind(this),this._remuxer.bindDataSource(this._demuxer),this._demuxer.bindDataSource(this._ioctl),this._remuxer.onInitSegment=this._onRemuxerInitSegmentArrival.bind(this),this._remuxer.onMediaSegment=this._onRemuxerMediaSegmentArrival.bind(this)},n.prototype._onMediaInfo=function(t){var i=this;this._mediaInfo==null&&(this._mediaInfo=Object.assign({},t),this._mediaInfo.keyframesIndex=null,this._mediaInfo.segments=[],this._mediaInfo.segmentCount=this._mediaDataSource.segments.length,Object.setPrototypeOf(this._mediaInfo,m.a.prototype));var e=Object.assign({},t);Object.setPrototypeOf(e,m.a.prototype),this._mediaInfo.segments[this._currentSegmentIndex]=e,this._reportSegmentMediaInfo(this._currentSegmentIndex),this._pendingSeekTime!=null&&Promise.resolve().then(function(){var a=i._pendingSeekTime;i._pendingSeekTime=null,i.seek(a)})},n.prototype._onMetaDataArrived=function(t){this._emitter.emit(Ve.a.METADATA_ARRIVED,t)},n.prototype._onScriptDataArrived=function(t){this._emitter.emit(Ve.a.SCRIPTDATA_ARRIVED,t)},n.prototype._onTimedID3Metadata=function(t){var i=this._remuxer.getTimestampBase();i!=null&&(t.pts!=null&&(t.pts-=i),t.dts!=null&&(t.dts-=i),this._emitter.emit(Ve.a.TIMED_ID3_METADATA_ARRIVED,t))},n.prototype._onSMPTE2038Metadata=function(t){var i=this._remuxer.getTimestampBase();i!=null&&(t.pts!=null&&(t.pts-=i),t.dts!=null&&(t.dts-=i),t.nearest_pts!=null&&(t.nearest_pts-=i),this._emitter.emit(Ve.a.SMPTE2038_METADATA_ARRIVED,t))},n.prototype._onSCTE35Metadata=function(t){var i=this._remuxer.getTimestampBase();i!=null&&(t.pts!=null&&(t.pts-=i),t.nearest_pts!=null&&(t.nearest_pts-=i),this._emitter.emit(Ve.a.SCTE35_METADATA_ARRIVED,t))},n.prototype._onPESPrivateDataDescriptor=function(t){this._emitter.emit(Ve.a.PES_PRIVATE_DATA_DESCRIPTOR,t)},n.prototype._onPESPrivateData=function(t){var i=this._remuxer.getTimestampBase();i!=null&&(t.pts!=null&&(t.pts-=i),t.nearest_pts!=null&&(t.nearest_pts-=i),t.dts!=null&&(t.dts-=i),this._emitter.emit(Ve.a.PES_PRIVATE_DATA_ARRIVED,t))},n.prototype._onIOSeeked=function(){this._remuxer.insertDiscontinuity()},n.prototype._onIOComplete=function(t){var i=t+1;i<this._mediaDataSource.segments.length?(this._internalAbort(),this._remuxer&&this._remuxer.flushStashedSamples(),this._loadSegment(i)):(this._remuxer&&this._remuxer.flushStashedSamples(),this._emitter.emit(Ve.a.LOADING_COMPLETE),this._disableStatisticsReporter())},n.prototype._onIORedirect=function(t){var i=this._ioctl.extraData;this._mediaDataSource.segments[i].redirectedURL=t},n.prototype._onIORecoveredEarlyEof=function(){this._emitter.emit(Ve.a.RECOVERED_EARLY_EOF)},n.prototype._onIOException=function(t,i){y.a.e(this.TAG,"IOException: type = "+t+", code = "+i.code+", msg = "+i.msg),this._emitter.emit(Ve.a.IO_ERROR,t,i),this._disableStatisticsReporter()},n.prototype._onDemuxException=function(t,i){y.a.e(this.TAG,"DemuxException: type = "+t+", info = "+i),this._emitter.emit(Ve.a.DEMUX_ERROR,t,i)},n.prototype._onRemuxerInitSegmentArrival=function(t,i){this._emitter.emit(Ve.a.INIT_SEGMENT,t,i)},n.prototype._onRemuxerMediaSegmentArrival=function(t,i){if(this._pendingSeekTime==null&&(this._emitter.emit(Ve.a.MEDIA_SEGMENT,t,i),this._pendingResolveSeekPoint!=null&&t==="video")){var e=i.info.syncPoints,a=this._pendingResolveSeekPoint;this._pendingResolveSeekPoint=null,v.a.safari&&e.length>0&&e[0].originalDts===a&&(a=e[0].pts),this._emitter.emit(Ve.a.RECOMMEND_SEEKPOINT,a)}},n.prototype._enableStatisticsReporter=function(){this._statisticsReporter==null&&(this._statisticsReporter=self.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval))},n.prototype._disableStatisticsReporter=function(){this._statisticsReporter&&(self.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},n.prototype._reportSegmentMediaInfo=function(t){var i=this._mediaInfo.segments[t],e=Object.assign({},i);e.duration=this._mediaInfo.duration,e.segmentCount=this._mediaInfo.segmentCount,delete e.segments,delete e.keyframesIndex,this._emitter.emit(Ve.a.MEDIA_INFO,e)},n.prototype._reportStatisticsInfo=function(){var t={};t.url=this._ioctl.currentURL,t.hasRedirect=this._ioctl.hasRedirect,t.hasRedirect&&(t.redirectedURL=this._ioctl.currentRedirectedURL),t.speed=this._ioctl.currentSpeed,t.loaderType=this._ioctl.loaderType,t.currentSegmentIndex=this._currentSegmentIndex,t.totalSegmentCount=this._mediaDataSource.segments.length,this._emitter.emit(Ve.a.STATISTICS_INFO,t)},n}();q.a=li},function(he,q,I){var z,M=I(0),y=function(){function b(){this._firstCheckpoint=0,this._lastCheckpoint=0,this._intervalBytes=0,this._totalBytes=0,this._lastSecondBytes=0,self.performance&&self.performance.now?this._now=self.performance.now.bind(self.performance):this._now=Date.now}return b.prototype.reset=function(){this._firstCheckpoint=this._lastCheckpoint=0,this._totalBytes=this._intervalBytes=0,this._lastSecondBytes=0},b.prototype.addBytes=function(l){this._firstCheckpoint===0?(this._firstCheckpoint=this._now(),this._lastCheckpoint=this._firstCheckpoint,this._intervalBytes+=l,this._totalBytes+=l):this._now()-this._lastCheckpoint<1e3?(this._intervalBytes+=l,this._totalBytes+=l):(this._lastSecondBytes=this._intervalBytes,this._intervalBytes=l,this._totalBytes+=l,this._lastCheckpoint=this._now())},Object.defineProperty(b.prototype,"currentKBps",{get:function(){this.addBytes(0);var l=(this._now()-this._lastCheckpoint)/1e3;return l==0&&(l=1),this._intervalBytes/l/1024},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"lastSecondKBps",{get:function(){return this.addBytes(0),this._lastSecondBytes!==0?this._lastSecondBytes/1024:this._now()-this._lastCheckpoint>=500?this.currentKBps:0},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"averageKBps",{get:function(){var l=(this._now()-this._firstCheckpoint)/1e3;return this._totalBytes/l/1024},enumerable:!1,configurable:!0}),b}(),v=I(2),m=I(4),_=I(3),R=(z=function(b,l){return(z=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,u){c.__proto__=u}||function(c,u){for(var p in u)u.hasOwnProperty(p)&&(c[p]=u[p])})(b,l)},function(b,l){function c(){this.constructor=b}z(b,l),b.prototype=l===null?Object.create(l):(c.prototype=l.prototype,new c)}),P=function(b){function l(c,u){var p=b.call(this,"fetch-stream-loader")||this;return p.TAG="FetchStreamLoader",p._seekHandler=c,p._config=u,p._needStash=!0,p._requestAbort=!1,p._abortController=null,p._contentLength=null,p._receivedLength=0,p}return R(l,b),l.isSupported=function(){try{var c=m.a.msedge&&m.a.version.minor>=15048,u=!m.a.msedge||c;return self.fetch&&self.ReadableStream&&u}catch{return!1}},l.prototype.destroy=function(){this.isWorking()&&this.abort(),b.prototype.destroy.call(this)},l.prototype.open=function(c,u){var p=this;this._dataSource=c,this._range=u;var U=c.url;this._config.reuseRedirectedURL&&c.redirectedURL!=null&&(U=c.redirectedURL);var D=this._seekHandler.getConfig(U,u),j=new self.Headers;if(typeof D.headers=="object"){var oe=D.headers;for(var be in oe)oe.hasOwnProperty(be)&&j.append(be,oe[be])}var le={method:"GET",headers:j,mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade"};if(typeof this._config.headers=="object")for(var be in this._config.headers)j.append(be,this._config.headers[be]);c.cors===!1&&(le.mode="same-origin"),c.withCredentials&&(le.credentials="include"),c.referrerPolicy&&(le.referrerPolicy=c.referrerPolicy),self.AbortController&&(this._abortController=new self.AbortController,le.signal=this._abortController.signal),this._status=v.c.kConnecting,self.fetch(D.url,le).then(function(k){if(p._requestAbort)return p._status=v.c.kIdle,void k.body.cancel();if(k.ok&&k.status>=200&&k.status<=299){if(k.url!==D.url&&p._onURLRedirect){var o=p._seekHandler.removeURLParameters(k.url);p._onURLRedirect(o)}var h=k.headers.get("Content-Length");return h!=null&&(p._contentLength=parseInt(h),p._contentLength!==0&&p._onContentLengthKnown&&p._onContentLengthKnown(p._contentLength)),p._pump.call(p,k.body.getReader())}if(p._status=v.c.kError,!p._onError)throw new _.d("FetchStreamLoader: Http code invalid, "+k.status+" "+k.statusText);p._onError(v.b.HTTP_STATUS_CODE_INVALID,{code:k.status,msg:k.statusText})}).catch(function(k){if(!p._abortController||!p._abortController.signal.aborted){if(p._status=v.c.kError,!p._onError)throw k;p._onError(v.b.EXCEPTION,{code:-1,msg:k.message})}})},l.prototype.abort=function(){if(this._requestAbort=!0,(this._status!==v.c.kBuffering||!m.a.chrome)&&this._abortController)try{this._abortController.abort()}catch{}},l.prototype._pump=function(c){var u=this;return c.read().then(function(p){if(p.done)if(u._contentLength!==null&&u._receivedLength<u._contentLength){u._status=v.c.kError;var U=v.b.EARLY_EOF,D={code:-1,msg:"Fetch stream meet Early-EOF"};if(!u._onError)throw new _.d(D.msg);u._onError(U,D)}else u._status=v.c.kComplete,u._onComplete&&u._onComplete(u._range.from,u._range.from+u._receivedLength-1);else{if(u._abortController&&u._abortController.signal.aborted)return void(u._status=v.c.kComplete);if(u._requestAbort===!0)return u._status=v.c.kComplete,c.cancel();u._status=v.c.kBuffering;var j=p.value.buffer,oe=u._range.from+u._receivedLength;u._receivedLength+=j.byteLength,u._onDataArrival&&u._onDataArrival(j,oe,u._receivedLength),u._pump(c)}}).catch(function(p){if(u._abortController&&u._abortController.signal.aborted)u._status=v.c.kComplete;else if(p.code!==11||!m.a.msedge){u._status=v.c.kError;var U=0,D=null;if(p.code!==19&&p.message!=="network error"||!(u._contentLength===null||u._contentLength!==null&&u._receivedLength<u._contentLength)?(U=v.b.EXCEPTION,D={code:p.code,msg:p.message}):(U=v.b.EARLY_EOF,D={code:p.code,msg:"Fetch stream meet Early-EOF"}),!u._onError)throw new _.d(D.msg);u._onError(U,D)}})},l}(v.a),w=function(){var b=function(l,c){return(b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,p){u.__proto__=p}||function(u,p){for(var U in p)p.hasOwnProperty(U)&&(u[U]=p[U])})(l,c)};return function(l,c){function u(){this.constructor=l}b(l,c),l.prototype=c===null?Object.create(c):(u.prototype=c.prototype,new u)}}(),O=function(b){function l(c,u){var p=b.call(this,"xhr-moz-chunked-loader")||this;return p.TAG="MozChunkedLoader",p._seekHandler=c,p._config=u,p._needStash=!0,p._xhr=null,p._requestAbort=!1,p._contentLength=null,p._receivedLength=0,p}return w(l,b),l.isSupported=function(){try{var c=new XMLHttpRequest;return c.open("GET","https://example.com",!0),c.responseType="moz-chunked-arraybuffer",c.responseType==="moz-chunked-arraybuffer"}catch(u){return M.a.w("MozChunkedLoader",u.message),!1}},l.prototype.destroy=function(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onloadend=null,this._xhr.onerror=null,this._xhr=null),b.prototype.destroy.call(this)},l.prototype.open=function(c,u){this._dataSource=c,this._range=u;var p=c.url;this._config.reuseRedirectedURL&&c.redirectedURL!=null&&(p=c.redirectedURL);var U=this._seekHandler.getConfig(p,u);this._requestURL=U.url;var D=this._xhr=new XMLHttpRequest;if(D.open("GET",U.url,!0),D.responseType="moz-chunked-arraybuffer",D.onreadystatechange=this._onReadyStateChange.bind(this),D.onprogress=this._onProgress.bind(this),D.onloadend=this._onLoadEnd.bind(this),D.onerror=this._onXhrError.bind(this),c.withCredentials&&(D.withCredentials=!0),typeof U.headers=="object"){var j=U.headers;for(var oe in j)j.hasOwnProperty(oe)&&D.setRequestHeader(oe,j[oe])}if(typeof this._config.headers=="object"){j=this._config.headers;for(var oe in j)j.hasOwnProperty(oe)&&D.setRequestHeader(oe,j[oe])}this._status=v.c.kConnecting,D.send()},l.prototype.abort=function(){this._requestAbort=!0,this._xhr&&this._xhr.abort(),this._status=v.c.kComplete},l.prototype._onReadyStateChange=function(c){var u=c.target;if(u.readyState===2){if(u.responseURL!=null&&u.responseURL!==this._requestURL&&this._onURLRedirect){var p=this._seekHandler.removeURLParameters(u.responseURL);this._onURLRedirect(p)}if(u.status!==0&&(u.status<200||u.status>299)){if(this._status=v.c.kError,!this._onError)throw new _.d("MozChunkedLoader: Http code invalid, "+u.status+" "+u.statusText);this._onError(v.b.HTTP_STATUS_CODE_INVALID,{code:u.status,msg:u.statusText})}else this._status=v.c.kBuffering}},l.prototype._onProgress=function(c){if(this._status!==v.c.kError){this._contentLength===null&&c.total!==null&&c.total!==0&&(this._contentLength=c.total,this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength));var u=c.target.response,p=this._range.from+this._receivedLength;this._receivedLength+=u.byteLength,this._onDataArrival&&this._onDataArrival(u,p,this._receivedLength)}},l.prototype._onLoadEnd=function(c){this._requestAbort!==!0?this._status!==v.c.kError&&(this._status=v.c.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1)):this._requestAbort=!1},l.prototype._onXhrError=function(c){this._status=v.c.kError;var u=0,p=null;if(this._contentLength&&c.loaded<this._contentLength?(u=v.b.EARLY_EOF,p={code:-1,msg:"Moz-Chunked stream meet Early-Eof"}):(u=v.b.EXCEPTION,p={code:-1,msg:c.constructor.name+" "+c.type}),!this._onError)throw new _.d(p.msg);this._onError(u,p)},l}(v.a),x=function(){var b=function(l,c){return(b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,p){u.__proto__=p}||function(u,p){for(var U in p)p.hasOwnProperty(U)&&(u[U]=p[U])})(l,c)};return function(l,c){function u(){this.constructor=l}b(l,c),l.prototype=c===null?Object.create(c):(u.prototype=c.prototype,new u)}}(),pe=function(b){function l(c,u){var p=b.call(this,"xhr-range-loader")||this;return p.TAG="RangeLoader",p._seekHandler=c,p._config=u,p._needStash=!1,p._chunkSizeKBList=[128,256,384,512,768,1024,1536,2048,3072,4096,5120,6144,7168,8192],p._currentChunkSizeKB=384,p._currentSpeedNormalized=0,p._zeroSpeedChunkCount=0,p._xhr=null,p._speedSampler=new y,p._requestAbort=!1,p._waitForTotalLength=!1,p._totalLengthReceived=!1,p._currentRequestURL=null,p._currentRedirectedURL=null,p._currentRequestRange=null,p._totalLength=null,p._contentLength=null,p._receivedLength=0,p._lastTimeLoaded=0,p}return x(l,b),l.isSupported=function(){try{var c=new XMLHttpRequest;return c.open("GET","https://example.com",!0),c.responseType="arraybuffer",c.responseType==="arraybuffer"}catch(u){return M.a.w("RangeLoader",u.message),!1}},l.prototype.destroy=function(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr=null),b.prototype.destroy.call(this)},Object.defineProperty(l.prototype,"currentSpeed",{get:function(){return this._speedSampler.lastSecondKBps},enumerable:!1,configurable:!0}),l.prototype.open=function(c,u){this._dataSource=c,this._range=u,this._status=v.c.kConnecting;var p=!1;this._dataSource.filesize!=null&&this._dataSource.filesize!==0&&(p=!0,this._totalLength=this._dataSource.filesize),this._totalLengthReceived||p?this._openSubRange():(this._waitForTotalLength=!0,this._internalOpen(this._dataSource,{from:0,to:-1}))},l.prototype._openSubRange=function(){var c=1024*this._currentChunkSizeKB,u=this._range.from+this._receivedLength,p=u+c;this._contentLength!=null&&p-this._range.from>=this._contentLength&&(p=this._range.from+this._contentLength-1),this._currentRequestRange={from:u,to:p},this._internalOpen(this._dataSource,this._currentRequestRange)},l.prototype._internalOpen=function(c,u){this._lastTimeLoaded=0;var p=c.url;this._config.reuseRedirectedURL&&(this._currentRedirectedURL!=null?p=this._currentRedirectedURL:c.redirectedURL!=null&&(p=c.redirectedURL));var U=this._seekHandler.getConfig(p,u);this._currentRequestURL=U.url;var D=this._xhr=new XMLHttpRequest;if(D.open("GET",U.url,!0),D.responseType="arraybuffer",D.onreadystatechange=this._onReadyStateChange.bind(this),D.onprogress=this._onProgress.bind(this),D.onload=this._onLoad.bind(this),D.onerror=this._onXhrError.bind(this),c.withCredentials&&(D.withCredentials=!0),typeof U.headers=="object"){var j=U.headers;for(var oe in j)j.hasOwnProperty(oe)&&D.setRequestHeader(oe,j[oe])}if(typeof this._config.headers=="object"){j=this._config.headers;for(var oe in j)j.hasOwnProperty(oe)&&D.setRequestHeader(oe,j[oe])}D.send()},l.prototype.abort=function(){this._requestAbort=!0,this._internalAbort(),this._status=v.c.kComplete},l.prototype._internalAbort=function(){this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr.abort(),this._xhr=null)},l.prototype._onReadyStateChange=function(c){var u=c.target;if(u.readyState===2){if(u.responseURL!=null){var p=this._seekHandler.removeURLParameters(u.responseURL);u.responseURL!==this._currentRequestURL&&p!==this._currentRedirectedURL&&(this._currentRedirectedURL=p,this._onURLRedirect&&this._onURLRedirect(p))}if(u.status>=200&&u.status<=299){if(this._waitForTotalLength)return;this._status=v.c.kBuffering}else{if(this._status=v.c.kError,!this._onError)throw new _.d("RangeLoader: Http code invalid, "+u.status+" "+u.statusText);this._onError(v.b.HTTP_STATUS_CODE_INVALID,{code:u.status,msg:u.statusText})}}},l.prototype._onProgress=function(c){if(this._status!==v.c.kError){if(this._contentLength===null){var u=!1;if(this._waitForTotalLength){this._waitForTotalLength=!1,this._totalLengthReceived=!0,u=!0;var p=c.total;this._internalAbort(),p!=null&p!==0&&(this._totalLength=p)}if(this._range.to===-1?this._contentLength=this._totalLength-this._range.from:this._contentLength=this._range.to-this._range.from+1,u)return void this._openSubRange();this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength)}var U=c.loaded-this._lastTimeLoaded;this._lastTimeLoaded=c.loaded,this._speedSampler.addBytes(U)}},l.prototype._normalizeSpeed=function(c){var u=this._chunkSizeKBList,p=u.length-1,U=0,D=0,j=p;if(c<u[0])return u[0];for(;D<=j;){if((U=D+Math.floor((j-D)/2))===p||c>=u[U]&&c<u[U+1])return u[U];u[U]<c?D=U+1:j=U-1}},l.prototype._onLoad=function(c){if(this._status!==v.c.kError)if(this._waitForTotalLength)this._waitForTotalLength=!1;else{this._lastTimeLoaded=0;var u=this._speedSampler.lastSecondKBps;if(u===0&&(this._zeroSpeedChunkCount++,this._zeroSpeedChunkCount>=3&&(u=this._speedSampler.currentKBps)),u!==0){var p=this._normalizeSpeed(u);this._currentSpeedNormalized!==p&&(this._currentSpeedNormalized=p,this._currentChunkSizeKB=p)}var U=c.target.response,D=this._range.from+this._receivedLength;this._receivedLength+=U.byteLength;var j=!1;this._contentLength!=null&&this._receivedLength<this._contentLength?this._openSubRange():j=!0,this._onDataArrival&&this._onDataArrival(U,D,this._receivedLength),j&&(this._status=v.c.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1))}},l.prototype._onXhrError=function(c){this._status=v.c.kError;var u=0,p=null;if(this._contentLength&&this._receivedLength>0&&this._receivedLength<this._contentLength?(u=v.b.EARLY_EOF,p={code:-1,msg:"RangeLoader meet Early-Eof"}):(u=v.b.EXCEPTION,p={code:-1,msg:c.constructor.name+" "+c.type}),!this._onError)throw new _.d(p.msg);this._onError(u,p)},l}(v.a),ce=function(){var b=function(l,c){return(b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,p){u.__proto__=p}||function(u,p){for(var U in p)p.hasOwnProperty(U)&&(u[U]=p[U])})(l,c)};return function(l,c){function u(){this.constructor=l}b(l,c),l.prototype=c===null?Object.create(c):(u.prototype=c.prototype,new u)}}(),ee=function(b){function l(){var c=b.call(this,"websocket-loader")||this;return c.TAG="WebSocketLoader",c._needStash=!0,c._ws=null,c._requestAbort=!1,c._receivedLength=0,c}return ce(l,b),l.isSupported=function(){try{return self.WebSocket!==void 0}catch{return!1}},l.prototype.destroy=function(){this._ws&&this.abort(),b.prototype.destroy.call(this)},l.prototype.open=function(c){try{var u=this._ws=new self.WebSocket(c.url);u.binaryType="arraybuffer",u.onopen=this._onWebSocketOpen.bind(this),u.onclose=this._onWebSocketClose.bind(this),u.onmessage=this._onWebSocketMessage.bind(this),u.onerror=this._onWebSocketError.bind(this),this._status=v.c.kConnecting}catch(U){this._status=v.c.kError;var p={code:U.code,msg:U.message};if(!this._onError)throw new _.d(p.msg);this._onError(v.b.EXCEPTION,p)}},l.prototype.abort=function(){var c=this._ws;!c||c.readyState!==0&&c.readyState!==1||(this._requestAbort=!0,c.close()),this._ws=null,this._status=v.c.kComplete},l.prototype._onWebSocketOpen=function(c){this._status=v.c.kBuffering},l.prototype._onWebSocketClose=function(c){this._requestAbort!==!0?(this._status=v.c.kComplete,this._onComplete&&this._onComplete(0,this._receivedLength-1)):this._requestAbort=!1},l.prototype._onWebSocketMessage=function(c){var u=this;if(c.data instanceof ArrayBuffer)this._dispatchArrayBuffer(c.data);else if(c.data instanceof Blob){var p=new FileReader;p.onload=function(){u._dispatchArrayBuffer(p.result)},p.readAsArrayBuffer(c.data)}else{this._status=v.c.kError;var U={code:-1,msg:"Unsupported WebSocket message type: "+c.data.constructor.name};if(!this._onError)throw new _.d(U.msg);this._onError(v.b.EXCEPTION,U)}},l.prototype._dispatchArrayBuffer=function(c){var u=c,p=this._receivedLength;this._receivedLength+=u.byteLength,this._onDataArrival&&this._onDataArrival(u,p,this._receivedLength)},l.prototype._onWebSocketError=function(c){this._status=v.c.kError;var u={code:c.code,msg:c.message};if(!this._onError)throw new _.d(u.msg);this._onError(v.b.EXCEPTION,u)},l}(v.a),re=function(){function b(l){this._zeroStart=l||!1}return b.prototype.getConfig=function(l,c){var u={};if(c.from!==0||c.to!==-1){var p=void 0;p=c.to!==-1?"bytes="+c.from.toString()+"-"+c.to.toString():"bytes="+c.from.toString()+"-",u.Range=p}else this._zeroStart&&(u.Range="bytes=0-");return{url:l,headers:u}},b.prototype.removeURLParameters=function(l){return l},b}(),f=function(){function b(l,c){this._startName=l,this._endName=c}return b.prototype.getConfig=function(l,c){var u=l;if(c.from!==0||c.to!==-1){var p=!0;u.indexOf("?")===-1&&(u+="?",p=!1),p&&(u+="&"),u+=this._startName+"="+c.from.toString(),c.to!==-1&&(u+="&"+this._endName+"="+c.to.toString())}return{url:u,headers:{}}},b.prototype.removeURLParameters=function(l){var c=l.split("?")[0],u=void 0,p=l.indexOf("?");p!==-1&&(u=l.substring(p+1));var U="";if(u!=null&&u.length>0)for(var D=u.split("&"),j=0;j<D.length;j++){var oe=D[j].split("="),be=j>0;oe[0]!==this._startName&&oe[0]!==this._endName&&(be&&(U+="&"),U+=D[j])}return U.length===0?c:c+"?"+U},b}(),V=function(){function b(l,c,u){this.TAG="IOController",this._config=c,this._extraData=u,this._stashInitialSize=65536,c.stashInitialSize!=null&&c.stashInitialSize>0&&(this._stashInitialSize=c.stashInitialSize),this._stashUsed=0,this._stashSize=this._stashInitialSize,this._bufferSize=3145728,this._stashBuffer=new ArrayBuffer(this._bufferSize),this._stashByteStart=0,this._enableStash=!0,c.enableStashBuffer===!1&&(this._enableStash=!1),this._loader=null,this._loaderClass=null,this._seekHandler=null,this._dataSource=l,this._isWebSocketURL=/wss?:\/\/(.+?)/.test(l.url),this._refTotalLength=l.filesize?l.filesize:null,this._totalLength=this._refTotalLength,this._fullRequestFlag=!1,this._currentRange=null,this._redirectedURL=null,this._speedNormalized=0,this._speedSampler=new y,this._speedNormalizeList=[32,64,96,128,192,256,384,512,768,1024,1536,2048,3072,4096],this._isEarlyEofReconnecting=!1,this._paused=!1,this._resumeFrom=0,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._selectSeekHandler(),this._selectLoader(),this._createLoader()}return b.prototype.destroy=function(){this._loader.isWorking()&&this._loader.abort(),this._loader.destroy(),this._loader=null,this._loaderClass=null,this._dataSource=null,this._stashBuffer=null,this._stashUsed=this._stashSize=this._bufferSize=this._stashByteStart=0,this._currentRange=null,this._speedSampler=null,this._isEarlyEofReconnecting=!1,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._extraData=null},b.prototype.isWorking=function(){return this._loader&&this._loader.isWorking()&&!this._paused},b.prototype.isPaused=function(){return this._paused},Object.defineProperty(b.prototype,"status",{get:function(){return this._loader.status},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"extraData",{get:function(){return this._extraData},set:function(l){this._extraData=l},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"onDataArrival",{get:function(){return this._onDataArrival},set:function(l){this._onDataArrival=l},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"onSeeked",{get:function(){return this._onSeeked},set:function(l){this._onSeeked=l},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"onError",{get:function(){return this._onError},set:function(l){this._onError=l},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"onComplete",{get:function(){return this._onComplete},set:function(l){this._onComplete=l},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"onRedirect",{get:function(){return this._onRedirect},set:function(l){this._onRedirect=l},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"onRecoveredEarlyEof",{get:function(){return this._onRecoveredEarlyEof},set:function(l){this._onRecoveredEarlyEof=l},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"currentURL",{get:function(){return this._dataSource.url},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"hasRedirect",{get:function(){return this._redirectedURL!=null||this._dataSource.redirectedURL!=null},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"currentRedirectedURL",{get:function(){return this._redirectedURL||this._dataSource.redirectedURL},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"currentSpeed",{get:function(){return this._loaderClass===pe?this._loader.currentSpeed:this._speedSampler.lastSecondKBps},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"loaderType",{get:function(){return this._loader.type},enumerable:!1,configurable:!0}),b.prototype._selectSeekHandler=function(){var l=this._config;if(l.seekType==="range")this._seekHandler=new re(this._config.rangeLoadZeroStart);else if(l.seekType==="param"){var c=l.seekParamStart||"bstart",u=l.seekParamEnd||"bend";this._seekHandler=new f(c,u)}else{if(l.seekType!=="custom")throw new _.b("Invalid seekType in config: "+l.seekType);if(typeof l.customSeekHandler!="function")throw new _.b("Custom seekType specified in config but invalid customSeekHandler!");this._seekHandler=new l.customSeekHandler}},b.prototype._selectLoader=function(){if(this._config.customLoader!=null)this._loaderClass=this._config.customLoader;else if(this._isWebSocketURL)this._loaderClass=ee;else if(P.isSupported())this._loaderClass=P;else if(O.isSupported())this._loaderClass=O;else{if(!pe.isSupported())throw new _.d("Your browser doesn't support xhr with arraybuffer responseType!");this._loaderClass=pe}},b.prototype._createLoader=function(){this._loader=new this._loaderClass(this._seekHandler,this._config),this._loader.needStashBuffer===!1&&(this._enableStash=!1),this._loader.onContentLengthKnown=this._onContentLengthKnown.bind(this),this._loader.onURLRedirect=this._onURLRedirect.bind(this),this._loader.onDataArrival=this._onLoaderChunkArrival.bind(this),this._loader.onComplete=this._onLoaderComplete.bind(this),this._loader.onError=this._onLoaderError.bind(this)},b.prototype.open=function(l){this._currentRange={from:0,to:-1},l&&(this._currentRange.from=l),this._speedSampler.reset(),l||(this._fullRequestFlag=!0),this._loader.open(this._dataSource,Object.assign({},this._currentRange))},b.prototype.abort=function(){this._loader.abort(),this._paused&&(this._paused=!1,this._resumeFrom=0)},b.prototype.pause=function(){this.isWorking()&&(this._loader.abort(),this._stashUsed!==0?(this._resumeFrom=this._stashByteStart,this._currentRange.to=this._stashByteStart-1):this._resumeFrom=this._currentRange.to+1,this._stashUsed=0,this._stashByteStart=0,this._paused=!0)},b.prototype.resume=function(){if(this._paused){this._paused=!1;var l=this._resumeFrom;this._resumeFrom=0,this._internalSeek(l,!0)}},b.prototype.seek=function(l){this._paused=!1,this._stashUsed=0,this._stashByteStart=0,this._internalSeek(l,!0)},b.prototype._internalSeek=function(l,c){this._loader.isWorking()&&this._loader.abort(),this._flushStashBuffer(c),this._loader.destroy(),this._loader=null;var u={from:l,to:-1};this._currentRange={from:u.from,to:-1},this._speedSampler.reset(),this._stashSize=this._stashInitialSize,this._createLoader(),this._loader.open(this._dataSource,u),this._onSeeked&&this._onSeeked()},b.prototype.updateUrl=function(l){if(!l||typeof l!="string"||l.length===0)throw new _.b("Url must be a non-empty string!");this._dataSource.url=l},b.prototype._expandBuffer=function(l){for(var c=this._stashSize;c+1048576<l;)c*=2;if((c+=1048576)!==this._bufferSize){var u=new ArrayBuffer(c);if(this._stashUsed>0){var p=new Uint8Array(this._stashBuffer,0,this._stashUsed);new Uint8Array(u,0,c).set(p,0)}this._stashBuffer=u,this._bufferSize=c}},b.prototype._normalizeSpeed=function(l){var c=this._speedNormalizeList,u=c.length-1,p=0,U=0,D=u;if(l<c[0])return c[0];for(;U<=D;){if((p=U+Math.floor((D-U)/2))===u||l>=c[p]&&l<c[p+1])return c[p];c[p]<l?U=p+1:D=p-1}},b.prototype._adjustStashSize=function(l){var c=0;(c=this._config.isLive?l/8:l<512?l:l>=512&&l<=1024?Math.floor(1.5*l):2*l)>8192&&(c=8192);var u=1024*c+1048576;this._bufferSize<u&&this._expandBuffer(u),this._stashSize=1024*c},b.prototype._dispatchChunks=function(l,c){return this._currentRange.to=c+l.byteLength-1,this._onDataArrival(l,c)},b.prototype._onURLRedirect=function(l){this._redirectedURL=l,this._onRedirect&&this._onRedirect(l)},b.prototype._onContentLengthKnown=function(l){l&&this._fullRequestFlag&&(this._totalLength=l,this._fullRequestFlag=!1)},b.prototype._onLoaderChunkArrival=function(l,c,u){if(!this._onDataArrival)throw new _.a("IOController: No existing consumer (onDataArrival) callback!");if(!this._paused){this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,this._onRecoveredEarlyEof&&this._onRecoveredEarlyEof()),this._speedSampler.addBytes(l.byteLength);var p=this._speedSampler.lastSecondKBps;if(p!==0){var U=this._normalizeSpeed(p);this._speedNormalized!==U&&(this._speedNormalized=U,this._adjustStashSize(U))}if(this._enableStash)if(this._stashUsed===0&&this._stashByteStart===0&&(this._stashByteStart=c),this._stashUsed+l.byteLength<=this._stashSize)(oe=new Uint8Array(this._stashBuffer,0,this._stashSize)).set(new Uint8Array(l),this._stashUsed),this._stashUsed+=l.byteLength;else if(oe=new Uint8Array(this._stashBuffer,0,this._bufferSize),this._stashUsed>0){var D=this._stashBuffer.slice(0,this._stashUsed);(be=this._dispatchChunks(D,this._stashByteStart))<D.byteLength?be>0&&(le=new Uint8Array(D,be),oe.set(le,0),this._stashUsed=le.byteLength,this._stashByteStart+=be):(this._stashUsed=0,this._stashByteStart+=be),this._stashUsed+l.byteLength>this._bufferSize&&(this._expandBuffer(this._stashUsed+l.byteLength),oe=new Uint8Array(this._stashBuffer,0,this._bufferSize)),oe.set(new Uint8Array(l),this._stashUsed),this._stashUsed+=l.byteLength}else(be=this._dispatchChunks(l,c))<l.byteLength&&((j=l.byteLength-be)>this._bufferSize&&(this._expandBuffer(j),oe=new Uint8Array(this._stashBuffer,0,this._bufferSize)),oe.set(new Uint8Array(l,be),0),this._stashUsed+=j,this._stashByteStart=c+be);else if(this._stashUsed===0){var j;(be=this._dispatchChunks(l,c))<l.byteLength&&((j=l.byteLength-be)>this._bufferSize&&this._expandBuffer(j),(oe=new Uint8Array(this._stashBuffer,0,this._bufferSize)).set(new Uint8Array(l,be),0),this._stashUsed+=j,this._stashByteStart=c+be)}else{var oe,be;if(this._stashUsed+l.byteLength>this._bufferSize&&this._expandBuffer(this._stashUsed+l.byteLength),(oe=new Uint8Array(this._stashBuffer,0,this._bufferSize)).set(new Uint8Array(l),this._stashUsed),this._stashUsed+=l.byteLength,(be=this._dispatchChunks(this._stashBuffer.slice(0,this._stashUsed),this._stashByteStart))<this._stashUsed&&be>0){var le=new Uint8Array(this._stashBuffer,be);oe.set(le,0)}this._stashUsed-=be,this._stashByteStart+=be}}},b.prototype._flushStashBuffer=function(l){if(this._stashUsed>0){var c=this._stashBuffer.slice(0,this._stashUsed),u=this._dispatchChunks(c,this._stashByteStart),p=c.byteLength-u;if(u<c.byteLength){if(!l){if(u>0){var U=new Uint8Array(this._stashBuffer,0,this._bufferSize),D=new Uint8Array(c,u);U.set(D,0),this._stashUsed=D.byteLength,this._stashByteStart+=u}return 0}M.a.w(this.TAG,p+" bytes unconsumed data remain when flush buffer, dropped")}return this._stashUsed=0,this._stashByteStart=0,p}return 0},b.prototype._onLoaderComplete=function(l,c){this._flushStashBuffer(!0),this._onComplete&&this._onComplete(this._extraData)},b.prototype._onLoaderError=function(l,c){switch(M.a.e(this.TAG,"Loader error, code = "+c.code+", msg = "+c.msg),this._flushStashBuffer(!1),this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,l=v.b.UNRECOVERABLE_EARLY_EOF),l){case v.b.EARLY_EOF:if(!this._config.isLive&&this._totalLength){var u=this._currentRange.to+1;return void(u<this._totalLength&&(M.a.w(this.TAG,"Connection lost, trying reconnect..."),this._isEarlyEofReconnecting=!0,this._internalSeek(u,!1)))}l=v.b.UNRECOVERABLE_EARLY_EOF;break;case v.b.UNRECOVERABLE_EARLY_EOF:case v.b.CONNECTING_TIMEOUT:case v.b.HTTP_STATUS_CODE_INVALID:case v.b.EXCEPTION:}if(!this._onError)throw new _.d("IOException: "+c.msg);this._onError(l,c)},b}();q.a=V},function(he,q,I){var z=function(){function M(){}return M.install=function(){Object.setPrototypeOf=Object.setPrototypeOf||function(y,v){return y.__proto__=v,y},Object.assign=Object.assign||function(y){if(y==null)throw new TypeError("Cannot convert undefined or null to object");for(var v=Object(y),m=1;m<arguments.length;m++){var _=arguments[m];if(_!=null)for(var R in _)_.hasOwnProperty(R)&&(v[R]=_[R])}return v},typeof self.Promise!="function"&&I(15).polyfill()},M}();z.install(),q.a=z},function(he,q,I){function z(m){var _={};function R(w){if(_[w])return _[w].exports;var O=_[w]={i:w,l:!1,exports:{}};return m[w].call(O.exports,O,O.exports,R),O.l=!0,O.exports}R.m=m,R.c=_,R.i=function(w){return w},R.d=function(w,O,x){R.o(w,O)||Object.defineProperty(w,O,{configurable:!1,enumerable:!0,get:x})},R.r=function(w){Object.defineProperty(w,"__esModule",{value:!0})},R.n=function(w){var O=w&&w.__esModule?function(){return w.default}:function(){return w};return R.d(O,"a",O),O},R.o=function(w,O){return Object.prototype.hasOwnProperty.call(w,O)},R.p="/",R.oe=function(w){throw console.error(w),w};var P=R(R.s=ENTRY_MODULE);return P.default||P}function M(m){return(m+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function y(m,_,R){var P={};P[R]=[];var w=_.toString(),O=w.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!O)return P;for(var x,pe=O[1],ce=new RegExp("(\\\\n|\\W)"+M(pe)+"\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)","g");x=ce.exec(w);)x[3]!=="dll-reference"&&P[R].push(x[3]);for(ce=new RegExp("\\("+M(pe)+'\\("(dll-reference\\s([\\.|\\-|\\+|\\w|/|@]+))"\\)\\)\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)',"g");x=ce.exec(w);)m[x[2]]||(P[R].push(x[1]),m[x[2]]=I(x[1]).m),P[x[2]]=P[x[2]]||[],P[x[2]].push(x[4]);for(var ee,re=Object.keys(P),f=0;f<re.length;f++)for(var V=0;V<P[re[f]].length;V++)ee=P[re[f]][V],isNaN(1*ee)||(P[re[f]][V]=1*P[re[f]][V]);return P}function v(m){return Object.keys(m).reduce(function(_,R){return _||m[R].length>0},!1)}he.exports=function(m,_){_=_||{};var R={main:I.m},P=_.all?{main:Object.keys(R.main)}:function(ce,ee){for(var re={main:[ee]},f={main:[]},V={main:{}};v(re);)for(var b=Object.keys(re),l=0;l<b.length;l++){var c=b[l],u=re[c].pop();if(V[c]=V[c]||{},!V[c][u]&&ce[c][u]){V[c][u]=!0,f[c]=f[c]||[],f[c].push(u);for(var p=y(ce,ce[c][u],c),U=Object.keys(p),D=0;D<U.length;D++)re[U[D]]=re[U[D]]||[],re[U[D]]=re[U[D]].concat(p[U[D]])}}return f}(R,m),w="";Object.keys(P).filter(function(ce){return ce!=="main"}).forEach(function(ce){for(var ee=0;P[ce][ee];)ee++;P[ce].push(ee),R[ce][ee]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",w=w+"var "+ce+" = ("+z.toString().replace("ENTRY_MODULE",JSON.stringify(ee))+")({"+P[ce].map(function(re){return JSON.stringify(re)+": "+R[ce][re].toString()}).join(",")+`});
`}),w=w+"new (("+z.toString().replace("ENTRY_MODULE",JSON.stringify(m))+")({"+P.main.map(function(ce){return JSON.stringify(ce)+": "+R.main[ce].toString()}).join(",")+"}))(self);";var O=new window.Blob([w],{type:"text/javascript"});if(_.bare)return O;var x=(window.URL||window.webkitURL||window.mozURL||window.msURL).createObjectURL(O),pe=new window.Worker(x);return pe.objectURL=x,pe}},function(he,q,I){he.exports=I(19).default},function(he,q,I){(function(z,M){/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */var y;y=function(){function v(N){return typeof N=="function"}var m=Array.isArray?Array.isArray:function(N){return Object.prototype.toString.call(N)==="[object Array]"},_=0,R=void 0,P=void 0,w=function(N,$){f[_]=N,f[_+1]=$,(_+=2)===2&&(P?P(V):p())},O=typeof window<"u"?window:void 0,x=O||{},pe=x.MutationObserver||x.WebKitMutationObserver,ce=typeof self>"u"&&z!==void 0&&{}.toString.call(z)==="[object process]",ee=typeof Uint8ClampedArray<"u"&&typeof importScripts<"u"&&typeof MessageChannel<"u";function re(){var N=setTimeout;return function(){return N(V,1)}}var f=new Array(1e3);function V(){for(var N=0;N<_;N+=2)(0,f[N])(f[N+1]),f[N]=void 0,f[N+1]=void 0;_=0}var b,l,c,u,p=void 0;function U(N,$){var se=this,te=new this.constructor(oe);te[j]===void 0&&Oe(te);var de=se._state;if(de){var ye=arguments[de-1];w(function(){return _e(de,te,ye,se._result)})}else E(se,te,N,$);return te}function D(N){if(N&&typeof N=="object"&&N.constructor===this)return N;var $=new this(oe);return le($,N),$}ce?p=function(){return z.nextTick(V)}:pe?(l=0,c=new pe(V),u=document.createTextNode(""),c.observe(u,{characterData:!0}),p=function(){u.data=l=++l%2}):ee?((b=new MessageChannel).port1.onmessage=V,p=function(){return b.port2.postMessage(0)}):p=O===void 0?function(){try{var N=Function("return this")().require("vertx");return(R=N.runOnLoop||N.runOnContext)!==void 0?function(){R(V)}:re()}catch{return re()}}():re();var j=Math.random().toString(36).substring(2);function oe(){}function be(N,$,se){$.constructor===N.constructor&&se===U&&$.constructor.resolve===D?function(te,de){de._state===1?o(te,de._result):de._state===2?h(te,de._result):E(de,void 0,function(ye){return le(te,ye)},function(ye){return h(te,ye)})}(N,$):se===void 0?o(N,$):v(se)?function(te,de,ye){w(function(xe){var Ge=!1,qe=function(Q,K,ke,Je){try{Q.call(K,ke,Je)}catch(tt){return tt}}(ye,de,function(Q){Ge||(Ge=!0,de!==Q?le(xe,Q):o(xe,Q))},function(Q){Ge||(Ge=!0,h(xe,Q))},xe._label);!Ge&&qe&&(Ge=!0,h(xe,qe))},te)}(N,$,se):o(N,$)}function le(N,$){if(N===$)h(N,new TypeError("You cannot resolve a promise with itself"));else if(de=typeof(te=$),te===null||de!=="object"&&de!=="function")o(N,$);else{var se=void 0;try{se=$.then}catch(ye){return void h(N,ye)}be(N,$,se)}var te,de}function k(N){N._onerror&&N._onerror(N._result),X(N)}function o(N,$){N._state===void 0&&(N._result=$,N._state=1,N._subscribers.length!==0&&w(X,N))}function h(N,$){N._state===void 0&&(N._state=2,N._result=$,w(k,N))}function E(N,$,se,te){var de=N._subscribers,ye=de.length;N._onerror=null,de[ye]=$,de[ye+1]=se,de[ye+2]=te,ye===0&&N._state&&w(X,N)}function X(N){var $=N._subscribers,se=N._state;if($.length!==0){for(var te=void 0,de=void 0,ye=N._result,xe=0;xe<$.length;xe+=3)te=$[xe],de=$[xe+se],te?_e(se,te,de,ye):de(ye);N._subscribers.length=0}}function _e(N,$,se,te){var de=v(se),ye=void 0,xe=void 0,Ge=!0;if(de){try{ye=se(te)}catch(qe){Ge=!1,xe=qe}if($===ye)return void h($,new TypeError("A promises callback cannot return that same promise."))}else ye=te;$._state!==void 0||(de&&Ge?le($,ye):Ge===!1?h($,xe):N===1?o($,ye):N===2&&h($,ye))}var me=0;function Oe(N){N[j]=me++,N._state=void 0,N._result=void 0,N._subscribers=[]}var ze=function(){function N($,se){this._instanceConstructor=$,this.promise=new $(oe),this.promise[j]||Oe(this.promise),m(se)?(this.length=se.length,this._remaining=se.length,this._result=new Array(this.length),this.length===0?o(this.promise,this._result):(this.length=this.length||0,this._enumerate(se),this._remaining===0&&o(this.promise,this._result))):h(this.promise,new Error("Array Methods must be provided an Array"))}return N.prototype._enumerate=function($){for(var se=0;this._state===void 0&&se<$.length;se++)this._eachEntry($[se],se)},N.prototype._eachEntry=function($,se){var te=this._instanceConstructor,de=te.resolve;if(de===D){var ye=void 0,xe=void 0,Ge=!1;try{ye=$.then}catch(Q){Ge=!0,xe=Q}if(ye===U&&$._state!==void 0)this._settledAt($._state,se,$._result);else if(typeof ye!="function")this._remaining--,this._result[se]=$;else if(te===Ce){var qe=new te(oe);Ge?h(qe,xe):be(qe,$,ye),this._willSettleAt(qe,se)}else this._willSettleAt(new te(function(Q){return Q($)}),se)}else this._willSettleAt(de($),se)},N.prototype._settledAt=function($,se,te){var de=this.promise;de._state===void 0&&(this._remaining--,$===2?h(de,te):this._result[se]=te),this._remaining===0&&o(de,this._result)},N.prototype._willSettleAt=function($,se){var te=this;E($,void 0,function(de){return te._settledAt(1,se,de)},function(de){return te._settledAt(2,se,de)})},N}(),Ce=function(){function N($){this[j]=me++,this._result=this._state=void 0,this._subscribers=[],oe!==$&&(typeof $!="function"&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof N?function(se,te){try{te(function(de){le(se,de)},function(de){h(se,de)})}catch(de){h(se,de)}}(this,$):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return N.prototype.catch=function($){return this.then(null,$)},N.prototype.finally=function($){var se=this.constructor;return v($)?this.then(function(te){return se.resolve($()).then(function(){return te})},function(te){return se.resolve($()).then(function(){throw te})}):this.then($,$)},N}();return Ce.prototype.then=U,Ce.all=function(N){return new ze(this,N).promise},Ce.race=function(N){var $=this;return m(N)?new $(function(se,te){for(var de=N.length,ye=0;ye<de;ye++)$.resolve(N[ye]).then(se,te)}):new $(function(se,te){return te(new TypeError("You must pass an array to race."))})},Ce.resolve=D,Ce.reject=function(N){var $=new this(oe);return h($,N),$},Ce._setScheduler=function(N){P=N},Ce._setAsap=function(N){w=N},Ce._asap=w,Ce.polyfill=function(){var N=void 0;if(M!==void 0)N=M;else if(typeof self<"u")N=self;else try{N=Function("return this")()}catch{throw new Error("polyfill failed because global object is unavailable in this environment")}var $=N.Promise;if($){var se=null;try{se=Object.prototype.toString.call($.resolve())}catch{}if(se==="[object Promise]"&&!$.cast)return}N.Promise=Ce},Ce.Promise=Ce,Ce},he.exports=y()}).call(this,I(16),I(17))},function(he,q){var I,z,M=he.exports={};function y(){throw new Error("setTimeout has not been defined")}function v(){throw new Error("clearTimeout has not been defined")}function m(ee){if(I===setTimeout)return setTimeout(ee,0);if((I===y||!I)&&setTimeout)return I=setTimeout,setTimeout(ee,0);try{return I(ee,0)}catch{try{return I.call(null,ee,0)}catch{return I.call(this,ee,0)}}}(function(){try{I=typeof setTimeout=="function"?setTimeout:y}catch{I=y}try{z=typeof clearTimeout=="function"?clearTimeout:v}catch{z=v}})();var _,R=[],P=!1,w=-1;function O(){P&&_&&(P=!1,_.length?R=_.concat(R):w=-1,R.length&&x())}function x(){if(!P){var ee=m(O);P=!0;for(var re=R.length;re;){for(_=R,R=[];++w<re;)_&&_[w].run();w=-1,re=R.length}_=null,P=!1,function(f){if(z===clearTimeout)return clearTimeout(f);if((z===v||!z)&&clearTimeout)return z=clearTimeout,clearTimeout(f);try{z(f)}catch{try{return z.call(null,f)}catch{return z.call(this,f)}}}(ee)}}function pe(ee,re){this.fun=ee,this.array=re}function ce(){}M.nextTick=function(ee){var re=new Array(arguments.length-1);if(arguments.length>1)for(var f=1;f<arguments.length;f++)re[f-1]=arguments[f];R.push(new pe(ee,re)),R.length!==1||P||m(x)},pe.prototype.run=function(){this.fun.apply(null,this.array)},M.title="browser",M.browser=!0,M.env={},M.argv=[],M.version="",M.versions={},M.on=ce,M.addListener=ce,M.once=ce,M.off=ce,M.removeListener=ce,M.removeAllListeners=ce,M.emit=ce,M.prependListener=ce,M.prependOnceListener=ce,M.listeners=function(ee){return[]},M.binding=function(ee){throw new Error("process.binding is not supported")},M.cwd=function(){return"/"},M.chdir=function(ee){throw new Error("process.chdir is not supported")},M.umask=function(){return 0}},function(he,q){var I;I=function(){return this}();try{I=I||new Function("return this")()}catch{typeof window=="object"&&(I=window)}he.exports=I},function(he,q,I){I.r(q);var z=I(9),M=I(12),y=I(10),v=I(1);q.default=function(m){var _=null,R=function(D,j){m.postMessage({msg:"logcat_callback",data:{type:D,logcat:j}})}.bind(this);function P(D,j){var oe={msg:v.a.INIT_SEGMENT,data:{type:D,data:j}};m.postMessage(oe,[j.data])}function w(D,j){var oe={msg:v.a.MEDIA_SEGMENT,data:{type:D,data:j}};m.postMessage(oe,[j.data])}function O(){var D={msg:v.a.LOADING_COMPLETE};m.postMessage(D)}function x(){var D={msg:v.a.RECOVERED_EARLY_EOF};m.postMessage(D)}function pe(D){var j={msg:v.a.MEDIA_INFO,data:D};m.postMessage(j)}function ce(D){var j={msg:v.a.METADATA_ARRIVED,data:D};m.postMessage(j)}function ee(D){var j={msg:v.a.SCRIPTDATA_ARRIVED,data:D};m.postMessage(j)}function re(D){var j={msg:v.a.TIMED_ID3_METADATA_ARRIVED,data:D};m.postMessage(j)}function f(D){var j={msg:v.a.SMPTE2038_METADATA_ARRIVED,data:D};m.postMessage(j)}function V(D){var j={msg:v.a.SCTE35_METADATA_ARRIVED,data:D};m.postMessage(j)}function b(D){var j={msg:v.a.PES_PRIVATE_DATA_DESCRIPTOR,data:D};m.postMessage(j)}function l(D){var j={msg:v.a.PES_PRIVATE_DATA_ARRIVED,data:D};m.postMessage(j)}function c(D){var j={msg:v.a.STATISTICS_INFO,data:D};m.postMessage(j)}function u(D,j){m.postMessage({msg:v.a.IO_ERROR,data:{type:D,info:j}})}function p(D,j){m.postMessage({msg:v.a.DEMUX_ERROR,data:{type:D,info:j}})}function U(D){m.postMessage({msg:v.a.RECOMMEND_SEEKPOINT,data:D})}M.a.install(),m.addEventListener("message",function(D){switch(D.data.cmd){case"init":(_=new y.a(D.data.param[0],D.data.param[1])).on(v.a.IO_ERROR,u.bind(this)),_.on(v.a.DEMUX_ERROR,p.bind(this)),_.on(v.a.INIT_SEGMENT,P.bind(this)),_.on(v.a.MEDIA_SEGMENT,w.bind(this)),_.on(v.a.LOADING_COMPLETE,O.bind(this)),_.on(v.a.RECOVERED_EARLY_EOF,x.bind(this)),_.on(v.a.MEDIA_INFO,pe.bind(this)),_.on(v.a.METADATA_ARRIVED,ce.bind(this)),_.on(v.a.SCRIPTDATA_ARRIVED,ee.bind(this)),_.on(v.a.TIMED_ID3_METADATA_ARRIVED,re.bind(this)),_.on(v.a.SMPTE2038_METADATA_ARRIVED,f.bind(this)),_.on(v.a.SCTE35_METADATA_ARRIVED,V.bind(this)),_.on(v.a.PES_PRIVATE_DATA_DESCRIPTOR,b.bind(this)),_.on(v.a.PES_PRIVATE_DATA_ARRIVED,l.bind(this)),_.on(v.a.STATISTICS_INFO,c.bind(this)),_.on(v.a.RECOMMEND_SEEKPOINT,U.bind(this));break;case"destroy":_&&(_.destroy(),_=null),m.postMessage({msg:"destroyed"});break;case"start":_.start();break;case"stop":_.stop();break;case"seek":_.seek(D.data.param);break;case"pause":_.pause();break;case"resume":_.resume();break;case"logging_config":var j=D.data.param;z.a.applyConfig(j),j.enableCallback===!0?z.a.addLogListener(R):z.a.removeLogListener(R)}})}},function(he,q,I){I.r(q);var z=I(12),M=I(11),y={enableWorker:!1,enableStashBuffer:!0,stashInitialSize:void 0,isLive:!1,liveBufferLatencyChasing:!1,liveBufferLatencyMaxLatency:1.5,liveBufferLatencyMinRemain:.5,lazyLoad:!0,lazyLoadMaxDuration:180,lazyLoadRecoverDuration:30,deferLoadAfterSourceOpen:!0,autoCleanupMaxBackwardDuration:180,autoCleanupMinBackwardDuration:120,statisticsInfoReportInterval:600,fixAudioTimestampGap:!0,accurateSeek:!1,seekType:"range",seekParamStart:"bstart",seekParamEnd:"bend",rangeLoadZeroStart:!1,customSeekHandler:void 0,reuseRedirectedURL:!1,headers:void 0,customLoader:void 0};function v(){return Object.assign({},y)}var m=function(){function k(){}return k.supportMSEH264Playback=function(){return window.MediaSource&&window.MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"')},k.supportMSEH265Playback=function(){return window.MediaSource&&window.MediaSource.isTypeSupported('video/mp4; codecs="hvc1.1.6.L93.B0"')},k.supportNetworkStreamIO=function(){var o=new M.a({},v()),h=o.loaderType;return o.destroy(),h=="fetch-stream-loader"||h=="xhr-moz-chunked-loader"},k.getNetworkLoaderTypeName=function(){var o=new M.a({},v()),h=o.loaderType;return o.destroy(),h},k.supportNativeMediaPlayback=function(o){k.videoElement==null&&(k.videoElement=window.document.createElement("video"));var h=k.videoElement.canPlayType(o);return h==="probably"||h=="maybe"},k.getFeatureList=function(){var o={msePlayback:!1,mseLivePlayback:!1,mseH265Playback:!1,networkStreamIO:!1,networkLoaderName:"",nativeMP4H264Playback:!1,nativeMP4H265Playback:!1,nativeWebmVP8Playback:!1,nativeWebmVP9Playback:!1};return o.msePlayback=k.supportMSEH264Playback(),o.networkStreamIO=k.supportNetworkStreamIO(),o.networkLoaderName=k.getNetworkLoaderTypeName(),o.mseLivePlayback=o.msePlayback&&o.networkStreamIO,o.mseH265Playback=k.supportMSEH265Playback(),o.nativeMP4H264Playback=k.supportNativeMediaPlayback('video/mp4; codecs="avc1.42001E, mp4a.40.2"'),o.nativeMP4H265Playback=k.supportNativeMediaPlayback('video/mp4; codecs="hvc1.1.6.L93.B0"'),o.nativeWebmVP8Playback=k.supportNativeMediaPlayback('video/webm; codecs="vp8.0, vorbis"'),o.nativeWebmVP9Playback=k.supportNativeMediaPlayback('video/webm; codecs="vp9"'),o},k}(),_=I(2),R=I(6),P=I.n(R),w=I(0),O=I(4),x={ERROR:"error",LOADING_COMPLETE:"loading_complete",RECOVERED_EARLY_EOF:"recovered_early_eof",MEDIA_INFO:"media_info",METADATA_ARRIVED:"metadata_arrived",SCRIPTDATA_ARRIVED:"scriptdata_arrived",TIMED_ID3_METADATA_ARRIVED:"timed_id3_metadata_arrived",SMPTE2038_METADATA_ARRIVED:"smpte2038_metadata_arrived",SCTE35_METADATA_ARRIVED:"scte35_metadata_arrived",PES_PRIVATE_DATA_DESCRIPTOR:"pes_private_data_descriptor",PES_PRIVATE_DATA_ARRIVED:"pes_private_data_arrived",STATISTICS_INFO:"statistics_info"},pe=I(13),ce=I.n(pe),ee=I(9),re=I(10),f=I(1),V=I(8),b=function(){function k(o,h){if(this.TAG="Transmuxer",this._emitter=new P.a,h.enableWorker&&typeof Worker<"u")try{this._worker=ce()(18),this._workerDestroying=!1,this._worker.addEventListener("message",this._onWorkerMessage.bind(this)),this._worker.postMessage({cmd:"init",param:[o,h]}),this.e={onLoggingConfigChanged:this._onLoggingConfigChanged.bind(this)},ee.a.registerListener(this.e.onLoggingConfigChanged),this._worker.postMessage({cmd:"logging_config",param:ee.a.getConfig()})}catch{w.a.e(this.TAG,"Error while initialize transmuxing worker, fallback to inline transmuxing"),this._worker=null,this._controller=new re.a(o,h)}else this._controller=new re.a(o,h);if(this._controller){var E=this._controller;E.on(f.a.IO_ERROR,this._onIOError.bind(this)),E.on(f.a.DEMUX_ERROR,this._onDemuxError.bind(this)),E.on(f.a.INIT_SEGMENT,this._onInitSegment.bind(this)),E.on(f.a.MEDIA_SEGMENT,this._onMediaSegment.bind(this)),E.on(f.a.LOADING_COMPLETE,this._onLoadingComplete.bind(this)),E.on(f.a.RECOVERED_EARLY_EOF,this._onRecoveredEarlyEof.bind(this)),E.on(f.a.MEDIA_INFO,this._onMediaInfo.bind(this)),E.on(f.a.METADATA_ARRIVED,this._onMetaDataArrived.bind(this)),E.on(f.a.SCRIPTDATA_ARRIVED,this._onScriptDataArrived.bind(this)),E.on(f.a.TIMED_ID3_METADATA_ARRIVED,this._onTimedID3MetadataArrived.bind(this)),E.on(f.a.SMPTE2038_METADATA_ARRIVED,this._onSMPTE2038MetadataArrived.bind(this)),E.on(f.a.SCTE35_METADATA_ARRIVED,this._onSCTE35MetadataArrived.bind(this)),E.on(f.a.PES_PRIVATE_DATA_DESCRIPTOR,this._onPESPrivateDataDescriptor.bind(this)),E.on(f.a.PES_PRIVATE_DATA_ARRIVED,this._onPESPrivateDataArrived.bind(this)),E.on(f.a.STATISTICS_INFO,this._onStatisticsInfo.bind(this)),E.on(f.a.RECOMMEND_SEEKPOINT,this._onRecommendSeekpoint.bind(this))}}return k.prototype.destroy=function(){this._worker?this._workerDestroying||(this._workerDestroying=!0,this._worker.postMessage({cmd:"destroy"}),ee.a.removeListener(this.e.onLoggingConfigChanged),this.e=null):(this._controller.destroy(),this._controller=null),this._emitter.removeAllListeners(),this._emitter=null},k.prototype.on=function(o,h){this._emitter.addListener(o,h)},k.prototype.off=function(o,h){this._emitter.removeListener(o,h)},k.prototype.hasWorker=function(){return this._worker!=null},k.prototype.open=function(){this._worker?this._worker.postMessage({cmd:"start"}):this._controller.start()},k.prototype.close=function(){this._worker?this._worker.postMessage({cmd:"stop"}):this._controller.stop()},k.prototype.seek=function(o){this._worker?this._worker.postMessage({cmd:"seek",param:o}):this._controller.seek(o)},k.prototype.pause=function(){this._worker?this._worker.postMessage({cmd:"pause"}):this._controller.pause()},k.prototype.resume=function(){this._worker?this._worker.postMessage({cmd:"resume"}):this._controller.resume()},k.prototype._onInitSegment=function(o,h){var E=this;Promise.resolve().then(function(){E._emitter.emit(f.a.INIT_SEGMENT,o,h)})},k.prototype._onMediaSegment=function(o,h){var E=this;Promise.resolve().then(function(){E._emitter.emit(f.a.MEDIA_SEGMENT,o,h)})},k.prototype._onLoadingComplete=function(){var o=this;Promise.resolve().then(function(){o._emitter.emit(f.a.LOADING_COMPLETE)})},k.prototype._onRecoveredEarlyEof=function(){var o=this;Promise.resolve().then(function(){o._emitter.emit(f.a.RECOVERED_EARLY_EOF)})},k.prototype._onMediaInfo=function(o){var h=this;Promise.resolve().then(function(){h._emitter.emit(f.a.MEDIA_INFO,o)})},k.prototype._onMetaDataArrived=function(o){var h=this;Promise.resolve().then(function(){h._emitter.emit(f.a.METADATA_ARRIVED,o)})},k.prototype._onScriptDataArrived=function(o){var h=this;Promise.resolve().then(function(){h._emitter.emit(f.a.SCRIPTDATA_ARRIVED,o)})},k.prototype._onTimedID3MetadataArrived=function(o){var h=this;Promise.resolve().then(function(){h._emitter.emit(f.a.TIMED_ID3_METADATA_ARRIVED,o)})},k.prototype._onSMPTE2038MetadataArrived=function(o){var h=this;Promise.resolve().then(function(){h._emitter.emit(f.a.SMPTE2038_METADATA_ARRIVED,o)})},k.prototype._onSCTE35MetadataArrived=function(o){var h=this;Promise.resolve().then(function(){h._emitter.emit(f.a.SCTE35_METADATA_ARRIVED,o)})},k.prototype._onPESPrivateDataDescriptor=function(o){var h=this;Promise.resolve().then(function(){h._emitter.emit(f.a.PES_PRIVATE_DATA_DESCRIPTOR,o)})},k.prototype._onPESPrivateDataArrived=function(o){var h=this;Promise.resolve().then(function(){h._emitter.emit(f.a.PES_PRIVATE_DATA_ARRIVED,o)})},k.prototype._onStatisticsInfo=function(o){var h=this;Promise.resolve().then(function(){h._emitter.emit(f.a.STATISTICS_INFO,o)})},k.prototype._onIOError=function(o,h){var E=this;Promise.resolve().then(function(){E._emitter.emit(f.a.IO_ERROR,o,h)})},k.prototype._onDemuxError=function(o,h){var E=this;Promise.resolve().then(function(){E._emitter.emit(f.a.DEMUX_ERROR,o,h)})},k.prototype._onRecommendSeekpoint=function(o){var h=this;Promise.resolve().then(function(){h._emitter.emit(f.a.RECOMMEND_SEEKPOINT,o)})},k.prototype._onLoggingConfigChanged=function(o){this._worker&&this._worker.postMessage({cmd:"logging_config",param:o})},k.prototype._onWorkerMessage=function(o){var h=o.data,E=h.data;if(h.msg==="destroyed"||this._workerDestroying)return this._workerDestroying=!1,this._worker.terminate(),void(this._worker=null);switch(h.msg){case f.a.INIT_SEGMENT:case f.a.MEDIA_SEGMENT:this._emitter.emit(h.msg,E.type,E.data);break;case f.a.LOADING_COMPLETE:case f.a.RECOVERED_EARLY_EOF:this._emitter.emit(h.msg);break;case f.a.MEDIA_INFO:Object.setPrototypeOf(E,V.a.prototype),this._emitter.emit(h.msg,E);break;case f.a.METADATA_ARRIVED:case f.a.SCRIPTDATA_ARRIVED:case f.a.TIMED_ID3_METADATA_ARRIVED:case f.a.SMPTE2038_METADATA_ARRIVED:case f.a.SCTE35_METADATA_ARRIVED:case f.a.PES_PRIVATE_DATA_DESCRIPTOR:case f.a.PES_PRIVATE_DATA_ARRIVED:case f.a.STATISTICS_INFO:this._emitter.emit(h.msg,E);break;case f.a.IO_ERROR:case f.a.DEMUX_ERROR:this._emitter.emit(h.msg,E.type,E.info);break;case f.a.RECOMMEND_SEEKPOINT:this._emitter.emit(h.msg,E);break;case"logcat_callback":w.a.emitter.emit("log",E.type,E.logcat)}},k}(),l={ERROR:"error",SOURCE_OPEN:"source_open",UPDATE_END:"update_end",BUFFER_FULL:"buffer_full"},c=I(7),u=I(3),p=function(){function k(o){this.TAG="MSEController",this._config=o,this._emitter=new P.a,this._config.isLive&&this._config.autoCleanupSourceBuffer==null&&(this._config.autoCleanupSourceBuffer=!0),this.e={onSourceOpen:this._onSourceOpen.bind(this),onSourceEnded:this._onSourceEnded.bind(this),onSourceClose:this._onSourceClose.bind(this),onSourceBufferError:this._onSourceBufferError.bind(this),onSourceBufferUpdateEnd:this._onSourceBufferUpdateEnd.bind(this)},this._mediaSource=null,this._mediaSourceObjectURL=null,this._mediaElement=null,this._isBufferFull=!1,this._hasPendingEos=!1,this._requireSetMediaDuration=!1,this._pendingMediaDuration=0,this._pendingSourceBufferInit=[],this._mimeTypes={video:null,audio:null},this._sourceBuffers={video:null,audio:null},this._lastInitSegments={video:null,audio:null},this._pendingSegments={video:[],audio:[]},this._pendingRemoveRanges={video:[],audio:[]},this._idrList=new c.a}return k.prototype.destroy=function(){(this._mediaElement||this._mediaSource)&&this.detachMediaElement(),this.e=null,this._emitter.removeAllListeners(),this._emitter=null},k.prototype.on=function(o,h){this._emitter.addListener(o,h)},k.prototype.off=function(o,h){this._emitter.removeListener(o,h)},k.prototype.attachMediaElement=function(o){if(this._mediaSource)throw new u.a("MediaSource has been attached to an HTMLMediaElement!");var h=this._mediaSource=new window.MediaSource;h.addEventListener("sourceopen",this.e.onSourceOpen),h.addEventListener("sourceended",this.e.onSourceEnded),h.addEventListener("sourceclose",this.e.onSourceClose),this._mediaElement=o,this._mediaSourceObjectURL=window.URL.createObjectURL(this._mediaSource),o.src=this._mediaSourceObjectURL},k.prototype.detachMediaElement=function(){if(this._mediaSource){var o=this._mediaSource;for(var h in this._sourceBuffers){var E=this._pendingSegments[h];E.splice(0,E.length),this._pendingSegments[h]=null,this._pendingRemoveRanges[h]=null,this._lastInitSegments[h]=null;var X=this._sourceBuffers[h];if(X){if(o.readyState!=="closed"){try{o.removeSourceBuffer(X)}catch(_e){w.a.e(this.TAG,_e.message)}X.removeEventListener("error",this.e.onSourceBufferError),X.removeEventListener("updateend",this.e.onSourceBufferUpdateEnd)}this._mimeTypes[h]=null,this._sourceBuffers[h]=null}}if(o.readyState==="open")try{o.endOfStream()}catch(_e){w.a.e(this.TAG,_e.message)}o.removeEventListener("sourceopen",this.e.onSourceOpen),o.removeEventListener("sourceended",this.e.onSourceEnded),o.removeEventListener("sourceclose",this.e.onSourceClose),this._pendingSourceBufferInit=[],this._isBufferFull=!1,this._idrList.clear(),this._mediaSource=null}this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src"),this._mediaElement=null),this._mediaSourceObjectURL&&(window.URL.revokeObjectURL(this._mediaSourceObjectURL),this._mediaSourceObjectURL=null)},k.prototype.appendInitSegment=function(o,h){if(!this._mediaSource||this._mediaSource.readyState!=="open")return this._pendingSourceBufferInit.push(o),void this._pendingSegments[o.type].push(o);var E=o,X=""+E.container;E.codec&&E.codec.length>0&&(X+=";codecs="+E.codec);var _e=!1;if(w.a.v(this.TAG,"Received Initialization Segment, mimeType: "+X),this._lastInitSegments[E.type]=E,X!==this._mimeTypes[E.type]){if(this._mimeTypes[E.type])w.a.v(this.TAG,"Notice: "+E.type+" mimeType changed, origin: "+this._mimeTypes[E.type]+", target: "+X);else{_e=!0;try{var me=this._sourceBuffers[E.type]=this._mediaSource.addSourceBuffer(X);me.addEventListener("error",this.e.onSourceBufferError),me.addEventListener("updateend",this.e.onSourceBufferUpdateEnd)}catch(Oe){return w.a.e(this.TAG,Oe.message),void this._emitter.emit(l.ERROR,{code:Oe.code,msg:Oe.message})}}this._mimeTypes[E.type]=X}h||this._pendingSegments[E.type].push(E),_e||this._sourceBuffers[E.type]&&!this._sourceBuffers[E.type].updating&&this._doAppendSegments(),O.a.safari&&E.container==="audio/mpeg"&&E.mediaDuration>0&&(this._requireSetMediaDuration=!0,this._pendingMediaDuration=E.mediaDuration/1e3,this._updateMediaSourceDuration())},k.prototype.appendMediaSegment=function(o){var h=o;this._pendingSegments[h.type].push(h),this._config.autoCleanupSourceBuffer&&this._needCleanupSourceBuffer()&&this._doCleanupSourceBuffer();var E=this._sourceBuffers[h.type];!E||E.updating||this._hasPendingRemoveRanges()||this._doAppendSegments()},k.prototype.seek=function(o){for(var h in this._sourceBuffers)if(this._sourceBuffers[h]){var E=this._sourceBuffers[h];if(this._mediaSource.readyState==="open")try{E.abort()}catch(Ce){w.a.e(this.TAG,Ce.message)}this._idrList.clear();var X=this._pendingSegments[h];if(X.splice(0,X.length),this._mediaSource.readyState!=="closed"){for(var _e=0;_e<E.buffered.length;_e++){var me=E.buffered.start(_e),Oe=E.buffered.end(_e);this._pendingRemoveRanges[h].push({start:me,end:Oe})}if(E.updating||this._doRemoveRanges(),O.a.safari){var ze=this._lastInitSegments[h];ze&&(this._pendingSegments[h].push(ze),E.updating||this._doAppendSegments())}}}},k.prototype.endOfStream=function(){var o=this._mediaSource,h=this._sourceBuffers;o&&o.readyState==="open"?h.video&&h.video.updating||h.audio&&h.audio.updating?this._hasPendingEos=!0:(this._hasPendingEos=!1,o.endOfStream()):o&&o.readyState==="closed"&&this._hasPendingSegments()&&(this._hasPendingEos=!0)},k.prototype.getNearestKeyframe=function(o){return this._idrList.getLastSyncPointBeforeDts(o)},k.prototype._needCleanupSourceBuffer=function(){if(!this._config.autoCleanupSourceBuffer)return!1;var o=this._mediaElement.currentTime;for(var h in this._sourceBuffers){var E=this._sourceBuffers[h];if(E){var X=E.buffered;if(X.length>=1&&o-X.start(0)>=this._config.autoCleanupMaxBackwardDuration)return!0}}return!1},k.prototype._doCleanupSourceBuffer=function(){var o=this._mediaElement.currentTime;for(var h in this._sourceBuffers){var E=this._sourceBuffers[h];if(E){for(var X=E.buffered,_e=!1,me=0;me<X.length;me++){var Oe=X.start(me),ze=X.end(me);if(Oe<=o&&o<ze+3){if(o-Oe>=this._config.autoCleanupMaxBackwardDuration){_e=!0;var Ce=o-this._config.autoCleanupMinBackwardDuration;this._pendingRemoveRanges[h].push({start:Oe,end:Ce})}}else ze<o&&(_e=!0,this._pendingRemoveRanges[h].push({start:Oe,end:ze}))}_e&&!E.updating&&this._doRemoveRanges()}}},k.prototype._updateMediaSourceDuration=function(){var o=this._sourceBuffers;if(this._mediaElement.readyState!==0&&this._mediaSource.readyState==="open"&&!(o.video&&o.video.updating||o.audio&&o.audio.updating)){var h=this._mediaSource.duration,E=this._pendingMediaDuration;E>0&&(isNaN(h)||E>h)&&(w.a.v(this.TAG,"Update MediaSource duration from "+h+" to "+E),this._mediaSource.duration=E),this._requireSetMediaDuration=!1,this._pendingMediaDuration=0}},k.prototype._doRemoveRanges=function(){for(var o in this._pendingRemoveRanges)if(this._sourceBuffers[o]&&!this._sourceBuffers[o].updating)for(var h=this._sourceBuffers[o],E=this._pendingRemoveRanges[o];E.length&&!h.updating;){var X=E.shift();h.remove(X.start,X.end)}},k.prototype._doAppendSegments=function(){var o=this._pendingSegments;for(var h in o)if(this._sourceBuffers[h]&&!this._sourceBuffers[h].updating&&o[h].length>0){var E=o[h].shift();if(E.timestampOffset){var X=this._sourceBuffers[h].timestampOffset,_e=E.timestampOffset/1e3;Math.abs(X-_e)>.1&&(w.a.v(this.TAG,"Update MPEG audio timestampOffset from "+X+" to "+_e),this._sourceBuffers[h].timestampOffset=_e),delete E.timestampOffset}if(!E.data||E.data.byteLength===0)continue;try{this._sourceBuffers[h].appendBuffer(E.data),this._isBufferFull=!1,h==="video"&&E.hasOwnProperty("info")&&this._idrList.appendArray(E.info.syncPoints)}catch(me){this._pendingSegments[h].unshift(E),me.code===22?(this._isBufferFull||this._emitter.emit(l.BUFFER_FULL),this._isBufferFull=!0):(w.a.e(this.TAG,me.message),this._emitter.emit(l.ERROR,{code:me.code,msg:me.message}))}}},k.prototype._onSourceOpen=function(){if(w.a.v(this.TAG,"MediaSource onSourceOpen"),this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._pendingSourceBufferInit.length>0)for(var o=this._pendingSourceBufferInit;o.length;){var h=o.shift();this.appendInitSegment(h,!0)}this._hasPendingSegments()&&this._doAppendSegments(),this._emitter.emit(l.SOURCE_OPEN)},k.prototype._onSourceEnded=function(){w.a.v(this.TAG,"MediaSource onSourceEnded")},k.prototype._onSourceClose=function(){w.a.v(this.TAG,"MediaSource onSourceClose"),this._mediaSource&&this.e!=null&&(this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._mediaSource.removeEventListener("sourceended",this.e.onSourceEnded),this._mediaSource.removeEventListener("sourceclose",this.e.onSourceClose))},k.prototype._hasPendingSegments=function(){var o=this._pendingSegments;return o.video.length>0||o.audio.length>0},k.prototype._hasPendingRemoveRanges=function(){var o=this._pendingRemoveRanges;return o.video.length>0||o.audio.length>0},k.prototype._onSourceBufferUpdateEnd=function(){this._requireSetMediaDuration?this._updateMediaSourceDuration():this._hasPendingRemoveRanges()?this._doRemoveRanges():this._hasPendingSegments()?this._doAppendSegments():this._hasPendingEos&&this.endOfStream(),this._emitter.emit(l.UPDATE_END)},k.prototype._onSourceBufferError=function(o){w.a.e(this.TAG,"SourceBuffer Error: "+o)},k}(),U=I(5),D={NETWORK_ERROR:"NetworkError",MEDIA_ERROR:"MediaError",OTHER_ERROR:"OtherError"},j={NETWORK_EXCEPTION:_.b.EXCEPTION,NETWORK_STATUS_CODE_INVALID:_.b.HTTP_STATUS_CODE_INVALID,NETWORK_TIMEOUT:_.b.CONNECTING_TIMEOUT,NETWORK_UNRECOVERABLE_EARLY_EOF:_.b.UNRECOVERABLE_EARLY_EOF,MEDIA_MSE_ERROR:"MediaMSEError",MEDIA_FORMAT_ERROR:U.a.FORMAT_ERROR,MEDIA_FORMAT_UNSUPPORTED:U.a.FORMAT_UNSUPPORTED,MEDIA_CODEC_UNSUPPORTED:U.a.CODEC_UNSUPPORTED},oe=function(){function k(o,h){this.TAG="MSEPlayer",this._type="MSEPlayer",this._emitter=new P.a,this._config=v(),typeof h=="object"&&Object.assign(this._config,h);var E=o.type.toLowerCase();if(E!=="mse"&&E!=="mpegts"&&E!=="m2ts"&&E!=="flv")throw new u.b("MSEPlayer requires an mpegts/m2ts/flv MediaDataSource input!");o.isLive===!0&&(this._config.isLive=!0),this.e={onvLoadedMetadata:this._onvLoadedMetadata.bind(this),onvSeeking:this._onvSeeking.bind(this),onvCanPlay:this._onvCanPlay.bind(this),onvStalled:this._onvStalled.bind(this),onvProgress:this._onvProgress.bind(this)},self.performance&&self.performance.now?this._now=self.performance.now.bind(self.performance):this._now=Date.now,this._pendingSeekTime=null,this._requestSetTime=!1,this._seekpointRecord=null,this._progressChecker=null,this._mediaDataSource=o,this._mediaElement=null,this._msectl=null,this._transmuxer=null,this._mseSourceOpened=!1,this._hasPendingLoad=!1,this._receivedCanPlay=!1,this._mediaInfo=null,this._statisticsInfo=null;var X=O.a.chrome&&(O.a.version.major<50||O.a.version.major===50&&O.a.version.build<2661);this._alwaysSeekKeyframe=!!(X||O.a.msedge||O.a.msie),this._alwaysSeekKeyframe&&(this._config.accurateSeek=!1)}return k.prototype.destroy=function(){this._progressChecker!=null&&(window.clearInterval(this._progressChecker),this._progressChecker=null),this._transmuxer&&this.unload(),this._mediaElement&&this.detachMediaElement(),this.e=null,this._mediaDataSource=null,this._emitter.removeAllListeners(),this._emitter=null},k.prototype.on=function(o,h){var E=this;o===x.MEDIA_INFO?this._mediaInfo!=null&&Promise.resolve().then(function(){E._emitter.emit(x.MEDIA_INFO,E.mediaInfo)}):o===x.STATISTICS_INFO&&this._statisticsInfo!=null&&Promise.resolve().then(function(){E._emitter.emit(x.STATISTICS_INFO,E.statisticsInfo)}),this._emitter.addListener(o,h)},k.prototype.off=function(o,h){this._emitter.removeListener(o,h)},k.prototype.attachMediaElement=function(o){var h=this;if(this._mediaElement=o,o.addEventListener("loadedmetadata",this.e.onvLoadedMetadata),o.addEventListener("seeking",this.e.onvSeeking),o.addEventListener("canplay",this.e.onvCanPlay),o.addEventListener("stalled",this.e.onvStalled),o.addEventListener("progress",this.e.onvProgress),this._msectl=new p(this._config),this._msectl.on(l.UPDATE_END,this._onmseUpdateEnd.bind(this)),this._msectl.on(l.BUFFER_FULL,this._onmseBufferFull.bind(this)),this._msectl.on(l.SOURCE_OPEN,function(){h._mseSourceOpened=!0,h._hasPendingLoad&&(h._hasPendingLoad=!1,h.load())}),this._msectl.on(l.ERROR,function(E){h._emitter.emit(x.ERROR,D.MEDIA_ERROR,j.MEDIA_MSE_ERROR,E)}),this._msectl.attachMediaElement(o),this._pendingSeekTime!=null)try{o.currentTime=this._pendingSeekTime,this._pendingSeekTime=null}catch{}},k.prototype.detachMediaElement=function(){this._mediaElement&&(this._msectl.detachMediaElement(),this._mediaElement.removeEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._mediaElement.removeEventListener("seeking",this.e.onvSeeking),this._mediaElement.removeEventListener("canplay",this.e.onvCanPlay),this._mediaElement.removeEventListener("stalled",this.e.onvStalled),this._mediaElement.removeEventListener("progress",this.e.onvProgress),this._mediaElement=null),this._msectl&&(this._msectl.destroy(),this._msectl=null)},k.prototype.load=function(){var o=this;if(!this._mediaElement)throw new u.a("HTMLMediaElement must be attached before load()!");if(this._transmuxer)throw new u.a("MSEPlayer.load() has been called, please call unload() first!");this._hasPendingLoad||(this._config.deferLoadAfterSourceOpen&&this._mseSourceOpened===!1?this._hasPendingLoad=!0:(this._mediaElement.readyState>0&&(this._requestSetTime=!0,this._mediaElement.currentTime=0),this._transmuxer=new b(this._mediaDataSource,this._config),this._transmuxer.on(f.a.INIT_SEGMENT,function(h,E){o._msectl.appendInitSegment(E)}),this._transmuxer.on(f.a.MEDIA_SEGMENT,function(h,E){if(o._msectl.appendMediaSegment(E),o._config.lazyLoad&&!o._config.isLive){var X=o._mediaElement.currentTime;E.info.endDts>=1e3*(X+o._config.lazyLoadMaxDuration)&&o._progressChecker==null&&(w.a.v(o.TAG,"Maximum buffering duration exceeded, suspend transmuxing task"),o._suspendTransmuxer())}}),this._transmuxer.on(f.a.LOADING_COMPLETE,function(){o._msectl.endOfStream(),o._emitter.emit(x.LOADING_COMPLETE)}),this._transmuxer.on(f.a.RECOVERED_EARLY_EOF,function(){o._emitter.emit(x.RECOVERED_EARLY_EOF)}),this._transmuxer.on(f.a.IO_ERROR,function(h,E){o._emitter.emit(x.ERROR,D.NETWORK_ERROR,h,E)}),this._transmuxer.on(f.a.DEMUX_ERROR,function(h,E){o._emitter.emit(x.ERROR,D.MEDIA_ERROR,h,{code:-1,msg:E})}),this._transmuxer.on(f.a.MEDIA_INFO,function(h){o._mediaInfo=h,o._emitter.emit(x.MEDIA_INFO,Object.assign({},h))}),this._transmuxer.on(f.a.METADATA_ARRIVED,function(h){o._emitter.emit(x.METADATA_ARRIVED,h)}),this._transmuxer.on(f.a.SCRIPTDATA_ARRIVED,function(h){o._emitter.emit(x.SCRIPTDATA_ARRIVED,h)}),this._transmuxer.on(f.a.TIMED_ID3_METADATA_ARRIVED,function(h){o._emitter.emit(x.TIMED_ID3_METADATA_ARRIVED,h)}),this._transmuxer.on(f.a.SMPTE2038_METADATA_ARRIVED,function(h){o._emitter.emit(x.SMPTE2038_METADATA_ARRIVED,h)}),this._transmuxer.on(f.a.SCTE35_METADATA_ARRIVED,function(h){o._emitter.emit(x.SCTE35_METADATA_ARRIVED,h)}),this._transmuxer.on(f.a.PES_PRIVATE_DATA_DESCRIPTOR,function(h){o._emitter.emit(x.PES_PRIVATE_DATA_DESCRIPTOR,h)}),this._transmuxer.on(f.a.PES_PRIVATE_DATA_ARRIVED,function(h){o._emitter.emit(x.PES_PRIVATE_DATA_ARRIVED,h)}),this._transmuxer.on(f.a.STATISTICS_INFO,function(h){o._statisticsInfo=o._fillStatisticsInfo(h),o._emitter.emit(x.STATISTICS_INFO,Object.assign({},o._statisticsInfo))}),this._transmuxer.on(f.a.RECOMMEND_SEEKPOINT,function(h){o._mediaElement&&!o._config.accurateSeek&&(o._requestSetTime=!0,o._mediaElement.currentTime=h/1e3)}),this._transmuxer.open()))},k.prototype.unload=function(){this._mediaElement&&this._mediaElement.pause(),this._msectl&&this._msectl.seek(0),this._transmuxer&&(this._transmuxer.close(),this._transmuxer.destroy(),this._transmuxer=null)},k.prototype.play=function(){return this._mediaElement.play()},k.prototype.pause=function(){this._mediaElement.pause()},Object.defineProperty(k.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(k.prototype,"buffered",{get:function(){return this._mediaElement.buffered},enumerable:!1,configurable:!0}),Object.defineProperty(k.prototype,"duration",{get:function(){return this._mediaElement.duration},enumerable:!1,configurable:!0}),Object.defineProperty(k.prototype,"volume",{get:function(){return this._mediaElement.volume},set:function(o){this._mediaElement.volume=o},enumerable:!1,configurable:!0}),Object.defineProperty(k.prototype,"muted",{get:function(){return this._mediaElement.muted},set:function(o){this._mediaElement.muted=o},enumerable:!1,configurable:!0}),Object.defineProperty(k.prototype,"currentTime",{get:function(){return this._mediaElement?this._mediaElement.currentTime:0},set:function(o){this._mediaElement?this._internalSeek(o):this._pendingSeekTime=o},enumerable:!1,configurable:!0}),Object.defineProperty(k.prototype,"mediaInfo",{get:function(){return Object.assign({},this._mediaInfo)},enumerable:!1,configurable:!0}),Object.defineProperty(k.prototype,"statisticsInfo",{get:function(){return this._statisticsInfo==null&&(this._statisticsInfo={}),this._statisticsInfo=this._fillStatisticsInfo(this._statisticsInfo),Object.assign({},this._statisticsInfo)},enumerable:!1,configurable:!0}),k.prototype._fillStatisticsInfo=function(o){if(o.playerType=this._type,!(this._mediaElement instanceof HTMLVideoElement))return o;var h=!0,E=0,X=0;if(this._mediaElement.getVideoPlaybackQuality){var _e=this._mediaElement.getVideoPlaybackQuality();E=_e.totalVideoFrames,X=_e.droppedVideoFrames}else this._mediaElement.webkitDecodedFrameCount!=null?(E=this._mediaElement.webkitDecodedFrameCount,X=this._mediaElement.webkitDroppedFrameCount):h=!1;return h&&(o.decodedFrames=E,o.droppedFrames=X),o},k.prototype._onmseUpdateEnd=function(){var o=this._mediaElement.buffered,h=this._mediaElement.currentTime;if(this._config.isLive&&this._config.liveBufferLatencyChasing&&o.length>0&&!this._mediaElement.paused){var E=o.end(o.length-1);if(E>this._config.liveBufferLatencyMaxLatency&&E-h>this._config.liveBufferLatencyMaxLatency){var X=E-this._config.liveBufferLatencyMinRemain;this.currentTime=X}}if(this._config.lazyLoad&&!this._config.isLive){for(var _e=0,me=0;me<o.length;me++){var Oe=o.start(me),ze=o.end(me);if(Oe<=h&&h<ze){_e=ze;break}}_e>=h+this._config.lazyLoadMaxDuration&&this._progressChecker==null&&(w.a.v(this.TAG,"Maximum buffering duration exceeded, suspend transmuxing task"),this._suspendTransmuxer())}},k.prototype._onmseBufferFull=function(){w.a.v(this.TAG,"MSE SourceBuffer is full, suspend transmuxing task"),this._progressChecker==null&&this._suspendTransmuxer()},k.prototype._suspendTransmuxer=function(){this._transmuxer&&(this._transmuxer.pause(),this._progressChecker==null&&(this._progressChecker=window.setInterval(this._checkProgressAndResume.bind(this),1e3)))},k.prototype._checkProgressAndResume=function(){for(var o=this._mediaElement.currentTime,h=this._mediaElement.buffered,E=!1,X=0;X<h.length;X++){var _e=h.start(X),me=h.end(X);if(o>=_e&&o<me){o>=me-this._config.lazyLoadRecoverDuration&&(E=!0);break}}E&&(window.clearInterval(this._progressChecker),this._progressChecker=null,E&&(w.a.v(this.TAG,"Continue loading from paused position"),this._transmuxer.resume()))},k.prototype._isTimepointBuffered=function(o){for(var h=this._mediaElement.buffered,E=0;E<h.length;E++){var X=h.start(E),_e=h.end(E);if(o>=X&&o<_e)return!0}return!1},k.prototype._internalSeek=function(o){var h=this._isTimepointBuffered(o),E=!1,X=0;if(o<1&&this._mediaElement.buffered.length>0){var _e=this._mediaElement.buffered.start(0);(_e<1&&o<_e||O.a.safari)&&(E=!0,X=O.a.safari?.1:_e)}if(E)this._requestSetTime=!0,this._mediaElement.currentTime=X;else if(h){if(this._alwaysSeekKeyframe){var me=this._msectl.getNearestKeyframe(Math.floor(1e3*o));this._requestSetTime=!0,this._mediaElement.currentTime=me!=null?me.dts/1e3:o}else this._requestSetTime=!0,this._mediaElement.currentTime=o;this._progressChecker!=null&&this._checkProgressAndResume()}else this._progressChecker!=null&&(window.clearInterval(this._progressChecker),this._progressChecker=null),this._msectl.seek(o),this._transmuxer.seek(Math.floor(1e3*o)),this._config.accurateSeek&&(this._requestSetTime=!0,this._mediaElement.currentTime=o)},k.prototype._checkAndApplyUnbufferedSeekpoint=function(){if(this._seekpointRecord)if(this._seekpointRecord.recordTime<=this._now()-100){var o=this._mediaElement.currentTime;this._seekpointRecord=null,this._isTimepointBuffered(o)||(this._progressChecker!=null&&(window.clearTimeout(this._progressChecker),this._progressChecker=null),this._msectl.seek(o),this._transmuxer.seek(Math.floor(1e3*o)),this._config.accurateSeek&&(this._requestSetTime=!0,this._mediaElement.currentTime=o))}else window.setTimeout(this._checkAndApplyUnbufferedSeekpoint.bind(this),50)},k.prototype._checkAndResumeStuckPlayback=function(o){var h=this._mediaElement;if(o||!this._receivedCanPlay||h.readyState<2){var E=h.buffered;E.length>0&&h.currentTime<E.start(0)&&(w.a.w(this.TAG,"Playback seems stuck at "+h.currentTime+", seek to "+E.start(0)),this._requestSetTime=!0,this._mediaElement.currentTime=E.start(0),this._mediaElement.removeEventListener("progress",this.e.onvProgress))}else this._mediaElement.removeEventListener("progress",this.e.onvProgress)},k.prototype._onvLoadedMetadata=function(o){this._pendingSeekTime!=null&&(this._mediaElement.currentTime=this._pendingSeekTime,this._pendingSeekTime=null)},k.prototype._onvSeeking=function(o){var h=this._mediaElement.currentTime,E=this._mediaElement.buffered;if(this._requestSetTime)this._requestSetTime=!1;else{if(h<1&&E.length>0){var X=E.start(0);if(X<1&&h<X||O.a.safari)return this._requestSetTime=!0,void(this._mediaElement.currentTime=O.a.safari?.1:X)}if(this._isTimepointBuffered(h)){if(this._alwaysSeekKeyframe){var _e=this._msectl.getNearestKeyframe(Math.floor(1e3*h));_e!=null&&(this._requestSetTime=!0,this._mediaElement.currentTime=_e.dts/1e3)}this._progressChecker!=null&&this._checkProgressAndResume()}else this._seekpointRecord={seekPoint:h,recordTime:this._now()},window.setTimeout(this._checkAndApplyUnbufferedSeekpoint.bind(this),50)}},k.prototype._onvCanPlay=function(o){this._receivedCanPlay=!0,this._mediaElement.removeEventListener("canplay",this.e.onvCanPlay)},k.prototype._onvStalled=function(o){this._checkAndResumeStuckPlayback(!0)},k.prototype._onvProgress=function(o){this._checkAndResumeStuckPlayback()},k}(),be=function(){function k(o,h){this.TAG="NativePlayer",this._type="NativePlayer",this._emitter=new P.a,this._config=v(),typeof h=="object"&&Object.assign(this._config,h);var E=o.type.toLowerCase();if(E==="mse"||E==="mpegts"||E==="m2ts"||E==="flv")throw new u.b("NativePlayer does't support mse/mpegts/m2ts/flv MediaDataSource input!");if(o.hasOwnProperty("segments"))throw new u.b("NativePlayer("+o.type+") doesn't support multipart playback!");this.e={onvLoadedMetadata:this._onvLoadedMetadata.bind(this)},this._pendingSeekTime=null,this._statisticsReporter=null,this._mediaDataSource=o,this._mediaElement=null}return k.prototype.destroy=function(){this._mediaElement&&(this.unload(),this.detachMediaElement()),this.e=null,this._mediaDataSource=null,this._emitter.removeAllListeners(),this._emitter=null},k.prototype.on=function(o,h){var E=this;o===x.MEDIA_INFO?this._mediaElement!=null&&this._mediaElement.readyState!==0&&Promise.resolve().then(function(){E._emitter.emit(x.MEDIA_INFO,E.mediaInfo)}):o===x.STATISTICS_INFO&&this._mediaElement!=null&&this._mediaElement.readyState!==0&&Promise.resolve().then(function(){E._emitter.emit(x.STATISTICS_INFO,E.statisticsInfo)}),this._emitter.addListener(o,h)},k.prototype.off=function(o,h){this._emitter.removeListener(o,h)},k.prototype.attachMediaElement=function(o){if(this._mediaElement=o,o.addEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._pendingSeekTime!=null)try{o.currentTime=this._pendingSeekTime,this._pendingSeekTime=null}catch{}},k.prototype.detachMediaElement=function(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src"),this._mediaElement.removeEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._mediaElement=null),this._statisticsReporter!=null&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},k.prototype.load=function(){if(!this._mediaElement)throw new u.a("HTMLMediaElement must be attached before load()!");this._mediaElement.src=this._mediaDataSource.url,this._mediaElement.readyState>0&&(this._mediaElement.currentTime=0),this._mediaElement.preload="auto",this._mediaElement.load(),this._statisticsReporter=window.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval)},k.prototype.unload=function(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src")),this._statisticsReporter!=null&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},k.prototype.play=function(){return this._mediaElement.play()},k.prototype.pause=function(){this._mediaElement.pause()},Object.defineProperty(k.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(k.prototype,"buffered",{get:function(){return this._mediaElement.buffered},enumerable:!1,configurable:!0}),Object.defineProperty(k.prototype,"duration",{get:function(){return this._mediaElement.duration},enumerable:!1,configurable:!0}),Object.defineProperty(k.prototype,"volume",{get:function(){return this._mediaElement.volume},set:function(o){this._mediaElement.volume=o},enumerable:!1,configurable:!0}),Object.defineProperty(k.prototype,"muted",{get:function(){return this._mediaElement.muted},set:function(o){this._mediaElement.muted=o},enumerable:!1,configurable:!0}),Object.defineProperty(k.prototype,"currentTime",{get:function(){return this._mediaElement?this._mediaElement.currentTime:0},set:function(o){this._mediaElement?this._mediaElement.currentTime=o:this._pendingSeekTime=o},enumerable:!1,configurable:!0}),Object.defineProperty(k.prototype,"mediaInfo",{get:function(){var o={mimeType:(this._mediaElement instanceof HTMLAudioElement?"audio/":"video/")+this._mediaDataSource.type};return this._mediaElement&&(o.duration=Math.floor(1e3*this._mediaElement.duration),this._mediaElement instanceof HTMLVideoElement&&(o.width=this._mediaElement.videoWidth,o.height=this._mediaElement.videoHeight)),o},enumerable:!1,configurable:!0}),Object.defineProperty(k.prototype,"statisticsInfo",{get:function(){var o={playerType:this._type,url:this._mediaDataSource.url};if(!(this._mediaElement instanceof HTMLVideoElement))return o;var h=!0,E=0,X=0;if(this._mediaElement.getVideoPlaybackQuality){var _e=this._mediaElement.getVideoPlaybackQuality();E=_e.totalVideoFrames,X=_e.droppedVideoFrames}else this._mediaElement.webkitDecodedFrameCount!=null?(E=this._mediaElement.webkitDecodedFrameCount,X=this._mediaElement.webkitDroppedFrameCount):h=!1;return h&&(o.decodedFrames=E,o.droppedFrames=X),o},enumerable:!1,configurable:!0}),k.prototype._onvLoadedMetadata=function(o){this._pendingSeekTime!=null&&(this._mediaElement.currentTime=this._pendingSeekTime,this._pendingSeekTime=null),this._emitter.emit(x.MEDIA_INFO,this.mediaInfo)},k.prototype._reportStatisticsInfo=function(){this._emitter.emit(x.STATISTICS_INFO,this.statisticsInfo)},k}();z.a.install();var le={createPlayer:function(k,o){var h=k;if(h==null||typeof h!="object")throw new u.b("MediaDataSource must be an javascript object!");if(!h.hasOwnProperty("type"))throw new u.b("MediaDataSource must has type field to indicate video file type!");switch(h.type){case"mse":case"mpegts":case"m2ts":case"flv":return new oe(h,o);default:return new be(h,o)}},isSupported:function(){return m.supportMSEH264Playback()},getFeatureList:function(){return m.getFeatureList()}};le.BaseLoader=_.a,le.LoaderStatus=_.c,le.LoaderErrors=_.b,le.Events=x,le.ErrorTypes=D,le.ErrorDetails=j,le.MSEPlayer=oe,le.NativePlayer=be,le.LoggingControl=ee.a,Object.defineProperty(le,"version",{enumerable:!0,get:function(){return"1.7.2"}}),q.default=le}])})})(ki);const Li=pi(Lt);ft.extend(fi);ft.extend(mi);const zt=Ct(),Ye=bt(),{timeToSeconds:Di}=Dt(),{processPlaylist:Ci}=Qt(),ei=gi("playlist",{state:()=>({playlist:[],progressValue:0,currentClip:"No clip is playing",currentClipIndex:-1,currentClipStart:0,currentClipDuration:0,currentClipIn:0,currentClipOut:0,remainingSec:0,playoutIsRunning:!0}),getters:{},actions:{updatePlaylist(Ue){this.playlist=Ue},async getPlaylist(Ue){const $e=Di(ft().utcOffset(Ye.utcOffset).format("HH:mm:ss")),he=Ye.configGui[Ye.configID].id;let q=ft().utcOffset(Ye.utcOffset).format("YYYY-MM-DD");Ye.startInSec>$e&&(q=ft(q).utcOffset(Ye.utcOffset).subtract(1,"day").format("YYYY-MM-DD")),await fetch(`/api/playlist/${he}?date=${Ue}`,{method:"GET",headers:zt.authHeader}).then(I=>I.json()).then(I=>{I.program&&this.updatePlaylist(Ci(Ye.startInSec,Ye.playlistLength,I.program,!1))}).catch(()=>{this.updatePlaylist([])})},async playoutStat(){const Ue=Ye.configGui[Ye.configID].id;await fetch(`/api/control/${Ue}/media/current`,{method:"GET",headers:zt.authHeader}).then($e=>($e.status===503&&(this.playoutIsRunning=!1),$e.json())).then($e=>{if($e.result&&$e.result.played_sec){this.playoutIsRunning=!0;const he=$e.result;this.currentClip=he.current_media.source,this.currentClipIndex=he.index,this.currentClipStart=he.start_sec,this.currentClipDuration=he.current_media.duration,this.currentClipIn=he.current_media.seek,this.currentClipOut=he.current_media.out}}).catch(()=>{this.playoutIsRunning=!1})}}}),Xe=Ue=>(Xt("data-v-be3ae157"),Ue=Ue(),Jt(),Ue),Ii={class:"container-fluid"},Pi={class:"row control-row"},Bi={class:"col-3 player-col"},Mi={class:"col"},Oi={class:"row control-col"},xi={class:"col-8 status-col"},Ui={class:"row status-row"},Ni={class:"col time-col clock-col"},Gi={class:"time-str"},Vi={class:"col time-col counter-col"},Fi={class:"time-str"},ji={class:"col current-clip"},zi=["title"],Hi={class:"current-clip-meta"},$i=Xe(()=>g("strong",null,"Duration:",-1)),qi=Xe(()=>g("strong",null,"In:",-1)),Ki=Xe(()=>g("strong",null,"Out:",-1)),Wi={class:"current-clip-progress progress"},Yi=["aria-valuenow"],Xi={class:"col-4 control-unit-col"},Ji={class:"row control-unit-row"},Zi={class:"col"},Qi=Xe(()=>g("i",{class:"bi-play"},null,-1)),en=[Qi],tn={class:"col"},nn=Xe(()=>g("i",{class:"bi-stop"},null,-1)),an=[nn],rn={class:"col"},sn=Xe(()=>g("i",{class:"bi-arrow-clockwise"},null,-1)),on=[sn],dn=Xe(()=>g("div",{class:"w-100"},null,-1)),ln={class:"col"},cn=Xe(()=>g("i",{class:"bi-skip-start"},null,-1)),un=[cn],hn={class:"col"},_n=Xe(()=>g("i",{class:"bi-arrow-repeat"},null,-1)),pn=[_n],fn={class:"col"},mn=Xe(()=>g("i",{class:"bi-skip-end"},null,-1)),gn=[mn],vn=$t({__name:"Control",setup(Ue){const{$dayjs:$e}=qt(),he=Ct(),q=bt(),I=ei(),{filename:z,secToHMS:M,timeToSeconds:y}=Dt(),v={"content-type":"application/json;charset=UTF-8"},m=De(""),_=De(!1),R=De("00:00:00"),P=De(),w=De(q.configGui[q.configID].preview_url.split(".").pop()),O=De(),x=De({liveui:!0,controls:!0,suppressNotSupportedError:!0,autoplay:!1,preload:"auto",sources:[]}),pe=De({type:"flv",isLive:!0,url:""}),ce=De({enableWorker:!0,lazyLoadMaxDuration:3*60,liveBufferLatencyChasing:!0});Kt(()=>{_.value=!1,x.value.sources=[{type:"application/x-mpegURL",src:q.configGui[q.configID].preview_url}];let b;w.value==="flv"&&(pe.value.url=q.configGui[q.configID].preview_url,typeof b<"u"&&b!=null&&(b.unload(),b.detachMediaElement(),b.destroy(),b=null),b=Li.createPlayer(pe.value,ce.value),b.attachMediaElement(O.value),b.load()),ee()}),vi(()=>{_.value=!0,P.value&&clearTimeout(P.value)});async function ee(){re(),I.playoutStat();async function b(l){R.value=$e().utcOffset(q.utcOffset).format("HH:mm:ss");const c=y(R.value);I.remainingSec=I.currentClipStart+I.currentClipOut-c;const u=I.currentClipOut-I.remainingSec;I.progressValue=u*100/I.currentClipOut,!_.value&&(I.playoutIsRunning&&I.remainingSec<0||c%30===0?(re(),I.playoutStat()):I.playoutIsRunning||(I.remainingSec=0),P.value=setTimeout(()=>b(),1e3))}return new Promise(l=>b())}async function re(){const b=q.configGui[q.configID].id;await $fetch(`/api/control/${b}/process/`,{method:"POST",headers:{...v,...he.authHeader},body:JSON.stringify({command:"status"})}).then(l=>{l==="active"?m.value="is-playing":(I.playoutIsRunning=!1,m.value="")}).catch(()=>{m.value=""})}async function f(b){const l=q.configGui[q.configID].id;await $fetch(`/api/control/${l}/process/`,{method:"POST",headers:{...v,...he.authHeader},body:JSON.stringify({command:b})}),setTimeout(()=>{re(),I.playoutStat()},1e3)}async function V(b){const l=q.configGui[q.configID].id;await $fetch(`/api/control/${l}/playout/`,{method:"POST",headers:{...v,...he.authHeader},body:JSON.stringify({control:b})}),setTimeout(()=>{re(),I.playoutStat()},1e3)}return(b,l)=>{const c=Ht;return Re(),Te("div",null,[g("div",Ii,[g("div",Pi,[g("div",Bi,[g("div",null,[H(q).configGui[H(q).configID].preview_url.split(".").pop()==="flv"?(Re(),Te("video",{key:0,id:"httpStream",ref_key:"httpStream",ref:O,width:"100%",controls:""},null,512)):H(x).sources.length>0?(Re(),Wt(c,{class:"live-player",key:H(q).configID,reference:"httpStream",options:H(x)},null,8,["options"])):ut("",!0)])]),g("div",Mi,[g("div",Oi,[g("div",xi,[g("div",Ui,[g("div",Ni,[g("div",Gi,Me(H(R)),1)]),g("div",Vi,[g("div",Fi,Me(H(M)(H(I).remainingSec>=0?H(I).remainingSec:0)),1)]),g("div",ji,[g("div",{class:"current-clip-text",title:H(z)(H(I).currentClip)},Me(H(z)(H(I).currentClip)),9,zi),g("div",Hi,[$i,yt(" "+Me(H(M)(H(I).currentClipDuration))+" | ",1),qi,yt(" "+Me(H(M)(H(I).currentClipIn))+" | ",1),Ki,yt(" "+Me(H(M)(H(I).currentClipOut)),1)]),g("div",Wi,[g("div",{class:"progress-bar bg-warning","aria-valuenow":H(I).progressValue,style:Yt(`width: ${H(I).progressValue}%;`)},null,12,Yi)])])])]),g("div",Xi,[g("div",Ji,[g("div",Zi,[g("div",null,[g("button",{title:"Start Playout Service",class:yi(["btn btn-primary control-button control-button-play",H(m)]),onClick:l[0]||(l[0]=u=>f("start"))},en,2)])]),g("div",tn,[g("div",null,[g("button",{title:"Stop Playout Service",class:"btn btn-primary control-button control-button-stop",onClick:l[1]||(l[1]=u=>f("stop"))},an)])]),g("div",rn,[g("div",null,[g("button",{title:"Restart Playout Service",class:"btn btn-primary control-button control-button-restart",onClick:l[2]||(l[2]=u=>f("restart"))},on)])]),dn,g("div",ln,[g("div",null,[g("button",{title:"Jump to last Clip",class:"btn btn-primary control-button control-button-control",onClick:l[3]||(l[3]=u=>V("back"))},un)])]),g("div",hn,[g("div",null,[g("button",{title:"Reset Playout State",class:"btn btn-primary control-button control-button-control",onClick:l[4]||(l[4]=u=>V("reset"))},pn)])]),g("div",fn,[g("div",null,[g("button",{title:"Jump to next Clip",class:"btn btn-primary control-button control-button-control",onClick:l[5]||(l[5]=u=>V("next"))},gn)])])])])])])])])])}}});const yn=Zt(vn,[["__scopeId","data-v-be3ae157"]]),Ee=Ue=>(Xt("data-v-1e640b7b"),Ue=Ue(),Jt(),Ue),bn={class:"date-row"},Sn={class:"col"},En={key:0,class:"d-flex justify-content-center loading-overlay"},An=Ee(()=>g("div",{class:"spinner-border",role:"status"},null,-1)),Rn=[An],wn={key:1},Tn={"aria-label":"breadcrumb"},kn={class:"breadcrumb"},Ln=["active","onClick"],Dn={key:0,class:"link-secondary",href:"#"},Cn={key:1},In={class:"list-group media-browser-scroll browser-div"},Pn={class:"row"},Bn=Ee(()=>g("div",{class:"col-1 browser-icons-col"},[g("i",{class:"bi-folder-fill browser-icons"})],-1)),Mn={class:"col browser-item-text"},On=["onClick"],xn=["id"],Un={class:"row"},Nn={class:"col-1 browser-icons-col"},Gn={key:0,class:"bi-music-note-beamed browser-icons"},Vn={key:1,class:"bi-film browser-icons"},Fn={key:2,class:"bi-file-earmark-image browser-icons"},jn={key:3,class:"bi-file-binary browser-icons"},zn={class:"col browser-item-text grabbing"},Hn={class:"col-1 browser-play-col"},$n=["onClick"],qn=Ee(()=>g("i",{class:"bi-play-fill"},null,-1)),Kn=[qn],Wn={class:"col-1 browser-dur-col"},Yn={class:"duration"},Xn={class:"playlist-container"},Jn=Ee(()=>g("ul",{class:"list-group list-group-header"},[g("li",{class:"list-group-item"},[g("div",{class:"row playlist-row"},[g("div",{class:"col-1 timecode"},"Start"),g("div",{class:"col"},"File"),g("div",{class:"col-1 text-center playlist-input"},"Play"),g("div",{class:"col-1 timecode"},"Duration"),g("div",{class:"col-1 timecode mobile-hidden"},"In"),g("div",{class:"col-1 timecode mobile-hidden"},"Out"),g("div",{class:"col-1 text-center playlist-input mobile-hidden"},"Ad"),g("div",{class:"col-1 text-center playlist-input"},"Edit"),g("div",{class:"col-1 text-center playlist-input mobile-hidden"},"Delete")])])],-1)),Zn={key:0,class:"d-flex justify-content-center loading-overlay"},Qn=Ee(()=>g("div",{class:"spinner-border",role:"status"},null,-1)),ea=[Qn],ta={id:"scroll-container"},ia=["id"],na={class:"row playlist-row"},aa={class:"col-1 timecode"},ra={class:"col grabbing filename"},sa={class:"col-1 text-center playlist-input"},oa=["onClick"],da=Ee(()=>g("i",{class:"bi-play-fill"},null,-1)),la=[da],ca={class:"col-1 timecode"},ua={class:"col-1 timecode mobile-hidden"},ha={class:"col-1 timecode mobile-hidden"},_a={class:"col-1 text-center playlist-input mobile-hidden"},pa=["checked","onChange"],fa={class:"col-1 text-center playlist-input"},ma=["onClick"],ga=Ee(()=>g("i",{class:"bi-pencil-square"},null,-1)),va=[ga],ya={class:"col-1 text-center playlist-input mobile-hidden"},ba=["onClick"],Sa=Ee(()=>g("i",{class:"bi-x-circle-fill"},null,-1)),Ea=[Sa],Aa={class:"btn-group media-button mb-3"},Ra=Ee(()=>g("div",{class:"btn btn-primary",title:"Copy Playlist","data-bs-toggle":"modal","data-bs-target":"#copyModal"},[g("i",{class:"bi-files"})],-1)),wa=Ee(()=>g("i",{class:"bi-view-stacked"},null,-1)),Ta=[wa],ka=Ee(()=>g("i",{class:"bi-file-earmark-plus"},null,-1)),La=[ka],Da=Ee(()=>g("div",{class:"btn btn-primary",title:"Import text/m3u file","data-bs-toggle":"modal","data-bs-target":"#importModal"},[g("i",{class:"bi-file-text"})],-1)),Ca=Ee(()=>g("i",{class:"bi-sort-down-alt"},null,-1)),Ia=[Ca],Pa=Ee(()=>g("i",{class:"bi-arrow-counterclockwise"},null,-1)),Ba=[Pa],Ma=Ee(()=>g("i",{class:"bi-download"},null,-1)),Oa=[Ma],xa=Ee(()=>g("div",{class:"btn btn-primary",title:"Delete Playlist","data-bs-toggle":"modal","data-bs-target":"#deleteModal"},[g("i",{class:"bi-trash"})],-1)),Ua={id:"previewModal",class:"modal",tabindex:"-1","aria-labelledby":"previewModalLabel","aria-hidden":"true"},Na={class:"modal-dialog modal-dialog-centered modal-xl"},Ga={class:"modal-content"},Va={class:"modal-header"},Fa={class:"modal-title fs-5",id:"previewModalLabel"},ja={class:"modal-body"},za=["src","alt"],Ha={id:"sourceModal",class:"modal",tabindex:"-1","aria-labelledby":"sourceModalLabel","aria-hidden":"true"},$a={class:"modal-dialog modal-dialog-centered"},qa={class:"modal-content"},Ka=Ee(()=>g("div",{class:"modal-header"},[g("h1",{class:"modal-title fs-5",id:"sourceModalLabel"},"Add/Edit Source"),g("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Cancel"})],-1)),Wa={class:"modal-body"},Ya=Ee(()=>g("label",{for:"in-input",class:"form-label"},"In",-1)),Xa=Ee(()=>g("label",{for:"out-input",class:"form-label mt-2"},"Out",-1)),Ja=Ee(()=>g("label",{for:"duration-input",class:"form-label mt-2"},"Duration",-1)),Za=Ee(()=>g("label",{for:"source-input",class:"form-label mt-2"},"Source",-1)),Qa=Ee(()=>g("label",{for:"audio-input",class:"form-label mt-2"},"Audio",-1)),er=Ee(()=>g("label",{for:"filter-input",class:"form-label mt-2"},"Custom Filter",-1)),tr=Ee(()=>g("label",{class:"form-check-label",for:"ad-input"}," Advertisement ",-1)),ir=Ee(()=>g("button",{type:"reset",class:"btn btn-primary","data-bs-dismiss":"modal","aria-label":"Cancel"}," Cancel ",-1)),nr={id:"importModal",class:"modal",tabindex:"-1","aria-labelledby":"importModalLabel","aria-hidden":"true"},ar={class:"modal-dialog modal-dialog-centered"},rr={class:"modal-content"},sr=Ee(()=>g("div",{class:"modal-header"},[g("h1",{class:"modal-title fs-5",id:"importModalLabel"},"Import Playlist"),g("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Cancel"})],-1)),or=["onSubmit"],dr={class:"modal-body"},lr=Ee(()=>g("div",{class:"modal-footer"},[g("button",{type:"reset",class:"btn btn-primary","data-bs-dismiss":"modal","aria-label":"Cancel"}," Cancel "),g("button",{type:"submit",class:"btn btn-primary","data-bs-dismiss":"modal"},"Import")],-1)),cr={id:"copyModal",class:"modal",tabindex:"-1","aria-labelledby":"copyModalLabel","aria-hidden":"true"},ur={class:"modal-dialog modal-dialog-centered"},hr={class:"modal-content"},_r={class:"modal-header"},pr={class:"modal-title fs-5",id:"copyModalLabel"},fr=Ee(()=>g("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Cancel"},null,-1)),mr={class:"modal-body"},gr={class:"modal-footer"},vr=Ee(()=>g("button",{type:"button",class:"btn btn-primary","data-bs-dismiss":"modal"},"Cancel",-1)),yr={id:"deleteModal",class:"modal",tabindex:"-1","aria-labelledby":"deleteModalLabel","aria-hidden":"true"},br={class:"modal-dialog modal-dialog-centered"},Sr={class:"modal-content"},Er=Ee(()=>g("div",{class:"modal-header"},[g("h1",{class:"modal-title fs-5",id:"deleteModalLabel"},"Delete Program"),g("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Cancel"})],-1)),Ar={class:"modal-body"},Rr={class:"modal-footer"},wr=Ee(()=>g("button",{type:"button",class:"btn btn-primary","data-bs-dismiss":"modal"},"Cancel",-1)),Tr={id:"generateModal",class:"modal modal-xl",tabindex:"-1","aria-labelledby":"generateModalLabel","aria-hidden":"true"},kr={class:"modal-dialog modal-dialog-centered"},Lr={class:"modal-content"},Dr=Ee(()=>g("div",{class:"modal-header"},[g("h1",{class:"modal-title fs-5",id:"generateModalLabel"},"Generate Program"),g("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Cancel"})],-1)),Cr={class:"modal-body"},Ir={"aria-label":"breadcrumb"},Pr={class:"breadcrumb"},Br=["active","onClick"],Mr={key:0,class:"link-secondary",href:"#"},Or={key:1},xr={class:"list-group media-browser-scroll browser-div"},Ur={class:"row"},Nr=Ee(()=>g("div",{class:"col-1 browser-icons-col"},[g("i",{class:"bi-folder-fill browser-icons"})],-1)),Gr={class:"col browser-item-text"},Vr=["onClick"],Fr={key:0,class:"col-1 text-center playlist-input"},jr=["onChange"],zr={class:"modal-footer"},Hr={class:"form-check select-all-div"},$r=Ee(()=>g("label",{class:"form-check-label",for:"checkAll"},"All",-1)),qr=Ee(()=>g("button",{type:"button",class:"btn btn-primary","data-bs-dismiss":"modal"},"Cancel",-1)),Kr=$t({__name:"player",setup(Ue){const{$_:$e,$dayjs:he}=qt(),{secToHMS:q,filename:I,secondsToTime:z,toMin:M,mediaType:y}=Dt(),{processPlaylist:v,genUID:m}=Qt(),_={"content-type":"application/json;charset=UTF-8"},R=Ct(),P=bt(),w=Ti(),O=hi(),x=ei();bi({title:"Player | ffplayout"});const{configID:pe}=Si(bt()),ce=De(),ee=De(!1),re=De(!1),f=De(he().utcOffset(P.utcOffset).format("YYYY-MM-DD")),V=De(he().utcOffset(P.utcOffset).format("YYYY-MM-DD")),b=De(-1),l=De(),c=De(""),u=De(""),p=De(),U=De(!1),D=De([]),j=De(!1),oe=De({group:{name:"playlist",pull:"clone",put:!1},sort:!1}),be=De({group:"playlist",animation:100,handle:".grabbing"}),le=De({begin:0,in:0,out:0,duration:0,category:"",custom_filter:"",source:"",audio:"",uid:""});Kt(()=>{O.folderTree.parent||k(""),o()}),Ei([f,pe],()=>{k(""),o()});async function k(Q){ee.value=!0,await O.getTree(Q),ee.value=!1}async function o(){re.value=!0,await x.getPlaylist(f.value),re.value=!1}function h(){U.value=!1}function E(Q,K){Q.target.checked?K.category="advertisement":K.category=""}function X(Q){const K=Q.target.files||Q.dataTransfer.files;K.length&&(l.value=K)}function _e(Q){const K=Q.oldIndex,ke=Q.newIndex;Q.item.remove();const tt=`${P.configPlayout.storage.path}/${O.folderTree.source}/${O.folderTree.files[K].name}`.replace(/\/[/]+/g,"/");x.playlist.splice(ke,0,{uid:m(),begin:0,source:tt,in:0,out:O.folderTree.files[K].duration,duration:O.folderTree.files[K].duration}),x.playlist=v(P.startInSec,P.playlistLength,x.playlist,!1)}function me(Q){x.playlist.splice(Q.newIndex,0,x.playlist.splice(Q.oldIndex,1)[0]),x.playlist=v(P.startInSec,P.playlistLength,x.playlist,!1)}function Oe(Q){let K=Q;Q.includes("/")||(K=`/${O.folderTree.parent?O.folderTree.parent:""}/${O.folderTree.source}/${Q}`.replace(/\/[/]+/g,"/")),c.value=K.split("/").slice(-1)[0],u.value=encodeURIComponent(`${K}`).replace(/%2F/g,"/");const ke=c.value.split(".").slice(-1)[0].toLowerCase();P.configPlayout.storage.extensions.includes(`${ke}`)?(U.value=!0,p.value={liveui:!1,controls:!0,suppressNotSupportedError:!0,autoplay:!1,preload:"auto",sources:[{type:`video/${ke}`,src:u.value}]}):U.value=!1}function ze(Q){Q.preventDefault(),b.value===-1?(x.playlist.push(le.value),x.playlist=v(P.startInSec,P.playlistLength,x.playlist,!1)):(x.playlist[b.value]=le.value,x.playlist=v(P.startInSec,P.playlistLength,x.playlist,!1),b.value=-1),le.value={begin:0,in:0,out:0,duration:0,category:"",custom_filter:"",source:"",audio:"",uid:""}}function Ce(){b.value=-1,le.value={begin:0,in:0,out:0,duration:0,category:"",custom_filter:"",source:"",audio:"",uid:m()}}function N(Q){b.value=Q,le.value={begin:x.playlist[Q].begin,in:x.playlist[Q].in,out:x.playlist[Q].out,duration:x.playlist[Q].duration,category:x.playlist[Q].category,custom_filter:x.playlist[Q].custom_filter,source:x.playlist[Q].source,audio:x.playlist[Q].audio,uid:x.playlist[Q].uid}}function $(Q){Q.target.checked?le.value.category="advertisement":le.value.category=""}function se(Q){x.playlist.splice(Q,1)}function te(){const Q=[];let K=0;for(;K<P.playlistLength;)for(const ke of x.playlist)if(K<P.playlistLength)Q.push($e.cloneDeep(ke)),K+=ke.out-ke.in;else break;x.playlist=v(P.startInSec,P.playlistLength,Q,!1)}async function de(Q){if(Q.preventDefault(),!l.value||!l.value[0])return;const K=new FormData;K.append(l.value[0].name,l.value[0]),re.value=!0,await $fetch(`/api/file/${P.configGui[P.configID].id}/import/?file=${l.value[0].name}&date=${f.value}`,{method:"PUT",headers:R.authHeader,body:K}).then(()=>{w.alertVariant="alert-success",w.alertMsg="Import success!",w.showAlert=!0,x.getPlaylist(f.value),setTimeout(()=>{w.showAlert=!1},2e3)}).catch(ke=>{w.alertVariant="alert-danger",w.alertMsg=ke,w.showAlert=!0,setTimeout(()=>{w.showAlert=!1},4e3)}),re.value=!1,l.value=null,ce.value.value=null}async function ye(){re.value=!0;let Q={method:"POST",headers:{..._,...R.authHeader}};D.value.length>0&&!j.value&&(Q.body={paths:D.value}),await $fetch(`/api/playlist/${P.configGui[P.configID].id}/generate/${f.value}`,Q).then(K=>{x.playlist=v(P.startInSec,P.playlistLength,K.program,!1),w.alertVariant="alert-success",w.alertMsg="Generate Playlist done...",w.showAlert=!0,setTimeout(()=>{w.showAlert=!1},2e3)}).catch(K=>{w.alertVariant="alert-danger",w.alertMsg=K.data?K.data:K,w.showAlert=!0,setTimeout(()=>{w.showAlert=!1},4e3)}),re.value=!1}async function xe(Q){x.playlist=v(P.startInSec,P.playlistLength,x.playlist,!0);const K=x.playlist.map(({begin:ke,...Je})=>Je);await $fetch(`/api/playlist/${P.configGui[P.configID].id}/`,{method:"POST",headers:{..._,...R.authHeader},body:JSON.stringify({channel:P.configGui[P.configID].name,date:Q,program:K})}).then(ke=>{w.alertVariant="alert-success",w.alertMsg=ke,w.showAlert=!0,setTimeout(()=>{w.showAlert=!1},2e3)}).catch(ke=>{ke.status===409?(w.alertVariant="alert-warning",w.alertMsg=ke.data,w.showAlert=!0,setTimeout(()=>{w.showAlert=!1},2e3)):(w.alertVariant="alert-danger",w.alertMsg=ke,w.showAlert=!0,setTimeout(()=>{w.showAlert=!1},4e3))})}async function Ge(Q){await $fetch(`/api/playlist/${P.configGui[P.configID].id}/${Q}`,{method:"DELETE",headers:{..._,...R.authHeader}}).then(()=>{x.playlist=[],w.alertVariant="alert-warning",w.alertMsg="Playlist deleted...",w.showAlert=!0,setTimeout(()=>{w.showAlert=!1},2e3)})}function qe(Q,K){if(Q.target.checked)D.value.push(K);else{const ke=D.value.indexOf(K);ke>-1&&D.value.splice(ke,1)}}return(Q,K)=>{const ke=ui,Je=yn,tt=wi("Sortable"),St=Ht;return Re(),Te("div",null,[dt(ke),dt(Je),g("div",bn,[g("div",Sn,[et(g("input",{type:"date",class:"form-control date-div mt-2 mb-2","onUpdate:modelValue":K[0]||(K[0]=J=>kt(f)?f.value=J:null)},null,512),[[rt,H(f)]])])]),dt(H(_i),{class:"container list-row pane-row player-container"},{default:pt(()=>[dt(H(jt),{class:"mobile-hidden","min-size":"14","max-size":"80",size:"20"},{default:pt(()=>[H(ee)?(Re(),Te("div",En,Rn)):ut("",!0),H(O).folderTree.parent&&H(O).crumbs?(Re(),Te("div",wn,[g("nav",Tn,[g("ol",kn,[(Re(!0),Te(gt,null,vt(H(O).crumbs,(J,Ne)=>(Re(),Te("li",{class:"breadcrumb-item",key:Ne,active:Ne===H(O).crumbs.length-1,onClick:Ke=>k(J.path)},[H(O).crumbs.length>1&&H(O).crumbs.length-1>Ne?(Re(),Te("a",Dn,Me(J.text),1)):(Re(),Te("span",Cn,Me(J.text),1))],8,Ln))),128))])])])):ut("",!0),g("ul",In,[(Re(!0),Te(gt,null,vt(H(O).folderTree.folders,J=>(Re(),Te("li",{class:"list-group-item browser-item",key:J},[g("div",Pn,[Bn,g("div",Mn,[g("a",{class:"link-light",href:"#",onClick:Ne=>k(`/${H(O).folderTree.source}/${J}`)},Me(J),9,On)])])]))),128)),dt(tt,{list:H(O).folderTree.files,options:H(oe),"item-key":"name"},{item:pt(({element:J,index:Ne})=>[(Re(),Te("li",{id:`file_${Ne}`,class:"draggable list-group-item browser-item",key:J.name},[g("div",Un,[g("div",Nn,[H(y)(J.name)==="audio"?(Re(),Te("i",Gn)):H(y)(J.name)==="video"?(Re(),Te("i",Vn)):H(y)(J.name)==="image"?(Re(),Te("i",Fn)):(Re(),Te("i",jn))]),g("div",zn,Me(J.name),1),g("div",Hn,[g("a",{href:"#",class:"btn-link","data-bs-toggle":"modal","data-bs-target":"#previewModal",onClick:Ke=>Oe(J.name)},Kn,8,$n)]),g("div",Wn,[g("span",Yn,Me(H(M)(J.duration)),1)])])],8,xn))]),_:1},8,["list","options"])])]),_:1}),dt(H(jt),{class:"playlist-pane"},{default:pt(()=>[g("div",Xn,[Jn,H(re)?(Re(),Te("div",Zn,ea)):ut("",!0),g("div",ta,[dt(tt,{list:H(x).playlist,"item-key":"uid",class:"list-group playlist-list-group",style:Yt(`height: ${H(x).playlist?H(x).playlist.length*38+76:300}px`),tag:"ul",options:H(be),onAdd:_e,onEnd:me},{item:pt(({element:J,index:Ne})=>[(Re(),Te("li",{id:`clip_${Ne}`,class:"draggable list-group-item playlist-item",key:J.uid},[g("div",na,[g("div",aa,Me(H(z)(J.begin)),1),g("div",ra,Me(H(I)(J.source)),1),g("div",sa,[g("a",{href:"#",class:"btn-link","data-bs-toggle":"modal","data-bs-target":"#previewModal",onClick:Ke=>Oe(J.source)},la,8,oa)]),g("div",ca,Me(H(q)(J.duration)),1),g("div",ua,Me(H(q)(J.in)),1),g("div",ha,Me(H(q)(J.out)),1),g("div",_a,[g("input",{class:"form-check-input",type:"checkbox",checked:!!(J.category&&J.category==="advertisement"),onChange:Ke=>E(Ke,J)},null,40,pa)]),g("div",fa,[g("a",{href:"#",class:"btn-link","data-bs-toggle":"modal","data-bs-target":"#sourceModal",onClick:Ke=>N(Ne)},va,8,ma)]),g("div",ya,[g("a",{href:"#",class:"btn-link",onClick:Ke=>se(Ne)},Ea,8,ba)])])],8,ia))]),_:1},8,["list","style","options"])])])]),_:1})]),_:1}),g("div",Aa,[Ra,H(P).configPlayout.playlist.loop?ut("",!0):(Re(),Te("div",{key:0,class:"btn btn-primary",title:"Loop Clips in Playlist",onClick:K[1]||(K[1]=J=>te())},Ta)),g("div",{class:"btn btn-primary",title:"Add (remote) Source to Playlist","data-bs-toggle":"modal","data-bs-target":"#sourceModal",onClick:K[2]||(K[2]=J=>Ce())},La),Da,g("div",{class:"btn btn-primary",title:"Generate a randomized Playlist","data-bs-toggle":"modal","data-bs-target":"#generateModal",onClick:K[3]||(K[3]=J=>H(O).getTree("",!0))},Ia),g("div",{class:"btn btn-primary",title:"Reset Playlist",onClick:K[4]||(K[4]=J=>o())},Ba),g("div",{class:"btn btn-primary",title:"Save Playlist",onClick:K[5]||(K[5]=J=>xe(H(f)))},Oa),xa]),g("div",Ua,[g("div",Na,[g("div",Ga,[g("div",Va,[g("h1",Fa,"Preview: "+Me(H(c)),1),g("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Cancel",onClick:K[6]||(K[6]=J=>h())})]),g("div",ja,[H(U)&&H(p)?(Re(),Wt(St,{key:0,reference:"previewPlayer",options:H(p)},null,8,["options"])):(Re(),Te("img",{key:1,src:H(u),class:"img-fluid",alt:H(c)},null,8,za))])])])]),g("div",Ha,[g("div",$a,[g("div",qa,[Ka,g("form",{onReset:Ce},[g("div",Wa,[Ya,et(g("input",{type:"number",class:"form-control",id:"in-input","aria-describedby":"in","onUpdate:modelValue":K[7]||(K[7]=J=>H(le).in=J)},null,512),[[rt,H(le).in,void 0,{number:!0}]]),Xa,et(g("input",{type:"number",class:"form-control",id:"out-input","aria-describedby":"out","onUpdate:modelValue":K[8]||(K[8]=J=>H(le).out=J)},null,512),[[rt,H(le).out,void 0,{number:!0}]]),Ja,et(g("input",{type:"number",class:"form-control",id:"duration-input","aria-describedby":"out","onUpdate:modelValue":K[9]||(K[9]=J=>H(le).duration=J)},null,512),[[rt,H(le).duration,void 0,{number:!0}]]),Za,et(g("input",{type:"text",class:"form-control",id:"source-input","aria-describedby":"out","onUpdate:modelValue":K[10]||(K[10]=J=>H(le).source=J)},null,512),[[rt,H(le).source]]),Qa,et(g("input",{type:"text",class:"form-control",id:"audio-input","aria-describedby":"out","onUpdate:modelValue":K[11]||(K[11]=J=>H(le).audio=J)},null,512),[[rt,H(le).audio]]),er,et(g("input",{type:"text",class:"form-control",id:"filter-input","aria-describedby":"out","onUpdate:modelValue":K[12]||(K[12]=J=>H(le).custom_filter=J)},null,512),[[rt,H(le).custom_filter]]),g("div",{class:"form-check"},[tr,g("input",{class:"form-check-input",type:"checkbox",value:"",id:"ad-input",onClick:$})])]),g("div",{class:"modal-footer"},[ir,g("button",{type:"submit",class:"btn btn-primary","data-bs-dismiss":"modal",onClick:ze}," Ok ")])],32)])])]),g("div",nr,[g("div",ar,[g("div",rr,[sr,g("form",{onSubmit:Ai(de,["prevent"])},[g("div",dr,[g("input",{class:"form-control",ref_key:"fileImport",ref:ce,type:"file",onChange:X},null,544)]),lr],40,or)])])]),g("div",cr,[g("div",ur,[g("div",hr,[g("div",_r,[g("h1",pr,"Copy Program "+Me(H(f))+" to:",1),fr]),g("div",mr,[et(g("input",{type:"date",class:"form-control centered","onUpdate:modelValue":K[13]||(K[13]=J=>kt(V)?V.value=J:null)},null,512),[[rt,H(V)]])]),g("div",gr,[vr,g("button",{type:"button",class:"btn btn-primary","data-bs-dismiss":"modal",onClick:K[14]||(K[14]=J=>xe(H(V)))}," Ok ")])])])]),g("div",yr,[g("div",br,[g("div",Sr,[Er,g("div",Ar,[yt(" Delete program from "),g("strong",null,Me(H(f)),1)]),g("div",Rr,[wr,g("button",{type:"button",class:"btn btn-primary","data-bs-dismiss":"modal",onClick:K[15]||(K[15]=J=>Ge(H(f)))}," Ok ")])])])]),g("div",Tr,[g("div",kr,[g("div",Lr,[Dr,g("div",Cr,[g("div",null,[g("nav",Ir,[g("ol",Pr,[(Re(!0),Te(gt,null,vt(H(O).folderCrumbs,(J,Ne)=>(Re(),Te("li",{class:"breadcrumb-item",key:Ne,active:Ne===H(O).folderCrumbs.length-1,onClick:Ke=>H(O).getTree(J.path,!0)},[H(O).folderCrumbs.length>1&&H(O).folderCrumbs.length-1>Ne?(Re(),Te("a",Mr,Me(J.text),1)):(Re(),Te("span",Or,Me(J.text),1))],8,Br))),128))])])]),g("ul",xr,[(Re(!0),Te(gt,null,vt(H(O).folderList.folders,J=>(Re(),Te("li",{class:"list-group-item browser-item",key:J},[g("div",Ur,[Nr,g("div",Gr,[g("a",{class:"link-light",href:"#",onClick:Ne=>{D.value=[],H(O).getTree(`/${H(O).folderList.source}/${J}`.replace(/\/[/]+/g,"/"),!0)}},Me(J),9,Vr)]),H(j)?ut("",!0):(Re(),Te("div",Fr,[g("input",{class:"form-check-input",type:"checkbox",onChange:Ne=>qe(Ne,`/${H(O).folderList.source}/${J}`.replace(/\/[/]+/g,"/"))},null,40,jr)]))])]))),128))])]),g("div",zr,[g("div",Hr,[et(g("input",{id:"checkAll",class:"form-check-input",type:"checkbox","onUpdate:modelValue":K[16]||(K[16]=J=>kt(j)?j.value=J:null)},null,512),[[Ri,H(j)]]),$r]),qr,g("button",{type:"button",class:"btn btn-primary","data-bs-dismiss":"modal",onClick:K[17]||(K[17]=J=>ye())}," Ok ")])])])])])}}});const es=Zt(Kr,[["__scopeId","data-v-1e640b7b"]]);export{es as default};
